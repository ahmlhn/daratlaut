import{E as bt,o as Aa,c as d,a as Kt,u as Ua,h as Pa,m as Ra,b as s,f as F,j as c,F as X,s as Le,t as p,x as Gt,e as S,d as Y,n as L,v as V,w as B,J as Ma,r as f,y as E,z as Fa}from"./app-CnOYw52P.js";import{_ as Ea}from"./AdminLayout-ChBTLBzj.js";const ja={id:"olt-root",class:"px-3 py-4 sm:p-6"},Da={class:"flex flex-col gap-6 fade-in pb-20 md:pb-0"},Ba={class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-white/10 p-4 md:p-5 space-y-4"},Ia={class:"flex flex-col lg:flex-row lg:items-end gap-4"},Va={class:"flex-1 space-y-2"},Ka=["disabled"],Ga=["value"],za={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-2 w-full lg:w-auto"},Ha=["disabled"],Ja={id:"olt-selected-info",class:"text-[11px] text-slate-600 dark:text-slate-300 bg-slate-50 dark:bg-slate-900/60 border border-slate-200 dark:border-white/10 rounded-lg px-3 py-2"},qa={key:0,id:"olt-uncfg-card",class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-white/10 overflow-hidden"},Wa={class:"p-4 md:p-5 border-b border-slate-100 dark:border-white/10 flex flex-col lg:flex-row lg:items-center justify-between gap-4"},Za={class:"flex items-center gap-3"},Qa={class:"text-sm text-slate-500 dark:text-slate-400"},Xa={class:"font-bold text-slate-700 dark:text-slate-200"},Ya={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 w-full lg:w-auto"},es=["disabled"],ts=["disabled"],as=["disabled"],ss=["disabled"],ls={key:0,class:"px-4 md:px-5 pt-3 pb-3"},rs={class:"text-xs"},ns={key:0,class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent dark:via-white/10 animate-pulse"},os={class:"relative flex items-center gap-3"},is={"data-status-text":""},us={key:1,class:"px-4 md:px-5 pb-2 text-[11px] text-slate-500 dark:text-slate-400"},ds={key:2,class:"px-4 md:px-5 pb-4"},cs={class:"rounded-xl border border-slate-200 dark:border-white/10 bg-white/90 dark:bg-slate-900/60 p-4 space-y-3 shadow-sm"},fs={class:"flex items-center justify-between"},ps={class:"text-sm font-bold text-slate-700 dark:text-slate-200"},gs={key:0,class:"flex flex-col lg:flex-row lg:items-end gap-3"},vs={class:"flex-1 space-y-1"},xs=["disabled"],bs=["disabled"],ms={key:1,class:"space-y-2"},hs={class:"flex items-center gap-3 rounded-2xl border border-emerald-200/70 dark:border-emerald-500/30 bg-emerald-50/70 dark:bg-emerald-500/10 px-4 py-3"},ks={class:"text-sm font-semibold text-emerald-700 dark:text-emerald-200"},ys={class:"overflow-x-auto"},ws={class:"w-full text-left text-sm whitespace-nowrap"},_s={class:"bg-slate-50 dark:bg-slate-800/50 text-xs uppercase text-slate-500 dark:text-slate-400 font-bold border-b border-slate-100 dark:border-white/5"},Ss={key:0},$s={key:1},Os={class:"divide-y divide-slate-100 dark:divide-white/5"},Ns={key:0},Ts=["colspan"],Cs=["onClick"],Ls={class:"px-3 sm:px-6 py-4 text-xs font-bold text-slate-700 dark:text-slate-200"},As={class:"px-3 sm:px-6 py-4"},Us={class:"text-sm font-semibold text-slate-700 dark:text-slate-200"},Ps={class:"px-3 sm:px-6 py-4 text-right"},Rs=["onClick"],Ms={class:"px-3 sm:px-6 py-3 text-xs font-bold text-slate-700 dark:text-slate-200"},Fs={class:"px-3 sm:px-6 py-3 text-xs text-slate-600 dark:text-slate-300"},Es={key:1,id:"olt-reg-card",class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-white/10 overflow-hidden"},js={class:"p-4 md:p-5 border-b border-slate-100 dark:border-white/10 flex flex-col lg:flex-row lg:items-center justify-between gap-4"},Ds={class:"flex items-center gap-3"},Bs={class:"text-sm text-slate-500 dark:text-slate-400"},Is={class:"font-bold text-slate-700 dark:text-slate-200"},Vs={key:0,class:"px-4 md:px-5 pt-3 pb-3"},Ks={class:"text-xs"},Gs={key:0,class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent dark:via-white/10 animate-pulse"},zs={class:"relative flex items-center gap-3"},Hs={"data-status-text":""},Js={class:"px-4 md:px-5 pb-4 space-y-3"},qs={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ws=["value"],Zs={class:"text-[10px] text-slate-400 mt-1"},Qs={class:"relative"},Xs={class:"overflow-x-auto"},Ys={class:"w-full text-left text-sm whitespace-nowrap"},el={class:"bg-slate-50 dark:bg-slate-800/50 text-xs uppercase text-slate-500 dark:text-slate-400 font-bold border-b border-slate-100 dark:border-white/5"},tl=["aria-sort"],al=["aria-sort"],sl=["aria-sort"],ll=["aria-sort"],rl=["aria-sort"],nl={class:"divide-y divide-slate-100 dark:divide-white/5"},ol={key:0},il={colspan:"5",class:"px-3 sm:px-6 py-10 text-center text-slate-400 italic"},ul={key:1},dl={colspan:"5",class:"px-3 sm:px-6 py-10 text-center text-slate-400 italic"},cl={key:2},fl=["onClick"],pl={class:"px-3 sm:px-6 py-4 text-xs font-bold text-slate-700 dark:text-slate-200"},gl={class:"px-3 sm:px-6 py-4 text-sm font-semibold text-slate-700 dark:text-slate-200"},vl={class:"px-3 sm:px-6 py-4 text-xs text-slate-600 dark:text-slate-300"},xl={class:"px-3 sm:px-6 py-4"},bl={key:0,class:"bg-white dark:bg-slate-900/40"},ml={colspan:"5",class:"px-3 sm:px-6 py-4"},hl={key:0,class:"flex items-center gap-3 text-sm text-slate-500"},kl={key:1,class:"space-y-4"},yl={class:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs text-slate-600 dark:text-slate-300"},wl={class:"min-w-0 space-y-1"},_l={class:"font-semibold text-slate-700 dark:text-slate-200 break-all"},Sl={class:"min-w-0 space-y-1"},$l={key:0},Ol={key:1,class:"font-semibold text-slate-700 dark:text-slate-200"},Nl={class:"min-w-0 space-y-1"},Tl={class:"font-semibold text-slate-700 dark:text-slate-200 break-all"},Cl={class:"min-w-0 space-y-1"},Ll={class:"font-semibold text-slate-700 dark:text-slate-200"},Al={class:"min-w-0 space-y-1"},Ul={class:"flex flex-wrap gap-2"},Pl=["disabled","onClick"],Rl={key:0,class:"inline-flex h-4 w-4 items-center justify-center"},Ml=["onClick"],Fl=["disabled","onClick"],El={key:0,class:"inline-flex h-4 w-4 items-center justify-center"},jl=["disabled","onClick"],Dl={key:0,class:"inline-flex h-4 w-4 items-center justify-center"},Bl=["disabled","onClick"],Il={key:0,class:"inline-flex h-4 w-4 items-center justify-center"},Vl={class:"px-4 md:px-5 py-3 border-t border-slate-100 dark:border-white/5 flex items-center justify-between gap-3"},Kl={class:"text-xs text-slate-500 dark:text-slate-400"},Gl={key:0},zl={key:1},Hl={class:"flex items-center gap-2"},Jl=["disabled"],ql=["disabled"],Wl={key:2,class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-white/10 overflow-hidden"},Zl={class:"p-4 border-b border-slate-100 dark:border-white/5 flex items-center justify-between gap-3"},Ql={class:"flex items-center gap-2"},Xl={key:0,class:"inline-flex items-center gap-2 text-[11px] text-slate-400"},Yl={class:"flex items-center gap-2 shrink-0"},er={class:"inline-flex rounded-lg border border-slate-200 dark:border-white/10 overflow-hidden"},tr={class:"p-4 text-[11px] bg-slate-900 text-slate-100 overflow-x-auto max-h-80 whitespace-pre-wrap"},ar={key:3,class:"fixed inset-0 z-[80]"},sr={class:"absolute top-1/2 left-1/2 w-[92%] max-w-lg -translate-x-1/2 -translate-y-1/2 p-4"},lr={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-white/10 shadow-2xl overflow-hidden"},rr={class:"p-5 border-b border-slate-100 dark:border-white/10 flex items-center justify-between"},nr={class:"text-sm font-black text-slate-800 dark:text-white uppercase"},or={class:"p-5 space-y-4"},ir={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},ur={class:"sm:col-span-2"},dr={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},cr={class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},fr={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},pr={class:"p-5 border-t border-slate-100 dark:border-white/10 flex items-center justify-between gap-3"},gr={class:"flex items-center gap-2 ml-auto"},vr={key:4,id:"olt-sync-modal",class:"fixed inset-0 z-[80]"},xr={class:"absolute top-1/2 left-1/2 w-[92%] max-w-md -translate-x-1/2 -translate-y-1/2"},br={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-white/10 shadow-xl p-5"},mr={class:"flex items-start gap-3"},hr={class:"flex-1"},kr={id:"olt-sync-text",class:"text-xs text-slate-500 mt-1"},yr={id:"olt-sync-note",class:"text-[11px] text-slate-400 mt-2"},wr={id:"olt-sync-eta",class:"text-[11px] text-slate-400 mt-1"},_r={class:"mt-3 h-2 rounded-full bg-slate-100 dark:bg-slate-800 overflow-hidden"},Sr={id:"olt-sync-percent",class:"mt-2 text-[11px] text-slate-500"},w="/api/v1",Tr={__name:"Index",setup($r){const zt=Fa(),mt=E(()=>{var a,e;return String(((e=(a=zt.props.auth)==null?void 0:a.user)==null?void 0:e.role)||"").trim().toLowerCase()}),q=E(()=>["teknisi","svp lapangan","svp_lapangan"].includes(mt.value)),z=E(()=>q.value||["admin","cs","owner"].includes(mt.value)),ht={},kt={};async function y(a,e={}){const t=await fetch(a,{headers:{Accept:"application/json",...e.headers||{}},...e}),l=String(t.headers.get("content-type")||"").toLowerCase(),r=await t.text();let n=null;if(l.includes("application/json"))try{n=JSON.parse(r)}catch{}if(!t.ok){const o=n&&(n.message||n.error)?String(n.message||n.error):`HTTP ${t.status}`,g=new Error(o);throw g.status=t.status,g.data=n,g.body=r,g}if(n===null)throw new Error("Non-JSON response");return n}function Ae(a){const e=Array.isArray(a)?a.slice():[];return e.sort((t,l)=>{const r=String(t||"").split("/").map(o=>parseInt(o,10)||0),n=String(l||"").split("/").map(o=>parseInt(o,10)||0);return(r[0]||0)!==(n[0]||0)?(r[0]||0)-(n[0]||0):(r[1]||0)!==(n[1]||0)?(r[1]||0)-(n[1]||0):(r[2]||0)-(n[2]||0)}),e}function Ue(a){const e={info:{container:"bg-slate-50/80 dark:bg-slate-900/60 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-white/10",dot:"bg-slate-400"},success:{container:"bg-emerald-50/80 dark:bg-emerald-500/10 text-emerald-700 dark:text-emerald-300 border-emerald-200/70 dark:border-emerald-500/30",dot:"bg-emerald-500"},error:{container:"bg-red-50/80 dark:bg-red-500/10 text-red-700 dark:text-red-300 border-red-200/70 dark:border-red-500/30",dot:"bg-red-500"},loading:{container:"bg-blue-50/80 dark:bg-blue-500/10 text-blue-700 dark:text-blue-300 border-blue-200/70 dark:border-blue-500/30",dot:"bg-blue-500"}};return e[a]||e.info}function ie(a){if(a==null||a==="")return null;if(typeof a=="number"&&Number.isFinite(a))return a;const e=String(a).match(/-?\d+(\.\d+)?/);if(!e)return null;const t=parseFloat(e[0]);return Number.isFinite(t)?t:null}function yt(a){const e=ie(a);return e===null?"-":`${e.toFixed(2)} dBm`}function wt(a){const e=String(a||"").trim().toLowerCase();return e?["online","ready","working","up","active","enable","enabled","auth"].includes(e)?"online":["offline","down","inactive","disable","disabled","unauth","los","oos","dying"].includes(e)?"offline":e.indexOf("online")!==-1?"online":e.indexOf("offline")!==-1?"offline":"":""}function Ht(a){const e=wt(a==null?void 0:a.state);if(e)return e;const t=wt(a==null?void 0:a.status);return t&&t!=="offline"||t==="online"?t:""}function Pe(a){const e=Ht(a);return e||(ie(a==null?void 0:a.rx)!==null?"online":"offline")}function Jt(a){return a===null?"text-slate-600 dark:text-slate-300":a>=-25?"text-emerald-600 dark:text-emerald-300":a>=-28?"text-amber-600 dark:text-amber-300":"text-rose-600 dark:text-rose-300"}function _t(a){const e=ie(a==null?void 0:a.rx);return e===null?"text-slate-400":Jt(e)}function qt(a,e){return e?a===null||a>=-25?"bg-emerald-50 text-emerald-700 dark:bg-emerald-500/15 dark:text-emerald-200":a>=-28?"bg-amber-50 text-amber-700 dark:bg-amber-500/15 dark:text-amber-200":"bg-rose-50 text-rose-700 dark:bg-rose-500/15 dark:text-rose-200":"bg-slate-100 text-slate-600 dark:bg-slate-700/40 dark:text-slate-300"}function at(a){const e=Pe(a)==="online",t=ie(a==null?void 0:a.rx);return{label:e?"Online":"Offline",className:qt(t,e)}}function m(a){const e=String((a==null?void 0:a.fsp)||""),t=Number((a==null?void 0:a.onu_id)||0);return a!=null&&a.interface?String(a.interface):e&&t>0?`gpon-onu_${e}:${t}`:`${e}:${t}`}const me=f([]),st=f(!1),u=f(""),P=E(()=>me.value.find(a=>String(a.id)===String(u.value))||null),Wt=E(()=>{if(!P.value)return z.value?"Langkah singkat: pilih OLT, scan Uncfg, ketuk SN, isi nama ONU, lalu registrasi.":"Langkah singkat: pilih OLT, scan Uncfg, pilih SN, isi nama ONU, lalu registrasi.";if(z.value)return`OLT dipilih: ${P.value.nama_olt||"OLT"}. Scan Uncfg lalu ketuk SN untuk registrasi.`;const a=P.value.host||"-",e=P.value.port||"-",t=P.value.vlan_default||"-",l=P.value.tcont_default||"-",r=P.value.onu_type_default||"-",n=P.value.service_port_id_default||"-";return`Host ${a}:${e} | VLAN ${t} | TCONT ${l} | ONU ${r} | SP ${n}`});function Zt(a){const e=String(a||"").trim();return e?e.replace(/\s+/g,"").replace(/[^A-Za-z0-9_.-]/g,"").slice(0,32):""}function St(){return["show gpon onu uncfg","parsing output","filtering results","sync table"]}function Qt({fsp:a,sn:e,name:t}){var k,O,T;const l=String(a||"x/x/x"),r=String(e||"SN"),n=Zt(t)||t||`ONU-${r}`,o=((k=P.value)==null?void 0:k.tcont_default)||"pppoe",g=((O=P.value)==null?void 0:O.vlan_default)||"",b=((T=P.value)==null?void 0:T.service_port_id_default)||"",i=[];return i.push("conf t"),i.push(`interface gpon-olt_${l}`),i.push(`onu <auto-id> sn ${r}`),i.push(`interface gpon-onu_${l}`),i.push(`name ${n}`),i.push(`tcont profile ${o}`),g&&b&&i.push(`service-port ${b} vlan ${g}`),i.push("pon-onu-mng"),i.push("end"),i}async function lt(){st.value=!0;try{const a=await y(`${w}/olts`);me.value=a.status==="ok"?a.data:[],u.value&&!me.value.some(e=>String(e.id)===String(u.value))&&(u.value="")}catch{me.value=[]}finally{st.value=!1}}const ee=f(!1),H=f(null),h=f({nama_olt:"",host:"",port:23,username:"",password:"",tcont_default:"pppoe",vlan_default:200,onu_type_default:"ALL-ONT",service_port_id_default:1}),rt=f(!1),nt=f("Menyiapkan proses..."),ot=f("Mohon tunggu, jangan menutup halaman."),it=f("Estimasi: menghitung..."),Re=f(0);function Xt(a){nt.value=String(a),ot.value="Mohon tunggu, jangan menutup halaman.",it.value="Estimasi: menghitung...",Re.value=0,rt.value=!0}function ut(a,e,t,l){nt.value=String(a||""),Re.value=Math.max(0,Math.min(100,Number(e||0))),t!==void 0&&(ot.value=String(t||"")),l!==void 0&&(it.value=String(l||""))}function Yt(){rt.value=!1}async function $t(a){if(a==="edit"){if(!u.value){alert("Pilih OLT dulu.");return}try{const e=await y(`${w}/olts/${u.value}`),t=e==null?void 0:e.data;if(!t)throw new Error("OLT tidak ditemukan");H.value=t.id,h.value={nama_olt:t.nama_olt||"",host:t.host||"",port:t.port||23,username:t.username||"",password:"",tcont_default:t.tcont_default||"pppoe",vlan_default:Number(t.vlan_default||200),onu_type_default:t.onu_type_default||"ALL-ONT",service_port_id_default:Number(t.service_port_id_default||1)},ee.value=!0}catch(e){alert(`Error: ${e.message}`)}return}H.value=null,h.value={nama_olt:"",host:"",port:23,username:"",password:"",tcont_default:"pppoe",vlan_default:200,onu_type_default:"ALL-ONT",service_port_id_default:1},ee.value=!0}async function ea(){var e;const a={nama_olt:String(h.value.nama_olt||"").trim(),host:String(h.value.host||"").trim(),port:Number(h.value.port||23),username:String(h.value.username||"").trim(),password:String(h.value.password||""),tcont_default:String(h.value.tcont_default||"").trim(),vlan_default:Number(h.value.vlan_default||0),onu_type_default:String(h.value.onu_type_default||"").trim(),service_port_id_default:Number(h.value.service_port_id_default||0)};if(!a.nama_olt||!a.host||!a.username){alert("Nama OLT, Host, dan Username wajib diisi.");return}try{let t=null;if(H.value){const l=await y(`${w}/olts/${H.value}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(l.status!=="ok")throw new Error(l.message||"Gagal menyimpan")}else{if(!a.password){alert("Password wajib diisi untuk OLT baru.");return}const l=await y(`${w}/olts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(l.status!=="ok")throw new Error(l.message||"Gagal menyimpan");t=(e=l==null?void 0:l.data)!=null&&e.id?Number(l.data.id):null}ee.value=!1,await lt(),t?(u.value=String(t),confirm(`Muat data ONU terdaftar?

Sistem akan mengambil semua ONU registered dan menyimpan ke database.`)&&await ta(t)):await Me()}catch(t){alert(`Error: ${t.message}`)}}async function ta(a,e={}){const t=parseInt(String(a||"0"),10)||0;if(!t){alert("OLT tidak valid untuk sync.");return}Xt("Menyiapkan daftar FSP...");const l=Date.now(),r=(n,o)=>{if(!n||!o||o<=n)return"Estimasi: menghitung...";const g=(Date.now()-l)/1e3;if(g<=1)return"Estimasi: menghitung...";const b=n/g;if(b<=0)return"Estimasi: menghitung...";const i=Math.max(0,Math.round((o-n)/b));if(!i)return"Estimasi: < 1 menit";const k=Math.floor(i/60),O=i%60;return`Estimasi: ${k>0?`${k}m `:""}${O}s`};try{const n=await y(`${w}/olts/${t}/fsp`),o=n.status==="ok"&&Array.isArray(n.data)?n.data.filter(Boolean):[];if(!o.length){ut("Tidak ada FSP yang ditemukan.",100,"Tidak ada data untuk disinkronkan.","Estimasi: -"),v("Tidak ada FSP untuk disinkronkan.","error");return}const g=o.length;let b=0,i=0;for(let k=0;k<o.length;k+=1){const O=o[k];let T=0,Z=null,xt=0,Vt=!1;for(;!Vt;){const Ta=`Sync FSP ${O} (${k+1}/${o.length})`,Ca=Z?Math.min(100,Math.round(xt/Z*100)):0,La=Math.min(99,Math.round((k+Ca/100)/g*100));ut(`${Ta}...`,La,Z?`FSP ${k+1}/${g} | ${xt}/${Z} ONU`:`FSP ${k+1}/${g} | Menghitung total ONU...`,r(b,i));const Q=await y(`${w}/olts/${t}/sync-onu-names`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fsp:O,offset:T,limit:20,only_missing:!1})});if(Q.status!=="ok")throw new Error(Q.message||"Gagal sync ONU");Z===null&&typeof Q.total=="number"&&(Z=Q.total,i+=Z),b+=Q.processed||0,Z&&(xt=Math.min(Z,(Q.offset||0)+(Q.processed||0))),Vt=!!Q.done,T=Q.next_offset||0}}ut("Sinkronisasi selesai.",100,`Total ONU: ${b}`,"Estimasi: selesai"),v(`Deep sync selesai. Total ONU: ${b}.`,"success"),String(u.value||"")===String(t)&&Me().catch(()=>{})}catch(n){v(n.message||"Gagal memuat data ONU","error")}finally{Yt()}}async function aa(){if(H.value&&confirm("Hapus profil OLT ini? Semua data ONU cache akan ikut terhapus."))try{const a=await y(`${w}/olts/${H.value}`,{method:"DELETE"});if(a.status!=="ok")throw new Error(a.message||"Gagal menghapus");String(u.value)===String(H.value)&&(u.value=""),ee.value=!1,await lt()}catch(a){alert(`Error: ${a.message}`)}}const N=f([]),Ot=f(!1);async function Me(){if(!u.value){N.value=[];return}Ot.value=!0;try{const a=await y(`${w}/olts/${u.value}/fsp`),e=a.status==="ok"?a.data:[];N.value=Ae(e)}catch{N.value=[]}finally{Ot.value=!1}}const A=f([]),Fe=f(!1),W=f(null),Ee=E(()=>W.value===null?null:A.value[W.value]||null),ve=f(""),K=f(!1),te=f(!1),he=f("Registrasi berjalan..."),xe=f(!1),J=f({tone:"info",message:""});let je=null,De=[],Be=0,dt="",ke="uncfg";function Ie(){je&&(clearInterval(je),je=null)}function sa(a){const e=String(a||"");if(ke==="reg"){ae.value={...ae.value,message:e};return}J.value={...J.value,message:e},te.value&&e&&(he.value=e)}function ct(a,e,t="uncfg"){const l=Array.isArray(e)?e.filter(Boolean):[];if(!l.length){t==="reg"?v(a,"loading"):$(a,"loading");return}De=l,Be=0,dt=String(a||""),ke=t==="reg"?"reg":"uncfg",Ie();const r=`${dt} | ${De[0]}`;ke==="reg"?v(r,"loading"):$(r,"loading"),je=setInterval(()=>{Be=(Be+1)%De.length,sa(`${dt} | ${De[Be]}`)},900)}function $(a,e="info"){e!=="loading"&&Ie(),ke="uncfg",J.value={tone:e,message:String(a||"")},te.value&&J.value.message&&(he.value=J.value.message)}function Ve(){W.value=null,ve.value=""}function Nt(a){z.value&&(a<0||a>=A.value.length||(W.value=a,ve.value=""))}function Ke(a){if(!z.value)return;const e=String(a||"").trim();e&&(ht[e]={list:Array.isArray(A.value)?A.value.slice():[],selectedIndex:typeof W.value=="number"?W.value:null})}function la(a){if(!z.value)return!1;const e=String(a||"").trim();if(!e)return!1;const t=ht[e];return!t||!Array.isArray(t.list)?!1:(A.value=t.list.slice(),W.value=typeof t.selectedIndex=="number"?t.selectedIndex:null,ve.value="",!0)}async function ra(){if(!u.value){$("Pilih OLT dulu.","error");return}Fe.value=!0,ct("Sedang scan ONU",St(),"uncfg");try{const a=await y(`${w}/olts/${u.value}/scan-uncfg`);A.value=a.status==="ok"?Array.isArray(a.data)?a.data:[]:[],Ve(),Ke(u.value),$(`Scan selesai. Ditemukan ${A.value.length} ONU.`,"success")}catch(a){$(a.message||"Gagal scan ONU.","error")}finally{Fe.value=!1}}async function Tt(){var a;if(!u.value)return $("Pilih OLT dulu.","error"),!1;if(confirm("Simpan config OLT sekarang? (write)")){$("Menulis konfigurasi (write)...","loading");try{const e=await y(`${w}/olts/${u.value}/write-config`,{method:"POST"});if(e.status!=="ok")throw new Error(e.message||"Write gagal");return e!=null&&e.log_excerpt&&(C.value=String(e.log_excerpt)),$(e.message||"Write selesai.","success"),!0}catch(e){return(a=e==null?void 0:e.data)!=null&&a.log_excerpt&&(C.value=String(e.data.log_excerpt)),$(e.message||"Write gagal","error"),!1}finally{ge().catch(()=>{})}}}async function na(){if(!q.value)return;if(!xe.value){$("Tidak ada data yang harus disimpan.","info");return}await Tt()&&(xe.value=!1)}async function oa(){var e;if(!u.value){$("Pilih OLT dulu.","error");return}if(!confirm("Auto register semua ONU unregistered?"))return;const a=prompt("Prefix nama ONU (opsional, max 16). Contoh: RT01","")||"";$("Auto register berjalan...","info"),K.value=!0,ct("Auto register berjalan",St(),"uncfg");try{const t=await y(`${w}/olts/${u.value}/auto-register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name_prefix:a})});if(t.status!=="ok")throw new Error(t.message||"Auto register gagal");t!=null&&t.log_excerpt&&(C.value=String(t.log_excerpt));const l=t.summary||{};$(t.message||`Auto register selesai. Success ${l.success||0}, error ${l.error||0}.`,"success"),A.value=[],Ve(),Ke(u.value),j.value="all",await Qe()}catch(t){(e=t==null?void 0:t.data)!=null&&e.log_excerpt&&(C.value=String(t.data.log_excerpt)),$(t.message||"Auto register gagal","error")}finally{K.value=!1,ge().catch(()=>{})}}async function ia(){var t;if(!u.value)return;const a=Ee.value;if(!a){$("Pilih ONU unregistered dulu.","error");return}const e=String(ve.value||"").trim();if(!e){$("Nama ONU wajib diisi.","error");return}K.value=!0,te.value=!0,he.value="Registrasi berjalan...",ct("Registrasi berjalan",Qt({fsp:a.fsp,sn:a.sn,name:e}),"uncfg");try{const l={fsp:a.fsp,sn:a.sn,name:e},r=await y(`${w}/olts/${u.value}/register-onu`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(r.status!=="ok")throw new Error(r.message||"Gagal register");r!=null&&r.log_excerpt&&(C.value=String(r.log_excerpt)),A.value=A.value.filter(k=>String(k.sn)!==String(a.sn)),Ve(),Ke(u.value),$("ONU berhasil diregistrasi.","success"),q.value&&(xe.value=!0);const n=(r==null?void 0:r.data)||{},o=String(n.fsp||a.fsp||""),g=n.onu_id?Number(n.onu_id):0,b=String(n.sn||a.sn||""),i=String(n.name||e||"");o&&!N.value.includes(o)&&(N.value=Ae(N.value.concat(o))),o&&g>0&&ua({fsp:o,onu_id:g,sn:b,name:i}),o&&(j.value=o,await Qe(),g>0&&Rt(`gpon-onu_${o}:${g}`))}catch(l){(t=l==null?void 0:l.data)!=null&&t.log_excerpt&&(C.value=String(l.data.log_excerpt)),$(l.message||"Gagal register","error")}finally{K.value=!1,te.value=!1,ge().catch(()=>{})}}const x=f([]),ye=f(!1),we=f(""),j=f(""),U=f({}),ae=f({tone:"info",message:""}),G=f(""),R=f(!1),_=f(1),_e=f(25),I=f("interface"),se=f("asc"),Ge=f(""),M=f(""),ze=f(""),le=f({}),ue=f(""),de=f(""),He=f(""),Je=f("");function ua({fsp:a,onu_id:e,sn:t,name:l}){const r=String(a||"").trim(),n=Number(e||0);if(!r||!n)return;const o=String(t||"").trim(),g=String(l||"").trim(),b=`gpon-onu_${r}:${n}`,i=`${r}:${n}`,k=Array.isArray(x.value)?x.value.slice():[],O=k.findIndex(T=>T?!!(String(T.fsp||"")===r&&Number(T.onu_id||0)===n||o&&String(T.sn||"")===o):!1);if(O>=0){const T=k[O]||{};k[O]={...T,fsp:r,onu_id:n,interface:T.interface||b,fsp_onu:T.fsp_onu||i,sn:T.sn||o,name:g&&(!T.name||String(T.name)==="-")?g:T.name}}else k.push({fsp:r,onu_id:n,interface:b,fsp_onu:i,sn:o,state:"",status:"offline",rx:"",name:g,online_duration:"",vlan:0});x.value=k}function v(a,e="info"){e!=="loading"&&Ie(),ke="reg",ae.value={tone:e,message:String(a||"")}}function re(){ue.value="",de.value=""}function Se(a){const e=String(a||"").trim();e&&(I.value===e?se.value=se.value==="asc"?"desc":"asc":(I.value=e,se.value="asc"),_.value=1)}function Ct(a){return String(a||"").split("/").map(e=>parseInt(e,10)||0)}function da(a,e){const t=Ct(a),l=Ct(e);return(t[0]||0)!==(l[0]||0)?(t[0]||0)-(l[0]||0):(t[1]||0)!==(l[1]||0)?(t[1]||0)-(l[1]||0):(t[2]||0)-(l[2]||0)}function Lt(a){const e=String(a||"").trim().toLowerCase();return e||null}function At(a,e,t,l){const r=a==null||a==="",n=e==null||e==="";if(r&&n)return 0;if(r)return 1;if(n)return-1;const o=t(a,e);return o===0?0:o*l}function Ut(a){if(a==null||a==="")return null;const e=Number(a);return Number.isFinite(e)?e:null}function Pt(a,e,t){return At(Ut(a),Ut(e),(l,r)=>l===r?0:l<r?-1:1,t)}function $e(a,e,t){return At(Lt(a),Lt(e),(l,r)=>l.localeCompare(r),t)}function ca(a){const e=se.value==="desc"?-1:1,t=I.value||"interface";return(Array.isArray(a)?a.slice():[]).sort((r,n)=>{if(t==="interface"){const o=da(r==null?void 0:r.fsp,n==null?void 0:n.fsp);if(o!==0)return o*e;const g=Pt(r==null?void 0:r.onu_id,n==null?void 0:n.onu_id,e);return g!==0?g:$e(r==null?void 0:r.sn,n==null?void 0:n.sn,e)}return t==="name"?$e(r==null?void 0:r.name,n==null?void 0:n.name,e):t==="sn"?$e(r==null?void 0:r.sn,n==null?void 0:n.sn,e):t==="rx"?Pt(ie(r==null?void 0:r.rx),ie(n==null?void 0:n.rx),e):t==="status"?$e(Pe(r),Pe(n),e):$e((r==null?void 0:r.fsp_onu)||(r==null?void 0:r.interface),(n==null?void 0:n.fsp_onu)||(n==null?void 0:n.interface),e)})}function Oe(a){const e=String(a||"").trim();return e?I.value!==e?"↕":se.value==="asc"?"↑":"↓":""}function Ne(a){const e=String(a||"").trim();return!e||I.value!==e?"none":se.value==="asc"?"ascending":"descending"}let Te=null;function Rt(a){Ge.value=String(a||""),Te&&(clearTimeout(Te),Te=null),Ge.value&&(Te=setTimeout(()=>{Ge.value="",Te=null},2400))}const Mt=E(()=>String(G.value||"").trim().toLowerCase()),ft=E(()=>{let a=Array.isArray(x.value)?x.value.slice():[];const e=String(j.value||"").trim()||"all";if(e!=="all"&&(a=a.filter(t=>String((t==null?void 0:t.fsp)||"")===e)),!R.value&&Mt.value){const t=Mt.value;a=a.filter(l=>`${l.fsp_onu||""} ${l.interface||""} ${l.fsp||""}:${l.onu_id||""} ${l.sn||""} ${l.name||""} ${Pe(l)}`.toLowerCase().includes(t))}return ca(a)}),qe=E(()=>ft.value.length),be=E(()=>Math.max(1,Math.ceil(qe.value/_e.value))),We=E(()=>(Math.max(1,_.value)-1)*_e.value),pt=E(()=>ft.value.slice(We.value,We.value+_e.value));bt(be,()=>{_.value>be.value&&(_.value=be.value),_.value<1&&(_.value=1)});function Ze(a){const e=String(a||"").trim();return e?x.value.some(t=>String((t==null?void 0:t.fsp)||"")===e):!1}function gt(a,e,t=!0){const l=String(a||"").trim();if(!l)return;const r=Array.isArray(e)?e:[],n=Array.isArray(x.value)?x.value:[],o={};t&&n.forEach(i=>{String((i==null?void 0:i.fsp)||"")===l&&(o[m(i)]=i)});let g=t?n.filter(i=>String((i==null?void 0:i.fsp)||"")!==l):n.slice();const b=new Set(g.map(i=>m(i)));r.forEach(i=>{const k=m(i);if(!t&&b.has(k))return;const O=o[k];O&&(!i.name&&O.name&&(i.name=O.name),!i.online_duration&&O.online_duration&&(i.online_duration=O.online_duration),(i.rx===null||i.rx===void 0||i.rx==="")&&O.rx&&(i.rx=O.rx)),g.push(i)}),x.value=g}const fa=E(()=>{const a=Array.isArray(N.value)?N.value.length:0,e=Object.keys(U.value||{}).length;return a?`FSP dimuat: ${e}/${a}`:"FSP belum dimuat."});async function Ft({fsp:a="",search:e=""}={}){if(!u.value)return;const t=new URLSearchParams;a&&t.set("fsp",a),e&&t.set("search",e);const l=`${w}/olts/${u.value}/cache${t.toString()?`?${t}`:""}`,r=await y(l),n=r.status==="ok"?Array.isArray(r.data)?r.data:[]:[];if(e){x.value=n;return}a?gt(a,n,!0):x.value=n}async function Et(a,{silent:e=!1}={}){if(!(!u.value||!a)){ye.value=!0,we.value="Memuat data dari OLT...",e||v("Memuat data dari OLT...","info");try{const t=await y(`${w}/olts/${u.value}/registered?fsp=${encodeURIComponent(a)}`);if(t.status==="ok"){const l=Array.isArray(t.data)?t.data:[],r=Ze(a),n=l.length>0||!r;n&&gt(a,l,!0),U.value={...U.value,[a]:!0},e||(n?v(`FSP ${a} siap.`,"success"):v("Hasil telnet kosong, menampilkan cache ONU.","info"))}}catch(t){e||v(t.message||"Gagal memuat data dari OLT.","error")}finally{ye.value=!1,we.value=""}}}async function pa({force:a=!1,silent:e=!1}={}){if(!u.value)return;N.value.length||await Me();const t=Array.isArray(N.value)?N.value.filter(r=>r&&r!=="all"):[];if(!t.length){e||v("FSP belum dimuat.","error");return}const l=a?t:t.filter(r=>{var n;return!((n=U.value)!=null&&n[r])});if(!l.length){e||v("Semua FSP sudah dimuat.","info");return}for(const r of l)if(!Ze(r))try{await Ft({fsp:r})}catch{}ye.value=!0,we.value="Memuat data FSP...",e||v("Memuat data FSP...","info");try{const r=await y(`${w}/olts/${u.value}/registered-all`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fsp_list:l})});if(r.status!=="ok")throw new Error(r.message||"Gagal memuat data FSP");const n=Array.isArray(r.data)?r.data:[],o={};n.forEach(b=>{const i=String((b==null?void 0:b.fsp)||"").trim();i&&(o[i]||(o[i]=[]),o[i].push(b))}),l.forEach(b=>{const i=o[b]||[],k=Ze(b);(i.length>0||!k)&&gt(b,i,!0)});const g={...U.value||{}};l.forEach(b=>{g[b]=!0}),U.value=g,e||v(`Load FSP selesai (${l.length}).`,"success")}catch(r){e||v(r.message||"Gagal memuat data FSP.","error")}finally{ye.value=!1,we.value=""}}async function Qe(){var e;if(R.value&&tt(),_.value=1,M.value="",re(),!u.value)return;const a=String(j.value||"");if(a){if(a==="all"){await pa({force:!1,silent:!1});return}try{Ze(a)||await Ft({fsp:a})}catch{}(e=U.value)!=null&&e[a]||Et(a,{silent:!0}).catch(()=>{})}}const Xe=f(null);let ce=null,fe=null,Ye="",et="",Ce=!1;function ga(){R.value||(R.value=!0,Xe.value={list:Array.isArray(x.value)?x.value.slice():[],loadedFsp:{...U.value||{}},page:_.value||1,expandedKey:M.value||"",editingKey:ue.value||"",editingName:de.value||""},x.value=[],U.value={},_.value=1,M.value="",re())}function tt(){if(!R.value)return;R.value=!1;const a=Xe.value;if(Xe.value=null,a){x.value=Array.isArray(a.list)?a.list.slice():[],U.value=a.loadedFsp?{...a.loadedFsp}:{},_.value=a.page||1,M.value=a.expandedKey||"",ue.value=a.editingKey||"",de.value=a.editingName||"";return}x.value=[],U.value={},_.value=1,M.value="",re()}function jt(a){const e=String(a||"").trim();return e===""||/\s/.test(e)?!1:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z0-9]{8,20}$/.test(e)}async function va(a){if(!u.value)return;const e=String(a||"").trim();if(e.length<2)return;const t=await y(`${w}/olts/${u.value}/search?q=${encodeURIComponent(e)}`);if(t.status!=="ok")throw new Error(t.message||"Gagal mencari data");String(G.value||"").trim()===e&&(!R.value||String(j.value||"")!==""||(x.value=Array.isArray(t.data)?t.data:[],!x.value.length&&jt(e)&&Dt(e).catch(()=>{})))}async function Dt(a){if(!u.value)return;const e=String(a||"").trim();if(e){R.value&&tt(),v(`Mencari SN ${e}...`,"info");try{const t=await y(`${w}/olts/${u.value}/find-onu-by-sn`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sn:e})});if(t.status!=="ok")throw new Error(t.message||"SN tidak ditemukan.");const l=t.data||{};if(!l.fsp){v("SN tidak ditemukan.","error");return}l.fsp&&!N.value.includes(l.fsp)&&(N.value=Ae(N.value.concat(l.fsp))),j.value=String(l.fsp),await Qe();const r=String(l.interface||(l.fsp&&l.onu_id?`gpon-onu_${l.fsp}:${l.onu_id}`:"")).trim();r&&Rt(r),v(`SN ditemukan di FSP ${l.fsp}.`,"success")}catch(t){v(t.message||"SN tidak ditemukan.","error")}}}bt(()=>String(G.value||""),a=>{if(Ce)return;const e=String(a||"").trim();if(_.value=1,M.value="",re(),ce&&(clearTimeout(ce),ce=null),fe&&(clearTimeout(fe),fe=null),!e){Ye="",et="",R.value&&tt();return}if(!String(j.value||"").trim()){if(e.length<2){v("Minimal 2 karakter untuk pencarian.","error");return}ga(),v("Mencari di cache ONU...","info"),ce=setTimeout(()=>{String(G.value||"").trim()===e&&(!R.value||String(j.value||"")!==""||Ye!==e&&(Ye=e,va(e).catch(t=>{String(G.value||"").trim()===e&&v(t.message||"Gagal mencari data","error")})))},450);return}R.value&&tt(),jt(e)&&(ft.value.length>0||(fe=setTimeout(()=>{String(G.value||"").trim()===e&&et!==e&&(et=e,Dt(e))},600)))});function ne(a,e){return He.value===a&&Je.value===e}function oe(a,e,t){if(!t){He.value===a&&Je.value===e&&(He.value="",Je.value="");return}He.value=a,Je.value=e}async function xa(a){const e=m(a);if(M.value===e){M.value="",ue.value===e&&re();return}M.value=e,await Bt(a,{force:!1,silent:!0})}async function Bt(a,{force:e=!1,silent:t=!1}={}){if(!u.value)return;const l=m(a);if(!(!e&&le.value[l])){ze.value=l;try{const r=new URLSearchParams({fsp:String(a.fsp||""),onu_id:String(a.onu_id||"")}),n=await y(`${w}/olts/${u.value}/onu-detail?${r}`);if(n.status!=="ok")throw new Error(n.message||"Gagal load detail");le.value={...le.value,[l]:n.data||{}};const o=x.value.findIndex(g=>m(g)===l);if(o>=0){const b={...x.value[o]||{},...n.data||{}},i=x.value.slice();i[o]=b,x.value=i}t||v("Detail ONU dimuat.","success")}catch(r){t||v(r.message||"Gagal load detail","error")}finally{ze.value===l&&(ze.value="")}}}function ba(a){const e=m(a);ue.value=e,de.value=String(a.name||"").trim()}async function ma(a){var l;if(!u.value)return;const e=m(a),t=String(de.value||"").trim();if(!t){v("Nama ONU wajib diisi.","error");return}oe(e,"rename",!0);try{const r=await y(`${w}/olts/${u.value}/update-onu-name`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fsp:String(a.fsp||""),onu_id:Number(a.onu_id||0),name:t})});if(r.status!=="ok")throw new Error(r.message||"Gagal update nama");r!=null&&r.log_excerpt&&(C.value=String(r.log_excerpt));const n=x.value.findIndex(o=>m(o)===e);if(n>=0){const o=x.value[n]||{},g=x.value.slice();g[n]={...o,name:t},x.value=g}le.value[e]&&(le.value={...le.value,[e]:{...le.value[e],name:t}}),re(),v("Nama ONU berhasil diupdate.","success"),q.value&&(xe.value=!0)}catch(r){(l=r==null?void 0:r.data)!=null&&l.log_excerpt&&(C.value=String(r.data.log_excerpt)),v(r.message||"Gagal update nama","error")}finally{oe(e,"rename",!1),ge().catch(()=>{})}}async function ha(a){const e=m(a);oe(e,"refresh",!0);try{await Bt(a,{force:!0,silent:!0}),v("Detail ONU di-refresh.","success");const t=String((a==null?void 0:a.fsp)||"").trim();t&&Et(t,{silent:!0}).catch(()=>{})}catch(t){v(t.message||"Gagal refresh","error")}finally{oe(e,"refresh",!1)}}async function ka(a){var t;if(!u.value)return;const e=m(a);if(confirm(`Restart ONU ${a.fsp}:${a.onu_id}?`)){oe(e,"restart",!0);try{v("Mengirim perintah restart ONU...","loading");const l=await y(`${w}/olts/${u.value}/restart-onu`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fsp:String(a.fsp||""),onu_id:Number(a.onu_id||0)})});if(l.status!=="ok")throw new Error(l.message||"Restart gagal");l!=null&&l.log_excerpt&&(C.value=String(l.log_excerpt)),v(l.message||"ONU sedang di-restart.","success")}catch(l){(t=l==null?void 0:l.data)!=null&&t.log_excerpt&&(C.value=String(l.data.log_excerpt)),v(l.message||"Restart gagal","error")}finally{oe(e,"restart",!1),ge().catch(()=>{})}}}async function ya(a){var t;if(!u.value)return;const e=m(a);if(confirm(`Hapus ONU ${a.fsp}:${a.onu_id}?`)){oe(e,"delete",!0);try{v("Menghapus ONU dari OLT...","loading");const l=await y(`${w}/olts/${u.value}/delete-onu`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fsp:String(a.fsp||""),onu_id:Number(a.onu_id||0)})});if(l.status!=="ok")throw new Error(l.message||"Hapus gagal");l!=null&&l.log_excerpt&&(C.value=String(l.log_excerpt)),x.value=x.value.filter(r=>m(r)!==e),M.value===e&&(M.value=""),v("ONU berhasil dihapus.","success"),q.value&&(xe.value=!0)}catch(l){(t=l==null?void 0:l.data)!=null&&t.log_excerpt&&(C.value=String(l.data.log_excerpt)),v(l.message||"Hapus gagal","error")}finally{oe(e,"delete",!1),ge().catch(()=>{})}}}const D=f([]),vt=f(!1),pe=f("latest"),C=f("");function wa(a){const e=Array.isArray(a)?a:[];return e.length?e.map(t=>{const l=t!=null&&t.created_at?String(t.created_at).replace("T"," ").slice(0,19):"",r=t!=null&&t.action?String(t.action):"",n=t!=null&&t.status?String(t.status):"",o=t!=null&&t.actor?String(t.actor):"",g=t!=null&&t.log_text?String(t.log_text):"";return`[${l}] ${r} ${n}${o?` (${o})`:""}
${g}`.trim()}).join(`

`):"Log akan tampil di sini."}const It=E(()=>{var a;return pe.value==="history"?wa(D.value):C.value?String(C.value):Array.isArray(D.value)&&D.value.length&&((a=D.value[0])!=null&&a.log_text?String(D.value[0].log_text):"")||"Log akan tampil di sini."});async function ge(){var a;if(!(!u.value||q.value)){vt.value=!0;try{const e=await y(`${w}/olts/${u.value}/logs`);if(D.value=e.status==="ok"?Array.isArray(e.data)?e.data:[]:[],Array.isArray(D.value)&&D.value.length){const t=(a=D.value[0])!=null&&a.log_text?String(D.value[0].log_text):"";t&&(C.value=t)}}catch{D.value=[]}finally{vt.value=!1}}}function _a(){D.value=[],C.value="",pe.value="latest"}async function Sa(){const a=String(It.value||"").trim();if(a)try{await navigator.clipboard.writeText(a)}catch{}}function $a(a){const e=String(a||"").trim();e&&(R.value||(kt[e]={list:Array.isArray(x.value)?x.value.slice():[],fspList:Array.isArray(N.value)?N.value.slice():[],loadedFsp:{...U.value||{}},filter:j.value||"",page:_.value||1,pageSize:_e.value||25,query:G.value||"",sortKey:I.value||"interface",sortDir:se.value||"asc"}))}function Oa(a){const e=String(a||"").trim();if(!e)return!1;const t=kt[e];return!t||!Array.isArray(t.list)?!1:(Ce=!0,R.value=!1,Xe.value=null,ce&&(clearTimeout(ce),ce=null),fe&&(clearTimeout(fe),fe=null),Ye="",et="",x.value=t.list.slice(),N.value=Array.isArray(t.fspList)?Ae(t.fspList.slice()):[],U.value=t.loadedFsp?{...t.loadedFsp}:{},j.value=t.filter||"",_.value=t.page||1,_e.value=t.pageSize||25,G.value=t.query||"",I.value=t.sortKey||"interface",se.value=t.sortDir||"asc",setTimeout(()=>{Ce=!1},0),!0)}async function Na(a,e){if(Ie(),e&&(Ke(e),$a(e)),N.value=[],A.value=[],Ve(),te.value=!1,he.value="Registrasi berjalan...",xe.value=!1,$(a?"Pilih OLT untuk mulai scan.":"","info"),x.value=[],j.value="",Ce=!0,G.value="",setTimeout(()=>{Ce=!1},0),R.value=!1,U.value={},M.value="",le.value={},re(),v(a?"Pilih F/S/P dulu.":"","info"),D.value=[],C.value="",pe.value="latest",!a)return;la(a),Oa(a)&&((x.value.length||Object.keys(U.value||{}).length)&&v("","info"),A.value.length&&$("","info")),await Me(),await ge()}return bt(u,(a,e)=>{Na(a,e).catch(()=>{})}),Aa(async()=>{await lt()}),(a,e)=>(c(),d(X,null,[Kt(Ua(Pa),{title:"OLT Provisioning"}),Kt(Ea,null,{default:Ra(()=>[s("div",ja,[s("div",Da,[e[97]||(e[97]=s("div",{class:"border-b border-slate-200 dark:border-white/10 pb-4"},[s("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},[s("div",null,[s("h2",{class:"text-2xl font-bold text-slate-900 dark:text-white tracking-tight"}," OLT Provisioning "),s("p",{class:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mt-1"}," Registrasi ONU ZTE C320 via telnet (auto & manual). ")]),s("div",{class:"text-xs text-slate-400"},"Kelola OLT via dropdown dan modal setting.")])],-1)),s("div",Ba,[s("div",Ia,[s("div",Va,[e[41]||(e[41]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide"},"Pilih OLT",-1)),F(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),class:"w-full h-12 border border-slate-200 dark:border-white/10 rounded-lg px-4 text-sm font-semibold bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/60",disabled:st.value},[e[40]||(e[40]=s("option",{value:""},"-- Pilih OLT --",-1)),(c(!0),d(X,null,Le(me.value,t=>(c(),d("option",{key:t.id,value:String(t.id)},p(t.nama_olt||`OLT #${t.id}`),9,Ga))),128))],8,Ka),[[Gt,u.value]])]),q.value?S("",!0):(c(),d("div",za,[s("button",{type:"button",class:"h-12 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-bold transition disabled:opacity-60 disabled:cursor-not-allowed",disabled:!u.value,onClick:e[1]||(e[1]=t=>$t("edit"))}," Edit OLT ",8,Ha),s("button",{type:"button",class:"h-12 px-4 bg-slate-900 hover:bg-slate-950 text-white rounded-lg text-sm font-bold transition shadow-sm",onClick:e[2]||(e[2]=t=>$t("add"))}," Tambah OLT ")]))]),s("div",Ja,p(Wt.value),1)]),P.value?(c(),d("div",qa,[s("div",Wa,[s("div",Za,[e[44]||(e[44]=s("div",{class:"w-11 h-11 rounded-2xl bg-blue-50 dark:bg-blue-500/10 text-blue-600 dark:text-blue-300 flex items-center justify-center border border-blue-100 dark:border-blue-500/20"},[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12h14M5 12a4 4 0 014-4h6a4 4 0 010 8H9a4 4 0 01-4-4z"})])],-1)),s("div",null,[e[43]||(e[43]=s("div",{class:"text-base font-black text-slate-700 dark:text-slate-200 uppercase"},"ONU Unregistered",-1)),s("div",Qa,[e[42]||(e[42]=Y(" Total: ",-1)),s("span",Xa,p(A.value.length),1)])])]),s("div",Ya,[s("button",{type:"button",class:"h-12 px-5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-bold transition shadow-sm disabled:opacity-70 disabled:cursor-not-allowed",disabled:Fe.value||K.value,onClick:e[3]||(e[3]=t=>ra())},p(Fe.value?"Scanning...":"Scan Uncfg"),9,es),q.value?(c(),d("button",{key:0,type:"button",class:"h-12 px-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/10 text-slate-700 dark:text-slate-200 rounded-lg text-sm font-bold shadow-sm hover:bg-slate-50 transition disabled:opacity-70 disabled:cursor-not-allowed",disabled:K.value,onClick:e[4]||(e[4]=t=>na())}," Simpan Config ",8,ts)):(c(),d(X,{key:1},[s("button",{type:"button",class:"h-12 px-5 bg-slate-900 hover:bg-slate-950 text-white rounded-lg text-sm font-bold shadow-sm transition disabled:opacity-70 disabled:cursor-not-allowed",disabled:K.value,onClick:e[5]||(e[5]=t=>oa())}," Auto Register ",8,as),s("button",{type:"button",class:"h-12 px-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/10 text-slate-700 dark:text-slate-200 rounded-lg text-sm font-bold shadow-sm hover:bg-slate-50 transition disabled:opacity-70 disabled:cursor-not-allowed",disabled:K.value,onClick:e[6]||(e[6]=t=>Tt())}," Simpan Config ",8,ss)],64))])]),J.value.message&&!te.value?(c(),d("div",ls,[s("div",rs,[s("div",{class:L(["relative overflow-hidden rounded-2xl border px-4 py-3 text-[12px] font-semibold",Ue(J.value.tone).container])},[J.value.tone==="loading"?(c(),d("div",ns)):S("",!0),s("div",os,[s("span",{class:L(["h-2.5 w-2.5 rounded-full",Ue(J.value.tone).dot])},null,2),s("span",is,p(J.value.message),1)])],2)])])):S("",!0),z.value?(c(),d("div",us," Ketuk baris SN atau tombol Pilih untuk memilih ONU. ")):S("",!0),z.value&&Ee.value?(c(),d("div",ds,[s("div",cs,[s("div",fs,[s("div",null,[e[46]||(e[46]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400 dark:text-slate-500 font-bold"},"ONU Terpilih",-1)),s("div",ps,[s("span",null,p(Ee.value.fsp||"-"),1),e[45]||(e[45]=Y(" | ",-1)),s("span",null,p(Ee.value.sn||"-"),1)])]),e[47]||(e[47]=s("div",{class:"text-[10px] text-slate-400"},"Isi nama ONU di bawah",-1))]),te.value?S("",!0):(c(),d("div",gs,[s("div",vs,[e[48]||(e[48]=s("label",{class:"text-[11px] font-bold text-slate-500 uppercase tracking-wide"},"Nama ONU",-1)),F(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>ve.value=t),type:"text",placeholder:"Contoh: ONU-RT01",class:"w-full h-14 lg:h-11 border border-slate-300 dark:border-white/15 rounded-2xl lg:rounded-lg px-4 text-base lg:text-sm font-semibold bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-emerald-500",disabled:K.value},null,8,xs),[[V,ve.value]])]),s("button",{type:"button",class:"h-14 lg:h-11 px-6 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-base lg:text-sm font-bold shadow-sm transition w-full lg:w-auto disabled:opacity-70 disabled:cursor-not-allowed",disabled:K.value,onClick:e[8]||(e[8]=t=>ia())},p(K.value?"Registrasi...":"Registrasi ONU"),9,bs)])),te.value?(c(),d("div",ms,[s("div",hs,[e[49]||(e[49]=s("span",{class:"inline-flex h-5 w-5 items-center justify-center text-emerald-600"},[s("svg",{class:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})])],-1)),s("div",ks,p(he.value||"Registrasi berjalan..."),1)]),e[50]||(e[50]=s("div",{class:"h-2 rounded-full bg-emerald-100 dark:bg-emerald-500/10 overflow-hidden"},[s("div",{class:"h-full w-1/3 bg-emerald-500 animate-pulse"})],-1))])):S("",!0),e[51]||(e[51]=s("div",{class:"text-[10px] text-slate-400"},"Spasi akan dihapus, karakter khusus dibuang.",-1))])])):S("",!0),s("div",ys,[s("table",ws,[s("thead",_s,[z.value?(c(),d("tr",Ss,[...e[52]||(e[52]=[s("th",{class:"px-3 sm:px-6 py-3"},"F/S/P",-1),s("th",{class:"px-3 sm:px-6 py-3"},"SN",-1),s("th",{class:"px-3 sm:px-6 py-3 text-right"},"Aksi",-1)])])):(c(),d("tr",$s,[...e[53]||(e[53]=[s("th",{class:"px-3 sm:px-6 py-3"},"F/S/P",-1),s("th",{class:"px-3 sm:px-6 py-3"},"SN",-1)])]))]),s("tbody",Os,[A.value.length?z.value?(c(!0),d(X,{key:1},Le(A.value,(t,l)=>(c(),d("tr",{key:`${t.fsp}:${t.sn}`,class:L(["cursor-pointer",l===W.value?"bg-blue-50/80 dark:bg-blue-500/10":"hover:bg-slate-50 dark:hover:bg-slate-800/40"]),onClick:r=>Nt(l)},[s("td",Ls,p(t.fsp),1),s("td",As,[s("div",Us,p(t.sn),1),e[54]||(e[54]=s("div",{class:"text-[10px] text-slate-400"},"Ketuk untuk pilih",-1))]),s("td",Ps,[s("button",{type:"button",class:L(["h-9 px-4 rounded-xl text-xs font-bold",l===W.value?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"]),onClick:B(r=>Nt(l),["stop"])}," Pilih ",10,Rs)])],10,Cs))),128)):(c(!0),d(X,{key:2},Le(A.value,t=>(c(),d("tr",{key:`${t.fsp}:${t.sn}`,class:"hover:bg-slate-50 dark:hover:bg-slate-800/40"},[s("td",Ms,p(t.fsp),1),s("td",Fs,p(t.sn),1)]))),128)):(c(),d("tr",Ns,[s("td",{colspan:z.value?3:2,class:"px-3 sm:px-6 py-10 text-center text-slate-400 italic"}," Belum ada data. ",8,Ts)]))])])])])):S("",!0),P.value?(c(),d("div",Es,[s("div",js,[s("div",Ds,[e[57]||(e[57]=s("div",{class:"w-11 h-11 rounded-2xl bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-300 flex items-center justify-center border border-emerald-100 dark:border-emerald-500/20"},[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7 6h10a2 2 0 012 2v10a2 2 0 01-2 2H7a2 2 0 01-2-2V8a2 2 0 012-2z"})])],-1)),s("div",null,[e[56]||(e[56]=s("div",{class:"text-base font-black text-slate-700 dark:text-slate-200 uppercase"},"ONU Registered",-1)),s("div",Bs,[e[55]||(e[55]=Y(" Total: ",-1)),s("span",Is,p(x.value.length),1)])])])]),ae.value.message?(c(),d("div",Vs,[s("div",Ks,[s("div",{class:L(["relative overflow-hidden rounded-2xl border px-4 py-3 text-[12px] font-semibold",Ue(ae.value.tone).container])},[ae.value.tone==="loading"?(c(),d("div",Gs)):S("",!0),s("div",zs,[s("span",{class:L(["h-2.5 w-2.5 rounded-full",Ue(ae.value.tone).dot])},null,2),s("span",Hs,p(ae.value.message),1)])],2)])])):S("",!0),s("div",Js,[s("div",qs,[s("div",null,[e[60]||(e[60]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Filter F/S/P",-1)),F(s("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>j.value=t),onChange:e[10]||(e[10]=t=>Qe()),class:"w-full h-12 border border-slate-200 dark:border-white/10 rounded-lg px-4 text-sm font-semibold bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-emerald-500"},[e[58]||(e[58]=s("option",{value:""},"Pilih F/S/P",-1)),e[59]||(e[59]=s("option",{value:"all"},"Semua F/S/P",-1)),(c(!0),d(X,null,Le(N.value,t=>(c(),d("option",{key:t,value:t},p(t),9,Ws))),128))],544),[[Gt,j.value]]),s("div",Zs,p(fa.value),1)]),s("div",null,[e[62]||(e[62]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Pencarian",-1)),s("div",Qs,[F(s("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>G.value=t),type:"text",placeholder:"Cari SN atau nama...",class:"w-full h-12 border border-slate-200 dark:border-white/10 rounded-lg px-11 text-sm font-semibold bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-emerald-500"},null,512),[[V,G.value]]),e[61]||(e[61]=s("span",{class:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"},[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35M10 18a8 8 0 100-16 8 8 0 000 16z"})])],-1))])])])]),e[83]||(e[83]=s("div",{class:"px-4 md:px-5 pb-2 text-[11px] text-slate-500 dark:text-slate-400"}," Ketuk baris untuk melihat detail ONU. ",-1)),s("div",Xs,[s("table",Ys,[s("thead",el,[s("tr",null,[s("th",{class:"px-3 sm:px-6 py-3 text-left","aria-sort":Ne("interface")},[s("button",{type:"button",class:"group inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-white",onClick:e[12]||(e[12]=B(t=>Se("interface"),["stop"]))},[e[63]||(e[63]=s("span",null,"Interface",-1)),s("span",{class:L(["text-[10px]",I.value==="interface"?"text-slate-500 dark:text-slate-300":"text-slate-300 dark:text-slate-600 group-hover:text-slate-400 dark:group-hover:text-slate-400"])},p(Oe("interface")),3)])],8,tl),s("th",{class:"px-3 sm:px-6 py-3 text-left","aria-sort":Ne("name")},[s("button",{type:"button",class:"group inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-white",onClick:e[13]||(e[13]=B(t=>Se("name"),["stop"]))},[e[64]||(e[64]=s("span",null,"Nama",-1)),s("span",{class:L(["text-[10px]",I.value==="name"?"text-slate-500 dark:text-slate-300":"text-slate-300 dark:text-slate-600 group-hover:text-slate-400 dark:group-hover:text-slate-400"])},p(Oe("name")),3)])],8,al),s("th",{class:"px-3 sm:px-6 py-3 text-left","aria-sort":Ne("sn")},[s("button",{type:"button",class:"group inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-white",onClick:e[14]||(e[14]=B(t=>Se("sn"),["stop"]))},[e[65]||(e[65]=s("span",null,"SN",-1)),s("span",{class:L(["text-[10px]",I.value==="sn"?"text-slate-500 dark:text-slate-300":"text-slate-300 dark:text-slate-600 group-hover:text-slate-400 dark:group-hover:text-slate-400"])},p(Oe("sn")),3)])],8,sl),s("th",{class:"px-3 sm:px-6 py-3 text-left","aria-sort":Ne("rx")},[s("button",{type:"button",class:"group inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-white",onClick:e[15]||(e[15]=B(t=>Se("rx"),["stop"]))},[e[66]||(e[66]=s("span",null,"Power Rx",-1)),s("span",{class:L(["text-[10px]",I.value==="rx"?"text-slate-500 dark:text-slate-300":"text-slate-300 dark:text-slate-600 group-hover:text-slate-400 dark:group-hover:text-slate-400"])},p(Oe("rx")),3)])],8,ll),s("th",{class:"px-3 sm:px-6 py-3 text-left","aria-sort":Ne("status")},[s("button",{type:"button",class:"group inline-flex items-center gap-1 text-xs font-bold uppercase tracking-wide text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-white",onClick:e[16]||(e[16]=B(t=>Se("status"),["stop"]))},[e[67]||(e[67]=s("span",null,"Status",-1)),s("span",{class:L(["text-[10px]",I.value==="status"?"text-slate-500 dark:text-slate-300":"text-slate-300 dark:text-slate-600 group-hover:text-slate-400 dark:group-hover:text-slate-400"])},p(Oe("status")),3)])],8,rl)])]),s("tbody",nl,[ye.value?(c(),d("tr",ol,[s("td",il,p(we.value||"Memuat data..."),1)])):x.value.length?pt.value.length?(c(!0),d(X,{key:3},Le(pt.value,t=>(c(),d(X,{key:m(t)},[s("tr",{class:L(["cursor-pointer",[M.value===m(t)?"bg-emerald-50/80 dark:bg-emerald-500/10":"hover:bg-slate-50 dark:hover:bg-slate-800/40",Ge.value===m(t)?"ring-2 ring-emerald-400/60":""]]),onClick:l=>xa(t)},[s("td",pl,p(t.fsp_onu||`${t.fsp}:${t.onu_id}`),1),s("td",gl,p(t.name||"-"),1),s("td",vl,p(t.sn||"-"),1),s("td",{class:L(["px-3 sm:px-6 py-4 text-xs",_t(t)])},p(yt(t.rx)),3),s("td",xl,[s("span",{class:L(["inline-flex items-center px-2.5 py-1 rounded-full text-[11px] font-bold",at(t).className])},p(at(t).label),3)])],10,fl),M.value===m(t)?(c(),d("tr",bl,[s("td",ml,[ze.value===m(t)?(c(),d("div",hl,[...e[69]||(e[69]=[s("span",{class:"inline-flex h-5 w-5 items-center justify-center text-emerald-500"},[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})])],-1),Y(" Memuat detail ONU... ",-1)])])):(c(),d("div",kl,[s("div",yl,[s("div",wl,[e[70]||(e[70]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400"},"Interface",-1)),s("div",_l,p(t.interface||m(t)),1)]),s("div",Sl,[e[71]||(e[71]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400"},"Nama",-1)),ue.value===m(t)?(c(),d("div",$l,[F(s("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>de.value=l),class:"block w-full max-w-full rounded-lg border border-slate-200 dark:border-white/10 bg-white/70 dark:bg-slate-900/60 px-3 py-1.5 text-xs text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-emerald-400/40",onClick:e[18]||(e[18]=B(()=>{},["stop"]))},null,512),[[V,de.value]])])):(c(),d("div",Ol,p(t.name||"-"),1))]),s("div",Nl,[e[72]||(e[72]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400"},"SN",-1)),s("div",Tl,p(t.sn||"-"),1)]),s("div",Cl,[e[73]||(e[73]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400"},"Status",-1)),s("div",Ll,p(at(t).label),1)]),s("div",Al,[e[74]||(e[74]=s("div",{class:"text-[10px] uppercase tracking-wide text-slate-400"},"Power Rx",-1)),s("div",{class:L(["font-semibold",_t(t)])},p(ie(t.rx)!==null?yt(t.rx):"-"),3)])]),s("div",Ul,[ue.value===m(t)?(c(),d(X,{key:0},[s("button",{type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-emerald-300 text-emerald-700 hover:bg-emerald-50 transition disabled:opacity-60 disabled:cursor-not-allowed inline-flex items-center gap-2",disabled:ne(m(t),"rename"),onClick:B(l=>ma(t),["stop"])},[ne(m(t),"rename")?(c(),d("span",Rl,[...e[75]||(e[75]=[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})],-1)])])):S("",!0),e[76]||(e[76]=Y(" Simpan ",-1))],8,Pl),s("button",{type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-50 transition",onClick:e[19]||(e[19]=B(l=>re(),["stop"]))}," Batal ")],64)):(c(),d("button",{key:1,type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-slate-200 dark:border-white/10 text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-800/60 transition",onClick:B(l=>ba(t),["stop"])}," Edit Nama ",8,Ml)),s("button",{type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-blue-200 text-blue-700 hover:bg-blue-50 transition disabled:opacity-60 disabled:cursor-not-allowed inline-flex items-center gap-2",disabled:ne(m(t),"refresh"),onClick:B(l=>ha(t),["stop"])},[ne(m(t),"refresh")?(c(),d("span",El,[...e[77]||(e[77]=[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})],-1)])])):S("",!0),e[78]||(e[78]=Y(" Refresh ",-1))],8,Fl),s("button",{type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-amber-200 text-amber-700 hover:bg-amber-50 transition disabled:opacity-60 disabled:cursor-not-allowed inline-flex items-center gap-2",disabled:ne(m(t),"restart"),onClick:B(l=>ka(t),["stop"])},[ne(m(t),"restart")?(c(),d("span",Dl,[...e[79]||(e[79]=[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})],-1)])])):S("",!0),e[80]||(e[80]=Y(" Restart ",-1))],8,jl),s("button",{type:"button",class:"px-3 py-1.5 text-xs font-bold rounded-lg border border-rose-300 text-rose-700 hover:bg-rose-100 transition disabled:opacity-60 disabled:cursor-not-allowed inline-flex items-center gap-2",disabled:ne(m(t),"delete"),onClick:B(l=>ya(t),["stop"])},[ne(m(t),"delete")?(c(),d("span",Il,[...e[81]||(e[81]=[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})],-1)])])):S("",!0),e[82]||(e[82]=Y(" Hapus ONU ",-1))],8,Bl)])]))])])):S("",!0)],64))),128)):(c(),d("tr",cl,[...e[68]||(e[68]=[s("td",{colspan:"5",class:"px-3 sm:px-6 py-10 text-center text-slate-400 italic"}," Tidak ada data yang cocok. ",-1)])])):(c(),d("tr",ul,[s("td",dl,p(Object.keys(U.value||{}).length?"Belum ada data.":"Data belum dimuat."),1)]))])])]),s("div",Vl,[s("div",Kl,[qe.value?(c(),d("span",zl," Menampilkan "+p(We.value+1)+"-"+p(Math.min(We.value+pt.value.length,qe.value))+" dari "+p(qe.value)+" (Page "+p(_.value)+"/"+p(be.value)+") ",1)):(c(),d("span",Gl,"Menampilkan 0 data."))]),s("div",Hl,[s("button",{type:"button",class:"h-9 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-xs font-bold text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800/60 transition disabled:opacity-60 disabled:cursor-not-allowed",disabled:_.value<=1,onClick:e[20]||(e[20]=t=>_.value=Math.max(1,_.value-1))}," Prev ",8,Jl),s("button",{type:"button",class:"h-9 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-xs font-bold text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800/60 transition disabled:opacity-60 disabled:cursor-not-allowed",disabled:_.value>=be.value,onClick:e[21]||(e[21]=t=>_.value=Math.min(be.value,_.value+1))}," Next ",8,ql)])])])):S("",!0),P.value&&!q.value?(c(),d("div",Wl,[s("div",Zl,[s("div",Ql,[e[85]||(e[85]=s("div",{class:"text-xs font-black text-slate-700 dark:text-slate-200 uppercase"},"Log Command",-1)),vt.value?(c(),d("span",Xl,[...e[84]||(e[84]=[s("svg",{class:"h-3.5 w-3.5 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})],-1),Y(" Loading ",-1)])])):S("",!0)]),s("div",Yl,[s("div",er,[s("button",{type:"button",class:L(["h-8 px-3 text-[11px] font-bold transition",pe.value==="latest"?"bg-slate-900 text-white":"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/40"]),onClick:e[22]||(e[22]=t=>pe.value="latest")}," Terakhir ",2),s("button",{type:"button",class:L(["h-8 px-3 text-[11px] font-bold transition border-l border-slate-200 dark:border-white/10",pe.value==="history"?"bg-slate-900 text-white":"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/40"]),onClick:e[23]||(e[23]=t=>pe.value="history")}," History ",2)]),s("button",{type:"button",class:"h-8 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-[11px] font-bold text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/40 transition",onClick:e[24]||(e[24]=t=>Sa())}," Copy "),s("button",{type:"button",class:"h-8 px-3 rounded-lg border border-slate-200 dark:border-white/10 text-[11px] font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/40 transition",onClick:e[25]||(e[25]=t=>_a())}," Clear ")])]),s("pre",tr,p(It.value),1)])):S("",!0),ee.value?(c(),d("div",ar,[s("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e[26]||(e[26]=t=>ee.value=!1)}),s("div",sr,[s("div",lr,[s("div",rr,[s("div",nr,p(H.value?"Edit OLT":"Tambah OLT"),1),s("button",{type:"button",class:"text-slate-400 hover:text-slate-600",onClick:e[27]||(e[27]=t=>ee.value=!1)},"✕")]),s("div",or,[s("div",null,[e[86]||(e[86]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Nama OLT",-1)),F(s("input",{"onUpdate:modelValue":e[28]||(e[28]=t=>h.value.nama_olt=t),type:"text",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.nama_olt]])]),s("div",ir,[s("div",ur,[e[87]||(e[87]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Host/IP",-1)),F(s("input",{"onUpdate:modelValue":e[29]||(e[29]=t=>h.value.host=t),type:"text",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.host]])]),s("div",null,[e[88]||(e[88]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Port",-1)),F(s("input",{"onUpdate:modelValue":e[30]||(e[30]=t=>h.value.port=t),type:"number",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.port]])])]),s("div",dr,[s("div",null,[e[89]||(e[89]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Username",-1)),F(s("input",{"onUpdate:modelValue":e[31]||(e[31]=t=>h.value.username=t),type:"text",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.username]])]),s("div",null,[s("label",cr," Password "+p(H.value?"(kosongkan jika tidak diubah)":""),1),F(s("input",{"onUpdate:modelValue":e[32]||(e[32]=t=>h.value.password=t),type:"password",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.password]])])]),s("div",fr,[s("div",null,[e[90]||(e[90]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"TCONT Default",-1)),F(s("input",{"onUpdate:modelValue":e[33]||(e[33]=t=>h.value.tcont_default=t),type:"text",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.tcont_default]])]),s("div",null,[e[91]||(e[91]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"VLAN Default",-1)),F(s("input",{"onUpdate:modelValue":e[34]||(e[34]=t=>h.value.vlan_default=t),type:"number",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.vlan_default]])]),s("div",null,[e[92]||(e[92]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"ONU Type Default",-1)),F(s("input",{"onUpdate:modelValue":e[35]||(e[35]=t=>h.value.onu_type_default=t),type:"text",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.onu_type_default]])]),s("div",null,[e[93]||(e[93]=s("label",{class:"block text-[11px] font-bold text-slate-500 uppercase tracking-wide mb-1"},"Service-Port ID (Fixed)",-1)),F(s("input",{"onUpdate:modelValue":e[36]||(e[36]=t=>h.value.service_port_id_default=t),type:"number",min:"1",max:"65535",class:"w-full h-11 border border-slate-200 rounded-lg px-3 text-sm font-semibold bg-white focus:outline-none focus:ring-2 focus:ring-slate-900/60"},null,512),[[V,h.value.service_port_id_default]])])])]),s("div",pr,[H.value?(c(),d("button",{key:0,type:"button",class:"h-11 px-4 rounded-lg bg-rose-600 hover:bg-rose-700 text-white text-sm font-bold transition",onClick:e[37]||(e[37]=t=>aa())}," Hapus OLT ")):S("",!0),s("div",gr,[s("button",{type:"button",class:"h-11 px-4 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-700 text-sm font-bold transition",onClick:e[38]||(e[38]=t=>ee.value=!1)}," Batal "),s("button",{type:"button",class:"h-11 px-4 rounded-lg bg-slate-900 hover:bg-slate-950 text-white text-sm font-bold transition shadow-sm",onClick:e[39]||(e[39]=t=>ea())}," Simpan ")])])])])])):S("",!0),rt.value?(c(),d("div",vr,[e[96]||(e[96]=s("div",{class:"absolute inset-0 bg-slate-900/45 backdrop-blur-sm"},null,-1)),s("div",xr,[s("div",br,[s("div",mr,[e[95]||(e[95]=s("span",{class:"inline-flex h-9 w-9 items-center justify-center rounded-lg bg-emerald-50 text-emerald-600"},[s("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"})])],-1)),s("div",hr,[e[94]||(e[94]=s("div",{class:"text-sm font-bold text-slate-800 dark:text-white"},"Sinkronisasi ONU",-1)),s("div",kr,p(nt.value),1),s("div",yr,p(ot.value),1),s("div",wr,p(it.value),1),s("div",_r,[s("div",{id:"olt-sync-bar",class:"h-full bg-emerald-500 transition-all",style:Ma({width:`${Math.round(Re.value)}%`})},null,4)]),s("div",Sr,p(Math.round(Re.value))+"%",1)])])])])])):S("",!0)])])]),_:1})],64))}};export{Tr as default};
