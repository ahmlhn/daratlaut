import{r as c,o as _,E as S,c as l,a as p,u as D,h as j,m as F,b as t,f as x,v as m,x as R,t as o,j as n,F as f,s as T,n as B,e as b,y as C}from"./app-D84xlh30.js";import{_ as I}from"./AdminLayout-C8iern4a.js";const N={class:"space-y-6"},V={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},M={class:"flex flex-col sm:flex-row gap-3"},P={class:"flex-1"},U={class:"flex-1"},E={class:"w-full sm:w-40"},L={class:"grid grid-cols-2 gap-4"},O={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},$={class:"text-2xl font-bold text-gray-900 dark:text-white"},z={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},A={class:"text-2xl font-bold text-green-600 dark:text-green-400"},H={key:0,class:"flex justify-center py-12"},J={key:1,class:"space-y-3"},q={class:"flex items-start justify-between gap-4"},G={class:"flex-1 min-w-0"},K={class:"flex items-center gap-2 mb-1"},Q={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},W={class:"font-semibold text-gray-900 dark:text-white truncate"},X={class:"text-sm text-gray-500 dark:text-gray-400 truncate"},Y={class:"flex items-center gap-4 mt-2 text-xs text-gray-500 dark:text-gray-400"},Z={key:0,class:"text-green-600 dark:text-green-400 font-semibold"},tt={key:2,class:"text-center py-16"},et="/api/v1",rt={__name:"Riwayat",props:{techName:{type:String,default:"Teknisi"},techRole:{type:String,default:"teknisi"},initialFilters:{type:Object,default:()=>({})}},setup(k){const i=k,d=c([]),u=c(!1),r=c({date_from:i.initialFilters.date_from||new Date(new Date().setDate(1)).toISOString().split("T")[0],date_to:i.initialFilters.date_to||new Date().toISOString().split("T")[0],status:i.initialFilters.status||"Selesai"}),v={Selesai:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",Batal:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};async function g(){u.value=!0;try{const s=new URLSearchParams({tech_name:i.techName,...r.value}),a=await(await fetch(`${et}/teknisi/riwayat?${s}`)).json();d.value=a.data||[]}catch(s){console.error("Failed to load history:",s)}finally{u.value=!1}}function h(s){return s?new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}):"-"}function y(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s||0)}const w=C(()=>d.value.reduce((s,e)=>s+(parseFloat(e.harga)||0),0));return _(()=>{g()}),S(r,()=>g(),{deep:!0}),(s,e)=>(n(),l(f,null,[p(D(j),{title:"Riwayat Pekerjaan"}),p(I,null,{default:F(()=>[t("div",N,[e[11]||(e[11]=t("div",{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},[t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Riwayat Pekerjaan"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"History pekerjaan yang sudah selesai")])],-1)),t("div",V,[t("div",M,[t("div",P,[e[3]||(e[3]=t("label",{class:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase mb-1 block"},"Dari Tanggal",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.date_from=a),type:"date",class:"input w-full"},null,512),[[m,r.value.date_from]])]),t("div",U,[e[4]||(e[4]=t("label",{class:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase mb-1 block"},"Sampai Tanggal",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.date_to=a),type:"date",class:"input w-full"},null,512),[[m,r.value.date_to]])]),t("div",E,[e[6]||(e[6]=t("label",{class:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase mb-1 block"},"Status",-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.status=a),class:"input w-full"},[...e[5]||(e[5]=[t("option",{value:""},"Semua",-1),t("option",{value:"Selesai"},"Selesai",-1),t("option",{value:"Batal"},"Batal",-1)])],512),[[R,r.value.status]])]),t("div",{class:"flex items-end"},[t("button",{onClick:g,class:"btn btn-primary h-10"},"Refresh")])])]),t("div",L,[t("div",O,[e[7]||(e[7]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase"},"Total Job",-1)),t("p",$,o(d.value.length),1)]),t("div",z,[e[8]||(e[8]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase"},"Total Revenue",-1)),t("p",A,o(y(w.value)),1)])]),u.value?(n(),l("div",H,[...e[9]||(e[9]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-4 border-primary-500 border-t-transparent"},null,-1)])])):d.value.length>0?(n(),l("div",J,[(n(!0),l(f,null,T(d.value,a=>(n(),l("div",{key:a.id,class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},[t("div",q,[t("div",G,[t("div",K,[t("span",{class:B(["px-2 py-0.5 rounded-full text-xs font-semibold",v[a.status]||"bg-gray-100 text-gray-800"])},o(a.status),3),a.pop?(n(),l("span",Q,o(a.pop),1)):b("",!0)]),t("h3",W,o(a.nama),1),t("p",X,o(a.alamat),1),t("div",Y,[t("span",null,"ðŸ“… Selesai: "+o(h(a.tanggal_selesai)),1),a.harga?(n(),l("span",Z,o(y(a.harga)),1)):b("",!0)])])])]))),128))])):(n(),l("div",tt,[...e[10]||(e[10]=[t("div",{class:"w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1),t("h3",{class:"text-gray-600 dark:text-gray-300 font-semibold"},"Tidak ada riwayat",-1)])]))])]),_:1})],64))}};export{rt as default};
