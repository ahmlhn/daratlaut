import{o as D,c as i,a as w,u as F,h as S,m as U,b as e,d as A,j as o,F as C,s as E,n as M,t as r,e as m,B as L,T as q,w as H,f as v,v as _,x as G,i as K,A as p,r as c,y as z}from"./app-Dm87D0yl.js";import{_ as R}from"./AdminLayout-n9J4pJGO.js";const J={class:"space-y-6"},O={key:0,class:"card text-center py-8"},Q={key:1,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},W={class:"pr-16"},X={class:"text-xs text-gray-400 font-mono"},Y={class:"text-lg font-semibold text-gray-900 mt-1"},Z={class:"text-2xl font-bold text-primary-600 mt-2"},ee={class:"text-xs text-gray-500 mt-1"},te={class:"flex gap-2 mt-4 pt-4 border-t"},ae=["onClick"],se=["onClick"],le=["onClick"],ne={key:0,class:"col-span-full card text-center py-8 text-gray-500"},oe={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ie={class:"flex min-h-screen items-center justify-center p-4"},re={class:"relative w-full max-w-md rounded-lg bg-white shadow-xl"},de={class:"flex items-center justify-between border-b px-6 py-4"},ue={class:"text-lg font-semibold text-gray-900"},ce={key:0,class:"mt-1 text-sm text-red-600"},me={key:0,class:"mt-1 text-sm text-red-600"},ve={key:0,class:"mt-1 text-sm text-red-600"},pe={class:"flex items-center gap-2"},ye={class:"flex justify-end gap-3 pt-4 border-t"},xe=["disabled"],ge={key:0},be={key:1},_e={__name:"Index",props:{tenantId:{type:Number,default:1}},setup($){const y=$,f=c([]),k=c(!0),u=c(!1),x=c("create"),g=c(!1),d=c({}),n=c({id:null,code:"",name:"",price:0,billing_cycle:"monthly",is_active:!0}),h=()=>{n.value={id:null,code:"",name:"",price:0,billing_cycle:"monthly",is_active:!0},d.value={}},b=async()=>{k.value=!0;try{const s=await p.get("/api/v1/plans",{params:{tenant_id:y.tenantId}});f.value=s.data.data||[]}catch(s){console.error("Failed to load plans:",s)}finally{k.value=!1}},B=()=>{h(),n.value.code=`PLAN-${Date.now().toString().slice(-6)}`,x.value="create",u.value=!0},P=s=>{h(),x.value="edit",n.value={id:s.id,code:s.code,name:s.name,price:s.price,billing_cycle:s.billing_cycle||"monthly",is_active:s.is_active},u.value=!0},N=async()=>{var s,t,a;g.value=!0,d.value={};try{const l={...n.value,tenant_id:y.tenantId};x.value==="create"?await p.post("/api/v1/plans",l):await p.put(`/api/v1/plans/${n.value.id}`,l),u.value=!1,b()}catch(l){((s=l.response)==null?void 0:s.status)===422?d.value=l.response.data.errors||{}:alert("Gagal menyimpan: "+(((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||l.message))}finally{g.value=!1}},I=async s=>{var t,a;if(confirm(`Hapus paket "${s.name}"?`))try{await p.delete(`/api/v1/plans/${s.id}?tenant_id=${y.tenantId}`),b()}catch(l){alert("Gagal menghapus: "+(((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||l.message))}},V=async s=>{var t,a;try{await p.put(`/api/v1/plans/${s.id}`,{tenant_id:y.tenantId,is_active:!s.is_active}),b()}catch(l){alert("Gagal mengubah status: "+(((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||l.message))}};D(()=>b());const T=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),j=z(()=>x.value==="create"?"Tambah Paket":"Edit Paket");return(s,t)=>(o(),i(C,null,[w(F(S),{title:"Paket Layanan"}),w(R,null,{default:U(()=>[e("div",J,[e("div",{class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-2xl font-semibold text-gray-900"},"Paket Layanan"),e("p",{class:"mt-1 text-sm text-gray-500"},"Kelola paket internet pelanggan")],-1)),e("button",{onClick:B,class:"btn btn-primary"},[...t[8]||(t[8]=[e("svg",{class:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),A(" Tambah Paket ",-1)])])]),k.value?(o(),i("div",O,[...t[10]||(t[10]=[e("div",{class:"animate-spin h-8 w-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"},null,-1),e("p",{class:"mt-2 text-gray-500"},"Memuat data...",-1)])])):(o(),i("div",Q,[(o(!0),i(C,null,E(f.value,a=>(o(),i("div",{key:a.id,class:M(["card relative border-2 transition-shadow hover:shadow-md",a.is_active?"border-primary-200":"border-gray-200 opacity-60"])},[e("span",{class:M(["absolute top-3 right-3 text-xs font-medium px-2 py-1 rounded-full",a.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"])},r(a.is_active?"Aktif":"Nonaktif"),3),e("div",W,[e("p",X,r(a.code),1),e("h3",Y,r(a.name),1),e("p",Z,r(T(a.price)),1),e("p",ee,"per "+r(a.billing_cycle||"bulan"),1)]),e("div",te,[e("button",{onClick:l=>P(a),class:"text-sm text-primary-600 hover:text-primary-800"},"Edit",8,ae),e("button",{onClick:l=>V(a),class:"text-sm text-gray-500 hover:text-gray-700"},r(a.is_active?"Nonaktifkan":"Aktifkan"),9,se),e("button",{onClick:l=>I(a),class:"text-sm text-red-500 hover:text-red-700"},"Hapus",8,le)])],2))),128)),f.value.length===0?(o(),i("div",ne," Belum ada paket layanan. Klik tombol di atas untuk menambah. ")):m("",!0)]))]),(o(),L(q,{to:"body"},[u.value?(o(),i("div",oe,[e("div",ie,[e("div",{class:"fixed inset-0 bg-black/50",onClick:t[0]||(t[0]=a=>u.value=!1)}),e("div",re,[e("div",de,[e("h3",ue,r(j.value),1),e("button",{onClick:t[1]||(t[1]=a=>u.value=!1),class:"text-gray-400 hover:text-gray-500"},[...t[11]||(t[11]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:H(N,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Kode Paket *",-1)),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.code=a),type:"text",class:"input mt-1",required:""},null,512),[[_,n.value.code]]),d.value.code?(o(),i("p",ce,r(d.value.code[0]),1)):m("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nama Paket *",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.name=a),type:"text",placeholder:"Contoh: 20 Mbps Unlimited",class:"input mt-1",required:""},null,512),[[_,n.value.name]]),d.value.name?(o(),i("p",me,r(d.value.name[0]),1)):m("",!0)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Harga (Rp) *",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>n.value.price=a),type:"number",min:"0",step:"1000",class:"input mt-1",required:""},null,512),[[_,n.value.price,void 0,{number:!0}]]),d.value.price?(o(),i("p",ve,r(d.value.price[0]),1)):m("",!0)]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Siklus Billing",-1)),v(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>n.value.billing_cycle=a),class:"input mt-1"},[...t[15]||(t[15]=[e("option",{value:"monthly"},"Bulanan",-1),e("option",{value:"quarterly"},"3 Bulan",-1),e("option",{value:"yearly"},"Tahunan",-1)])],512),[[G,n.value.billing_cycle]])]),e("div",pe,[v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>n.value.is_active=a),type:"checkbox",id:"is_active",class:"h-4 w-4 rounded border-gray-300 text-primary-600"},null,512),[[K,n.value.is_active]]),t[17]||(t[17]=e("label",{for:"is_active",class:"text-sm text-gray-700"},"Paket aktif",-1))]),e("div",ye,[e("button",{type:"button",onClick:t[7]||(t[7]=a=>u.value=!1),class:"btn btn-secondary"},"Batal"),e("button",{type:"submit",disabled:g.value,class:"btn btn-primary"},[g.value?(o(),i("span",ge,"Menyimpan...")):(o(),i("span",be,"Simpan"))],8,xe)])],32)])])])):m("",!0)]))]),_:1})],64))}};export{_e as default};
