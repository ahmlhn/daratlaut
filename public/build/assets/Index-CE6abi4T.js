import{C as ct,H as de,E as gt,o as bt,l as mt,c as g,a as Ne,u as ft,h as xt,m as ht,b as t,d as R,t as i,f as h,v as _,x as V,n as N,j as b,F as $,s as T,w as vt,e as Te,i as kt,r as y,G as wt,y as W,z as yt}from"./app-TlB4QRCh.js";import{_ as _t}from"./AdminLayout-DxZk1-d7.js";const St=["data-actor-name","data-actor-role"],Pt={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 border-b border-slate-200 dark:border-white/5 pb-4"},Ct={class:"flex flex-wrap gap-2 w-full md:w-auto relative z-10 pointer-events-auto"},Bt={class:"flex flex-wrap gap-3 mb-4 transition-all duration-300"},$t={class:"min-w-0"},jt={id:"stat-prio",class:"text-lg font-black text-slate-800 dark:text-white"},Mt={class:"min-w-0"},Dt={id:"stat-overdue",class:"text-lg font-black text-red-600"},Nt={class:"min-w-0"},Tt={id:"stat-new",class:"text-lg font-black text-blue-600"},At={class:"min-w-0"},Rt={id:"stat-survey",class:"text-lg font-black text-purple-600"},Vt={class:"min-w-0"},Ut={id:"stat-process",class:"text-lg font-black text-indigo-600"},Et={class:"min-w-0"},Lt={id:"stat-pending",class:"text-lg font-black text-orange-600"},It={class:"min-w-0"},Ot={id:"stat-req-cancel",class:"text-lg font-black text-pink-600"},qt={class:"min-w-0"},Ft={id:"stat-cancel",class:"text-lg font-black text-red-600"},zt={class:"min-w-0"},Ht={id:"stat-today-done",class:"text-lg font-black text-green-600"},Wt={class:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-white/5 overflow-hidden flex flex-col"},Gt={class:"p-4 border-b border-slate-100 dark:border-white/5 bg-slate-50/50 dark:bg-slate-900/30"},Kt={class:"w-full relative shrink-0 mb-3"},Jt={class:"flex flex-col lg:flex-row gap-3 lg:items-end"},Yt={class:"w-full lg:w-auto lg:flex-1 max-w-lg"},Zt={class:"flex items-center gap-2"},Qt={class:"grid grid-cols-2 lg:grid-cols-3 gap-2 w-full lg:w-auto lg:flex lg:items-center lg:gap-2"},Xt={class:"flex items-center gap-1.5 lg:gap-2"},es={class:"flex items-center gap-1.5 lg:gap-2"},ts=["value"],ss={class:"flex items-center gap-1.5 lg:gap-2"},as=["value"],rs={class:"overflow-x-auto min-h-[350px]"},os={class:"w-full text-left text-sm whitespace-nowrap"},ls={id:"progress-table-body",class:"divide-y divide-slate-100 dark:divide-white/5"},ns={key:0},is={key:1},ds=["id","onClick"],us={class:"px-4 py-3 text-center"},ps=["onClick"],cs={class:"px-6 py-3"},gs={class:"flex items-center flex-wrap gap-1"},bs={class:"font-mono text-[10px] text-blue-500 font-bold group-hover:text-blue-700 transition"},ms={key:1,class:"ml-2 px-2 py-0.5 rounded-full text-[10px] font-black bg-red-100 text-red-700"},fs={class:"text-[10px] text-slate-400"},xs={class:"px-6 py-3"},hs={class:"font-bold text-slate-700 dark:text-slate-200 text-xs"},vs={class:"text-[10px] text-slate-400 truncate max-w-[150px]"},ks={class:"px-6 py-3 text-xs text-slate-600 dark:text-slate-300"},ws={class:"px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-700 font-bold text-[10px]"},ys={class:"px-6 py-3 text-xs"},_s={key:0,class:"flex items-center gap-1"},Ss={key:1,class:"text-slate-300 italic"},Ps={class:"px-6 py-3"},Cs={class:"p-4 border-t border-slate-100 dark:border-white/5 bg-slate-50/30 flex flex-col md:flex-row justify-between items-center gap-4"},Bs={class:"text-xs text-slate-500 font-medium"},$s={id:"page-start",class:"font-bold text-slate-700 dark:text-white"},js={id:"page-end",class:"font-bold text-slate-700 dark:text-white"},Ms={id:"total-data",class:"font-bold text-slate-700 dark:text-white"},Ds={class:"flex items-center gap-2"},Ns=["disabled"],Ts={class:"text-xs font-bold text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/10 px-3 py-1.5 rounded-lg"},As={id:"current-page"},Rs={id:"total-pages"},Vs=["disabled"],Us={class:"max-w-5xl mx-auto bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-white/10 overflow-hidden"},Es={class:"px-5 py-4 border-b border-slate-100 dark:border-white/10 flex items-center justify-between"},Ls={class:"min-w-0"},Is={class:"text-[11px] text-slate-400 font-bold",id:"modal-ticket-id"},Os={class:"text-lg font-black text-slate-800 dark:text-white",id:"modal-title-text"},qs={id:"form-edit-install",class:"p-5 space-y-5"},Fs=["value"],zs=["value"],Hs={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},Ws={class:"space-y-2"},Gs={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-white/10 p-3 space-y-2"},Ks={class:"flex items-center justify-between"},Js={id:"progress-smart-summary",class:"text-[10px] text-slate-400 dark:text-slate-500 min-h-[12px]"},Ys={id:"progress-smart-review",class:"grid grid-cols-2 gap-x-3 gap-y-1 text-[11px] text-slate-700 dark:text-slate-200"},Zs={class:"text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase"},Qs={class:"font-medium"},Xs={key:1,class:"col-span-2 text-slate-400 dark:text-slate-500 italic"},ea={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ta={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},sa={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3"},aa={class:"flex gap-2"},ra={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},oa={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},la=["value"],na={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3"},ia={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3"},da={class:"mt-3 flex items-center gap-2"},ua={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pa={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},ca={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ga=["value"],ba=["value"],ma=["value"],fa=["value"],xa={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},ha={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},va={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ka={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},wa={id:"history-container",class:"text-xs text-slate-600 dark:text-slate-300 space-y-2 max-h-56 overflow-y-auto"},ya={key:0,class:"italic text-slate-300"},_a={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},Sa={class:"bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"},Pa={id:"change-history-container",class:"text-xs text-slate-600 dark:text-slate-300 space-y-2 max-h-56 overflow-y-auto"},Ca={key:0,class:"italic text-slate-300"},Ba={key:1,class:"italic text-red-400"},$a={key:2,class:"italic text-slate-300"},ja={class:"text-[10px] text-slate-400 mb-1"},Ma={class:"text-xs text-slate-700"},Da={class:"font-bold"},Na={class:"text-slate-500"},Ta={class:"text-slate-800 font-bold"},Aa={class:"flex flex-wrap gap-2"},Ra=["disabled"],Va=["disabled"],Ua={class:"flex flex-col sm:flex-row gap-2 justify-end pt-2 border-t border-slate-100 dark:border-white/10"},Ea=["disabled"],La=["disabled"],Ia={key:0,class:"inline-flex items-center gap-2"},Oa={key:1},we=10,qa=500,Wa={__name:"Index",props:{initialFilters:{type:Object,default:()=>({})}},setup(Ae){const p=ct("toast"),ye=yt(),Re=W(()=>{var a,e,s;return String(((s=(e=(a=ye.props)==null?void 0:a.auth)==null?void 0:e.user)==null?void 0:s.name)||sessionStorage.getItem("actor_name")||"System")}),Ve=W(()=>{var a,e,s;return String(((s=(e=(a=ye.props)==null?void 0:a.auth)==null?void 0:e.user)==null?void 0:s.role)||sessionStorage.getItem("actor_role")||"system").toLowerCase()}),G=Ae,Z=y(!1),Q=y([]),j=y({priority:0,overdue:0,Baru:0,Survey:0,Proses:0,Pending:0,Req_Batal:0,Batal:0,today_done:0}),v=de({page:1,per_page:we,total:0,total_pages:1}),Ue=W(()=>v.total===0?0:(v.page-1)*v.per_page+1),Ee=W(()=>Math.min(v.total,(v.page-1)*v.per_page+Q.value.length)),S=de({pops:[],technicians:[]}),l=de({search:G.initialFilters.q||"",status:G.initialFilters.status||"",pop:G.initialFilters.pop||"",tech:G.initialFilters.technician||"",date_preset:"",date_from:G.initialFilters.date_from||"",date_to:G.initialFilters.date_to||"",priority_only:!1,overdue_only:!1}),Le=W(()=>l.date_preset==="custom");function Ie(a){const e=String(a||"");return e==="Baru"?"bg-blue-50 text-blue-600 border border-blue-100":e==="Survey"?"bg-purple-50 text-purple-600 border border-purple-100":e==="Proses"?"bg-indigo-50 text-indigo-600 border border-indigo-100":e==="Selesai"?"bg-green-50 text-green-600 border border-green-100":e==="Pending"?"bg-orange-50 text-orange-600 border border-orange-100":e==="Batal"?"bg-red-50 text-red-600 border border-red-100":e==="Req_Batal"?"bg-red-100 text-red-700 border border-red-200 animate-pulse":"bg-slate-100 text-slate-600"}function ue(a){const e=a||new Date,s=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),x=String(e.getDate()).padStart(2,"0");return`${s}-${o}-${x}`}function Oe(a){const e=new Date,s=new Date(e),o=new Date(e);switch(a){case"today":break;case"yesterday":s.setDate(e.getDate()-1),o.setDate(e.getDate()-1);break;case"this_week":s.setDate(e.getDate()-e.getDay());break;case"this_month":s.setDate(1);break;case"this_year":s.setMonth(0),s.setDate(1);break;case"last_year":s.setFullYear(e.getFullYear()-1),s.setMonth(0),s.setDate(1),o.setFullYear(e.getFullYear()-1),o.setMonth(11),o.setDate(31);break;case"last_7":s.setDate(e.getDate()-7);break;case"last_30":s.setDate(e.getDate()-30);break;default:return null}return{from:ue(s),to:ue(o)}}function _e(a){if(a==="custom")return;if(!a){l.date_from="",l.date_to="";return}const e=Oe(a);e&&(l.date_from=e.from,l.date_to=e.to)}function qe(a){return a==="Selesai"||a==="Batal"}function Fe(a){if(!a)return null;const e=String(a).match(/^(\d{4})-(\d{2})-(\d{2})/);if(!e)return null;const s=new Date(Number(e[1]),Number(e[2])-1,Number(e[3])),o=new Date,c=new Date(o.getFullYear(),o.getMonth(),o.getDate()).getTime()-s.getTime();return Math.floor(c/(1e3*60*60*24))}function X(a){return Fe(a==null?void 0:a.installation_date)}function Se(a){const e=X(a);return typeof e=="number"&&e>0&&!qe(a==null?void 0:a.status)}function ze(a){if(!a)return"-";const e=String(a).match(/^(\d{4})-(\d{2})-(\d{2})/);if(!e)return String(a);const s=Number(e[1]),o=Number(e[2]);return`${Number(e[3])} ${["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"][o-1]||""} ${s}`.trim()}function He(a){if(!a)return"";const s=String(a).trim().match(/^(\d{4}-\d{2}-\d{2})\s+(\d{2}:\d{2})/);return s?`${s[1]}T${s[2]}`:""}function pe(a){if(!a)return null;const s=String(a).trim().replace(/\s+/g,",").split(",").map(c=>c.trim()).filter(Boolean);if(s.length<2)return null;const o=parseFloat(s[0]),x=parseFloat(s[1]);return Number.isNaN(o)||Number.isNaN(x)||o<-90||o>90||x<-180||x>180?null:{lat:o,lng:x}}const ee=y(null);async function te(a){const s=await(await fetch(a,{credentials:"same-origin"})).json().catch(()=>null);if(!s)throw new Error("Response JSON tidak valid");return s}async function K(a,e,s){const o=await fetch(a,{method:e,credentials:"same-origin",headers:{"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0}),x=await o.json().catch(()=>null);if(!x)throw new Error("Response JSON tidak valid");if(!o.ok){const c=x.msg||x.message||"Request gagal";throw new Error(c)}return x}async function ce(){if(S.pops.length===0)try{const a=await te("/api/v1/installations/pops");S.pops=a.status==="success"?a.data||[]:[]}catch{S.pops=[]}if(S.technicians.length===0)try{const a=await te("/api/v1/installations/technicians");S.technicians=a.status==="success"?a.data||[]:[]}catch{S.technicians=[]}}function We(a){const e=document.getElementById(`row-${a}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("ring-2","ring-blue-400"),e.style.transition="background-color 300ms ease",e.style.backgroundColor="rgba(59,130,246,0.10)",setTimeout(()=>{e.classList.remove("ring-2","ring-blue-400"),e.style.backgroundColor=""},1800))}async function M(a=1){Z.value=!0;try{const e=new URLSearchParams;e.set("page",String(a)),e.set("per_page",String(we)),l.search&&e.set("search",l.search),l.status&&e.set("status",l.status),l.pop&&e.set("pop",l.pop),l.tech&&e.set("tech",l.tech),l.date_from&&e.set("date_from",l.date_from),l.date_to&&e.set("date_to",l.date_to),l.priority_only&&e.set("priority_only","1"),l.overdue_only&&e.set("overdue_only","1");const s=await te(`/api/v1/installations?${e.toString()}`);if(s.status!=="success")throw new Error(s.msg||"Gagal memuat data");Q.value=Array.isArray(s.data)?s.data:[],v.page=Number(s.page||1),v.per_page=Number(s.per_page||we),v.total=Number(s.total||0),v.total_pages=Number(s.total_pages||1),j.value=s.summary||j.value,await ce(),ee.value&&(await wt(),We(ee.value),ee.value=null)}catch(e){console.error(e),Q.value=[],p&&p.error(e.message||"Gagal memuat data")}finally{Z.value=!1}}function I(){l.priority_only=!1,l.overdue_only=!1,v.page=1,M(1)}function Ge(){l.search="",l.status="",l.pop="",l.tech="",l.date_preset="",l.date_from="",l.date_to="",l.priority_only=!1,l.overdue_only=!1,v.page=1,M(1)}function U(a,e){l.priority_only=!1,l.overdue_only=!1,a==="status"?l.status=e||"":a==="today_done"?(l.status="Selesai",l.date_preset="today",_e("today")):a==="priority"?(l.status="",l.priority_only=!0,p&&p.info("Menampilkan data Prioritas")):a==="overdue"&&(l.status="",l.overdue_only=!0,p&&p.info("Menampilkan data Overdue")),v.page=1,M(1)}function Ke(){_e(l.date_preset),I()}function Je(a){const e=pe(a);if(!e){p&&p.info("Koordinat kosong / tidak valid. Contoh: -6.200000,106.816666");return}const s=`https://www.google.com/maps?q=${encodeURIComponent(`${e.lat},${e.lng}`)}`;window.open(s,"_blank","noopener")}const O=y(!1),q=y(!1),B=y(!1),E=y("edit"),ge=y(!1),F=y([]),z=y(!1),r=de({id:null,ticket_id:"",customer_name:"",customer_phone:"",address:"",pop:"",coordinates:"",plan_name:"",price:"",installation_date:"",finished_at:"",status:"Baru",technician:"",technician_2:"",technician_3:"",technician_4:"",sales_name:"",sales_name_2:"",sales_name_3:"",is_priority:!1,notes_old:"",note_append:""}),Ye=W(()=>String(r.status||"")==="Req_Batal"),Pe=W(()=>String(r.notes_old||"").split(/\r?\n/).map(a=>String(a||"").trim()).filter(a=>a!=="")),Ze={customer_name:"Nama",customer_phone:"WA",address:"Alamat"};function Qe(a){const e=String(a||"").trim();return Ze[e]||e||"-"}let L=null;const se=y(""),be=y(""),le=y("idle"),Ce=y(""),me=y(""),ae=y("idle"),J=y([]);function Y(a,e="idle"){const s=String(a||"");if(!s.trim()){be.value="",le.value="idle";return}be.value=s,le.value=e||"idle"}function fe(a,e=[]){const s=[];a&&a.length>0&&s.push(`Terbaca: ${a.join(", ")}`),e&&e.length>0&&s.push(e.join(" | ")),Ce.value=s.join(" | ")}function re(a,e="idle"){const s=String(a||"");if(!s.trim()){me.value="",ae.value="idle";return}me.value=s,ae.value=e||"idle"}function xe(){se.value="",J.value=[],Y(""),fe([]),re("")}function ne(a){return String(a||"").trim().toLowerCase()}function Be(a){return String(a||"").split(",").map(e=>e.replace(/\\(.*?\\)/g,"").trim()).filter(Boolean)}function $e(a){const e=String(a||"").replace(/\\D/g,"");if(!e)return"";let s=parseInt(e,10);return Number.isNaN(s)||s<=0?"":(e.length<=3&&(s=s*1e3),String(s))}function Xe(a){const e=String(a||"").trim();if(!e)return"";if(/^\\d{4}-\\d{2}-\\d{2}$/.test(e))return e;const s=e.match(/^(\\d{2})[\\/.\\-](\\d{2})[\\/.\\-](\\d{4})$/);return s?`${s[3]}-${s[2]}-${s[1]}`:""}function et(a,e){const s=ne(e);if(!s)return"";const o=Array.isArray(a)?a:[],x=o.find(k=>ne(k)===s);if(x)return x;const c=o.filter(k=>ne(k).startsWith(s));if(c.length===1)return c[0];const P=o.filter(k=>ne(k).includes(s));return P.length===1?P[0]:""}function tt(a){const e={name:"",phone:"",address:"",pop:"",plan:"",price:"",sales:[],techs:[],coords:"",date:""},s=[],o=new Set(["sales","sales1","sales2","sales3","pop","paket","plan","planname","harga","biaya","price","nama","name","wa","whatsapp","hp","telp","phone","nomorwa","nomorwhatsapp","nomorhp","nomortelp","nomorphone","nowa","nohp","alamat","address","maps","lokasi","tanggal","jadwal","install","installationdate"]),x=u=>u?u.startsWith("teknisi")||u.startsWith("psb")||u.startsWith("koordinat")||u.startsWith("coord")?!0:o.has(u):!1,c=u=>{let m=String(u||"").match(/^([^:=]{1,30})\\s*[:=]\\s*(.+)$/);if(m||(m=String(u||"").match(/^([a-zA-Z0-9.\\s]{2,30})\\s+(.+)$/)),!m)return null;const w=String(m[1]||"").trim().toLowerCase().replace(/\\s+/g,"").replace(/[^a-z0-9]/g,"");if(!x(w))return null;const H=String(m[2]||"").trim();return H?{keyClean:w,val:H}:null},P=[];String(a||"").split(/\\r?\\n/).forEach(u=>{const m=String(u||"").trim();if(m){if(m.includes(",")){const n=m.split(",").map(w=>w.trim()).filter(Boolean);if(n.some(w=>c(w))){n.forEach(w=>{w&&P.push(w)});return}}P.push(m)}}),P.forEach(u=>{const m=c(u);if(m){const n=m.keyClean,f=m.val;n.startsWith("teknisi")||n.startsWith("psb")?e.techs=e.techs.concat(Be(f)):n==="sales"||n==="sales1"?Be(f).forEach((H,oe)=>{oe<3&&(e.sales[oe]=H)}):n==="sales2"?e.sales[1]=f:n==="sales3"?e.sales[2]=f:n==="pop"?e.pop=f:n==="paket"||n==="plan"||n==="planname"?e.plan=f:n==="harga"||n==="biaya"||n==="price"?e.price=f:n==="nama"||n==="name"?e.name=f:n==="wa"||n==="whatsapp"||n==="hp"||n==="telp"||n==="phone"||n==="nomorwa"||n==="nomorwhatsapp"||n==="nomorhp"||n==="nomortelp"||n==="nomorphone"||n==="nowa"||n==="nohp"?e.phone=f:n==="alamat"||n==="address"?e.address=f:n.startsWith("koordinat")||n.startsWith("coord")||n==="maps"||n==="lokasi"?e.coords=f:n==="tanggal"||n==="jadwal"||n==="install"||n==="installationdate"?e.date=f:s.push(u);return}s.push(u)});const k=s.slice();for(let u=0;u<k.length;){const m=k[u],n=pe(m);if(!e.coords&&n){e.coords=`${n.lat},${n.lng}`,k.splice(u,1);continue}const f=String(m||"").replace(/\\D/g,""),w=/[a-zA-Z]/.test(String(m||""));if(!e.phone&&f.length>=8){e.phone=String(m||""),k.splice(u,1);continue}if(!e.price&&!w&&f.length>0){e.price=String(m||""),k.splice(u,1);continue}u+=1}if(!e.name){const u=k.findIndex(m=>/[a-zA-Z]/.test(String(m||"")));u>=0&&(e.name=k.splice(u,1)[0])}return!e.address&&k.length&&(e.address=k.shift()),!e.sales[0]&&k.length&&(e.sales[0]=k.shift()),!e.pop&&k.length&&(e.pop=k.shift()),e}function st(a,e={}){if(!a){J.value=[];return}const s=String(e.phoneDigits||"").trim(),o=e.priceValue||$e(a.price),x=Array.isArray(a.sales)?a.sales.filter(u=>String(u||"").trim()!==""):[],c=Array.isArray(a.techs)?a.techs.filter(u=>String(u||"").trim()!==""):[],P=u=>{const m=parseInt(u||0,10);return Number.isNaN(m)||m<=0?"":"Rp. "+m.toLocaleString("id-ID")},k=[{label:"Nama",value:String(a.name||"").trim(),required:!0},{label:"WA",value:s,required:!0},{label:"Alamat",value:String(a.address||"").trim(),required:!0},{label:"POP",value:String(a.pop||"").trim(),required:!0},{label:"Paket",value:String(a.plan||"").trim(),required:!1},{label:"Harga",value:o?P(o):"",required:!1},{label:"Sales",value:x.join(", "),required:!1},{label:"Teknisi",value:c.join(", "),required:!1},{label:"Koordinat",value:String(e.coordsValue||"").trim(),required:!1},{label:"Tanggal",value:String(e.dateValue||"").trim(),required:!1}];J.value=k.filter(u=>u.required||u.value).map(u=>({label:u.label,value:u.value||"-"}))}function at(a={}){const e=se.value||"";if(!e.trim()){fe([]),re(""),J.value=[],a.silent?Y(""):Y("Smart input kosong.","error");return}const s=tt(e),o=[],x=[],c=[],P=String(s.phone||"").replace(/\\D/g,""),k=s.coords?pe(s.coords):null,u=k?`${k.lat},${k.lng}`:"",m=s.date?Xe(s.date):"",n=$e(s.price),f=(d,A)=>{const C=String(A??"").trim();if(!C)return;const ve=C.length>40?C.slice(0,37)+"...":C;x.push(`${d}=${ve}`)},w=(d,A)=>{const C=String(A??"").trim();return C?(r[d]=C,C):""},H=(d,A,C,ve)=>{if(!C)return"";const ke=et(A,C);return ke?(r[d]=ke,ke):(c.push(`${ve} tidak ditemukan: ${C}`),"")};if(s.name){const d=w("customer_name",s.name);d&&(o.push("Nama"),f("Nama",d))}if(s.phone){const d=w("customer_phone",s.phone);d&&(o.push("WA"),f("WA",d))}if(s.address){const d=w("address",s.address);d&&(o.push("Alamat"),f("Alamat",d))}if(s.coords)if(u){const d=w("coordinates",u);d&&(o.push("Koordinat"),f("Koordinat",d))}else c.push(`Koordinat tidak valid: ${s.coords}`);if(s.plan){const d=w("plan_name",s.plan);d&&(o.push("Paket"),f("Paket",d))}if(s.price&&n){const d=w("price",n);d&&(o.push("Harga"),f("Harga",d))}if(s.date)if(m){const d=w("installation_date",m);d&&(o.push("Tanggal"),f("Tanggal",d))}else c.push(`Tanggal tidak valid: ${s.date}`);if(s.pop){const d=H("pop",S.pops,s.pop,"POP");d&&(o.push("POP"),f("POP",d))}if(s.sales[0]){const d=w("sales_name",s.sales[0]);d&&(o.push("Sales 1"),f("Sales 1",d))}if(s.sales[1]){const d=w("sales_name_2",s.sales[1]);d&&(o.push("Sales 2"),f("Sales 2",d))}if(s.sales[2]){const d=w("sales_name_3",s.sales[2]);d&&(o.push("Sales 3"),f("Sales 3",d))}const oe=["technician","technician_2","technician_3","technician_4"];s.techs.forEach((d,A)=>{if(A>=oe.length)return;const C=H(oe[A],S.technicians,d,"Teknisi");C&&(o.push(`Teknisi ${A+1}`),f(`Teknisi ${A+1}`,C))});const D=[];if(s.name&&D.push("Nama"),P&&D.push("WA"),s.address&&D.push("Alamat"),s.pop&&D.push("POP"),s.plan&&D.push("Paket"),n&&D.push("Harga"),Array.isArray(s.sales)&&s.sales.some(d=>String(d||"").trim()!=="")&&D.push("Sales"),Array.isArray(s.techs)&&s.techs.some(d=>String(d||"").trim()!=="")&&D.push("Teknisi"),u&&D.push("Koordinat"),m&&D.push("Tanggal"),fe(D,c),st(s,{phoneDigits:P,coordsValue:u,dateValue:m,priceValue:n}),!!(s.name&&P.length>=8&&s.address&&s.pop)?c.length?re("Periksa data","warn"):re("Siap disimpan","ready"):re("Belum lengkap","error"),c.length){Y(c.join(" | "),"error");return}if(!o.length){a.silent||Y("Tidak ada data yang cocok.","error");return}const pt=x.length?`Terisi: ${x.join(" | ")}`:`Terisi: ${o.join(", ")}`;Y(pt,"success")}gt(se,()=>{!O.value||E.value!=="new"||(L&&clearTimeout(L),L=setTimeout(()=>{at({silent:!0})},qa))});function rt(){r.id=null,r.ticket_id="",r.customer_name="",r.customer_phone="",r.address="",r.pop="",r.coordinates="",r.plan_name="",r.price="",r.installation_date=ue(new Date),r.finished_at="",r.status="Baru",r.technician="",r.technician_2="",r.technician_3="",r.technician_4="",r.sales_name="",r.sales_name_2="",r.sales_name_3="",r.is_priority=!1,r.notes_old="",r.note_append="",F.value=[],z.value=!1}async function ot(a){ge.value=!0,z.value=!1;try{const e=await te(`/api/v1/installations/${a}/history`);e.status==="success"?(F.value=e.data||[],z.value=!1):(F.value=[],z.value=!0)}catch{F.value=[],z.value=!0}finally{ge.value=!1}}async function lt(){E.value="new",q.value=!1,B.value=!1,rt(),xe(),O.value=!0,await ce()}async function je(a){xe(),E.value="edit",O.value=!0,q.value=!0,F.value=[],z.value=!1,r.note_append="";try{await ce();const e=await te(`/api/v1/installations/${a}`);if(e.status!=="success"||!e.data)throw new Error(e.msg||"Data tidak ditemukan");const s=e.data;r.id=s.id,r.ticket_id=s.ticket_id||"",r.customer_name=s.customer_name||"",r.customer_phone=s.customer_phone||"",r.address=s.address||"",r.pop=s.pop||"",r.coordinates=s.coordinates||"",r.plan_name=s.plan_name||"",r.price=s.price||"",r.installation_date=s.installation_date||"",r.finished_at=He(s.finished_at),r.status=s.status||"Baru",r.technician=s.technician||"",r.technician_2=s.technician_2||"",r.technician_3=s.technician_3||"",r.technician_4=s.technician_4||"",r.sales_name=s.sales_name||"",r.sales_name_2=s.sales_name_2||"",r.sales_name_3=s.sales_name_3||"",r.is_priority=String(s.is_priority)==="1",r.notes_old=s.notes||"",await ot(a)}catch(e){p&&p.error(e.message||"Gagal memuat detail"),O.value=!1}finally{q.value=!1}}function ie(){O.value=!1,L&&(clearTimeout(L),L=null),xe()}async function nt(){if(B.value){p&&p.info("Sedang menyimpan data...");return}if(!String(r.customer_name||"").trim()){p&&p.error("Nama pelanggan wajib diisi.");return}B.value=!0;try{const a={customer_name:r.customer_name,customer_phone:r.customer_phone,address:r.address,pop:r.pop,coordinates:r.coordinates,plan_name:r.plan_name,price:r.price,installation_date:r.installation_date,finished_at:r.finished_at||"",status:r.status,technician:r.technician,technician_2:r.technician_2,technician_3:r.technician_3,technician_4:r.technician_4,sales_name:r.sales_name,sales_name_2:r.sales_name_2,sales_name_3:r.sales_name_3,is_priority:r.is_priority?1:0,note_append:(r.note_append||"").trim()};let e=null;if(E.value==="new"?(e=await K("/api/v1/installations","POST",a),ee.value=e.id||null):(e=await K(`/api/v1/installations/${r.id}`,"PUT",a),ee.value=r.id),e.status!=="success")throw new Error(e.msg||"Gagal menyimpan");p&&p.success("Data berhasil disimpan."),ie(),await M(v.page)}catch(a){console.error(a),p&&p.error(a.message||"Gagal menyimpan")}finally{B.value=!1}}async function it(){if(r.id&&confirm("Hapus data ini? Tindakan ini tidak bisa dibatalkan.")){B.value=!0;try{const a=await K(`/api/v1/installations/${r.id}`,"DELETE");if(a.status!=="success")throw new Error(a.msg||"Gagal menghapus");p&&p.success("Data berhasil dihapus."),ie(),await M(v.page)}catch(a){p&&p.error(a.message||"Gagal menghapus")}finally{B.value=!1}}}async function dt(a,e){try{const s=String(e)==="1"?0:1,o=await K(`/api/v1/installations/${a}/toggle-priority`,"POST",{val:s});if(o.status!=="success")throw new Error(o.msg||"Gagal toggle prioritas");await M(v.page)}catch(s){p&&p.error(s.message||"Gagal toggle prioritas")}}async function Me(a){if(!r.id)return;const e=prompt("Catatan (opsional):")||"";B.value=!0;try{const s=await K(`/api/v1/installations/${r.id}/decide-cancel`,"POST",{decision:a,reason:e});if(s.status!=="success")throw new Error(s.msg||"Gagal memproses");p&&p.success("Berhasil."),await je(r.id),await M(v.page)}catch(s){p&&p.error(s.message||"Gagal memproses")}finally{B.value=!1}}const he=y(!1);async function ut(){if(he.value){p&&p.info("Sedang mengirim rekap...");return}const a=(S.pops||[]).map(c=>String(c||"").trim()).filter(Boolean);if(!a.length){p&&p.error("Daftar POP belum termuat. Coba refresh dulu.");return}String(l.pop||"").trim();const e=a.map((c,P)=>`${P+1}. ${c}`).join(`
`),s=prompt(`Pilih POP (ketik nomor):
${e}`),o=parseInt(String(s||"").trim(),10);if(!o||o<1||o>a.length)return;const x=a[o-1];if(x&&confirm(`Kirim rekap WA untuk POP: ${x}?`)){he.value=!0;try{const c=await K("/api/v1/installations/send-pop-recap","POST",{pop_name:x});if(c.status!=="success")throw new Error(c.msg||"Gagal mengirim rekap");const P=c.msg?` - ${c.msg}`:"";p&&p.success(`Rekap terkirim (${c.count||0} data, terkirim ${c.sent||0}, gagal ${c.failed||0})${P}`)}catch(c){p&&p.error(c.message||"Gagal mengirim rekap")}finally{he.value=!1}}}const De=a=>{a.key==="Escape"&&O.value&&ie()};return bt(()=>{l.date_from||l.date_to?l.date_preset="custom":l.date_preset="",M(1),document.addEventListener("keydown",De)}),mt(()=>{document.removeEventListener("keydown",De),L&&(clearTimeout(L),L=null)}),(a,e)=>(b(),g($,null,[Ne(ft(xt),{title:"Monitoring Progress"}),Ne(_t,null,{default:ht(()=>[t("div",{id:"progress-root",class:"flex flex-col gap-6 fade-in pb-20 md:pb-0","data-actor-name":Re.value,"data-actor-role":Ve.value},[t("div",Pt,[e[46]||(e[46]=t("div",null,[t("h2",{class:"text-2xl font-bold text-slate-800 dark:text-white tracking-tight"},"Monitoring Progress"),t("p",{class:"text-slate-500 dark:text-slate-400 text-xs md:text-sm mt-1"}," Pusat kontrol pemasangan, validasi teknisi, dan approval. ")],-1)),t("div",Ct,[t("button",{type:"button",onClick:e[0]||(e[0]=s=>M(1)),class:"group px-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/10 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold hover:bg-slate-50 transition shadow-sm flex items-center gap-2 pointer-events-auto"},[...e[43]||(e[43]=[t("svg",{class:"w-4 h-4 group-hover:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),R(" Refresh ",-1)])]),t("button",{type:"button",onClick:ut,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold shadow-sm transition flex items-center gap-2 pointer-events-auto"},[...e[44]||(e[44]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),R(" Rekap WA ",-1)])]),t("button",{type:"button",onClick:lt,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-bold shadow-lg shadow-blue-200 dark:shadow-none transition flex items-center gap-2 pointer-events-auto relative z-10"},[...e[45]||(e[45]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),R(" Input Baru ",-1)])])])]),t("div",Bt,[t("div",{id:"card-prio",onClick:e[1]||(e[1]=s=>U("priority")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-yellow-50 hover:border-yellow-200 group"},[e[48]||(e[48]=t("div",{class:"w-8 h-8 rounded-lg bg-yellow-50 text-yellow-600 flex items-center justify-center font-bold text-lg group-hover:scale-110 transition-transform"},"★",-1)),t("div",$t,[e[47]||(e[47]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Prioritas",-1)),t("h3",jt,i(j.value.priority||0),1)])]),t("div",{id:"card-overdue",onClick:e[2]||(e[2]=s=>U("overdue")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-red-50 hover:border-red-200 group"},[e[50]||(e[50]=t("div",{class:"w-8 h-8 rounded-lg bg-red-50 text-red-600 flex items-center justify-center group-hover:scale-110 transition-transform"}," ⏰ ",-1)),t("div",Mt,[e[49]||(e[49]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Overdue",-1)),t("h3",Dt,i(j.value.overdue||0),1)])]),t("div",{id:"card-new",onClick:e[3]||(e[3]=s=>U("status","Baru")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-blue-50 hover:border-blue-200 group"},[e[52]||(e[52]=t("div",{class:"w-8 h-8 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])],-1)),t("div",Nt,[e[51]||(e[51]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Baru",-1)),t("h3",Tt,i(j.value.Baru||0),1)])]),t("div",{id:"card-survey",onClick:e[4]||(e[4]=s=>U("status","Survey")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-purple-50 hover:border-purple-200 group"},[e[54]||(e[54]=t("div",{class:"w-8 h-8 rounded-lg bg-purple-50 text-purple-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 7m0 13V7"})])],-1)),t("div",At,[e[53]||(e[53]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Survey",-1)),t("h3",Rt,i(j.value.Survey||0),1)])]),t("div",{id:"card-process",onClick:e[5]||(e[5]=s=>U("status","Proses")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-indigo-50 hover:border-indigo-200 group"},[e[56]||(e[56]=t("div",{class:"w-8 h-8 rounded-lg bg-indigo-50 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),t("div",Vt,[e[55]||(e[55]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Proses",-1)),t("h3",Ut,i(j.value.Proses||0),1)])]),t("div",{id:"card-pending",onClick:e[6]||(e[6]=s=>U("status","Pending")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-orange-50 hover:border-orange-200 group"},[e[58]||(e[58]=t("div",{class:"w-8 h-8 rounded-lg bg-orange-50 text-orange-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Et,[e[57]||(e[57]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Pending",-1)),t("h3",Lt,i(j.value.Pending||0),1)])]),t("div",{id:"card-req-cancel",onClick:e[7]||(e[7]=s=>U("status","Req_Batal")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-pink-50 hover:border-pink-200 group"},[e[60]||(e[60]=t("div",{class:"w-8 h-8 rounded-lg bg-pink-50 text-pink-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t("div",It,[e[59]||(e[59]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Req Batal",-1)),t("h3",Ot,i(j.value.Req_Batal||0),1)])]),t("div",{id:"card-cancel",onClick:e[8]||(e[8]=s=>U("status","Batal")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-red-50 hover:border-red-200 group"},[e[62]||(e[62]=t("div",{class:"w-8 h-8 rounded-lg bg-red-50 text-red-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t("div",qt,[e[61]||(e[61]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Batal",-1)),t("h3",Ft,i(j.value.Batal||0),1)])]),t("div",{id:"card-today-done",onClick:e[9]||(e[9]=s=>U("today_done")),class:"flex-1 min-w-[140px] bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-100 dark:border-white/5 shadow-sm flex items-center gap-3 transition-all cursor-pointer hover:bg-green-50 hover:border-green-200 group"},[e[64]||(e[64]=t("div",{class:"w-8 h-8 rounded-lg bg-green-50 text-green-600 flex items-center justify-center group-hover:scale-110 transition-transform"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",zt,[e[63]||(e[63]=t("p",{class:"text-[10px] font-bold text-slate-400 uppercase truncate"},"Done Today",-1)),t("h3",Ht,i(j.value.today_done||0),1)])])]),t("div",Wt,[t("div",Gt,[t("div",Kt,[h(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>l.search=s),type:"text",id:"search-progress",onKeyup:I,placeholder:"Cari tiket, nama, alamat, teknisi...",class:"w-full pl-9 pr-3 py-2.5 rounded-lg text-xs font-medium border border-slate-300 dark:border-white/15 bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 transition shadow-sm hover:border-slate-400"},null,544),[[_,l.search]]),e[65]||(e[65]=t("svg",{class:"w-4 h-4 text-slate-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),t("div",Jt,[t("div",Yt,[t("div",Zt,[e[67]||(e[67]=t("svg",{class:"w-4 h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),h(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>l.date_preset=s),id:"filter-date-preset",onChange:Ke,class:"w-full h-10 border border-slate-300 dark:border-white/15 rounded-lg px-3 text-xs font-medium bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer transition hover:border-slate-400 dark:hover:border-white/20 shadow-sm"},[...e[66]||(e[66]=[t("option",{value:""},"Semua Tanggal",-1),t("option",{value:"today"},"Hari ini",-1),t("option",{value:"yesterday"},"Kemarin",-1),t("option",{value:"this_week"},"Minggu ini",-1),t("option",{value:"this_month"},"Bulan ini",-1),t("option",{value:"this_year"},"Tahun ini",-1),t("option",{value:"last_year"},"Tahun kemarin",-1),t("option",{value:"last_7"},"7 hari terakhir",-1),t("option",{value:"last_30"},"30 hari terakhir",-1),t("option",{value:"custom"},"Custom Range",-1)])],544),[[V,l.date_preset]])]),t("div",{id:"filter-date-custom",class:N([Le.value?"":"hidden","mt-2 flex flex-col sm:flex-row gap-2 items-start sm:items-center px-3 py-2.5 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-900/30"])},[e[68]||(e[68]=t("span",{class:"text-xs font-semibold text-blue-700 dark:text-blue-300"},"Dari:",-1)),h(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>l.date_from=s),type:"date",id:"filter-date-from",onChange:I,class:"flex-1 w-full sm:w-auto h-8 border border-blue-300 dark:border-blue-700 rounded px-2 text-xs font-medium bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 text-slate-600 dark:text-slate-300 transition hover:border-blue-400"},null,544),[[_,l.date_from]]),e[69]||(e[69]=t("span",{class:"text-xs font-semibold text-blue-700 dark:text-blue-300"},"Hingga:",-1)),h(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>l.date_to=s),type:"date",id:"filter-date-to",onChange:I,class:"flex-1 w-full sm:w-auto h-8 border border-blue-300 dark:border-blue-700 rounded px-2 text-xs font-medium bg-white dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 text-slate-600 dark:text-slate-300 transition hover:border-blue-400"},null,544),[[_,l.date_to]])],2)]),t("div",Qt,[t("div",Xt,[e[71]||(e[71]=t("svg",{class:"w-4 h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),h(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>l.status=s),id:"filter-status-opt",onChange:I,class:"flex-1 h-10 lg:h-10 border border-slate-300 dark:border-white/15 rounded-lg px-2 lg:px-3 py-2 lg:py-2.5 text-xs font-medium text-slate-600 dark:text-slate-300 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer transition hover:border-slate-400 dark:hover:border-white/20 shadow-sm"},[...e[70]||(e[70]=[t("option",{value:""},"Status",-1),t("option",{value:"Baru"},"Baru",-1),t("option",{value:"Survey"},"Survey",-1),t("option",{value:"Proses"},"Proses",-1),t("option",{value:"Selesai"},"Selesai",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Batal"},"Batal",-1),t("option",{value:"Req_Batal"},"Req Batal",-1)])],544),[[V,l.status]])]),t("div",es,[e[73]||(e[73]=t("svg",{class:"w-4 h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),h(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>l.pop=s),id:"filter-pop-opt",onChange:I,class:"flex-1 h-10 lg:h-10 border border-slate-300 dark:border-white/15 rounded-lg px-2 lg:px-3 py-2 lg:py-2.5 text-xs font-medium text-blue-600 dark:text-blue-400 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer transition hover:border-slate-400 dark:hover:border-white/20 shadow-sm"},[e[72]||(e[72]=t("option",{value:""},"Area",-1)),(b(!0),g($,null,T(S.pops,s=>(b(),g("option",{key:s,value:s},i(s),9,ts))),128))],544),[[V,l.pop]])]),t("div",ss,[e[75]||(e[75]=t("svg",{class:"w-4 h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 12H9m4 5h4m0 0h4m-4 0a4 4 0 100-8 4 4 0 000 8z"})],-1)),h(t("select",{"onUpdate:modelValue":e[16]||(e[16]=s=>l.tech=s),id:"filter-tech-opt",onChange:I,class:"flex-1 h-10 lg:h-10 border border-slate-300 dark:border-white/15 rounded-lg px-2 lg:px-3 py-2 lg:py-2.5 text-xs font-medium text-slate-600 dark:text-slate-300 outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer transition hover:border-slate-400 dark:hover:border-white/20 shadow-sm"},[e[74]||(e[74]=t("option",{value:""},"Teknisi",-1)),(b(!0),g($,null,T(S.technicians,s=>(b(),g("option",{key:s,value:s},i(s),9,as))),128))],544),[[V,l.tech]])])]),t("button",{type:"button",onClick:Ge,class:"w-full lg:w-auto px-3 lg:px-4 py-2.5 bg-gradient-to-r from-slate-100 to-slate-50 hover:from-slate-200 hover:to-slate-100 dark:from-slate-800 dark:to-slate-900 dark:hover:from-slate-700 dark:hover:to-slate-800 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-semibold transition flex items-center justify-center lg:justify-start gap-2 border border-slate-200 dark:border-white/10 shadow-sm hover:shadow-md hover:scale-105 active:scale-95",title:"Reset semua filter"},[...e[76]||(e[76]=[t("svg",{class:"w-3.5 h-3.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),R(" Reset ",-1)])])]),e[77]||(e[77]=t("input",{type:"date",id:"filter-date",class:"hidden"},null,-1))]),t("div",rs,[t("table",os,[e[81]||(e[81]=t("thead",{class:"bg-slate-50 dark:bg-slate-800/50 text-xs uppercase text-slate-500 dark:text-slate-400 font-bold border-b border-slate-100 dark:border-white/5"},[t("tr",null,[t("th",{class:"px-4 py-3 text-center w-10"},"★"),t("th",{class:"px-6 py-3"},"Tiket & Waktu"),t("th",{class:"px-6 py-3"},"Pelanggan"),t("th",{class:"px-6 py-3"},"Area (POP)"),t("th",{class:"px-6 py-3"},"Teknisi"),t("th",{class:"px-6 py-3"},"Status")])],-1)),t("tbody",ls,[Z.value?(b(),g("tr",ns,[...e[78]||(e[78]=[t("td",{colspan:"7",class:"px-6 py-10 text-center"},[t("div",{class:"flex justify-center"},[t("div",{class:"w-8 h-8 border-4 border-slate-200 border-t-blue-600 rounded-full animate-spin"})]),t("p",{class:"mt-2 text-xs text-slate-400"},"Sedang memuat data...")],-1)])])):Q.value.length===0?(b(),g("tr",is,[...e[79]||(e[79]=[t("td",{colspan:"7",class:"px-6 py-10 text-center text-slate-400 italic text-xs"},"Tidak ada data ditemukan.",-1)])])):(b(!0),g($,{key:2},T(Q.value,s=>(b(),g("tr",{key:s.id,id:`row-${s.id}`,class:N(["transition border-b border-slate-50 dark:border-white/5 cursor-pointer group",Se(s)?"bg-red-50/30 dark:bg-red-900/10 border-l-4 border-l-red-500":"hover:bg-blue-50/50 dark:hover:bg-slate-800/50"]),onClick:o=>je(s.id)},[t("td",us,[t("button",{type:"button",onClick:vt(o=>dt(s.id,s.is_priority),["stop"]),class:N(["transition-transform p-2",String(s.is_priority)==="1"?"text-yellow-400 hover:scale-110":"text-slate-200 hover:text-yellow-400"])},"★",10,ps)]),t("td",cs,[t("div",gs,[t("div",bs,"#"+i(s.ticket_id||"-"),1),X(s)!==null?(b(),g("span",{key:0,class:N(["ml-2 px-2 py-0.5 rounded-full text-[10px] font-bold",(X(s)||0)>0?"bg-slate-200 text-slate-700":"bg-blue-100 text-blue-700"])},"D+"+i(Math.max(0,X(s)||0)),3)):Te("",!0),Se(s)?(b(),g("span",ms,"⏰ OVERDUE +"+i(X(s))+"d",1)):Te("",!0)]),t("div",fs,i(ze(s.installation_date)),1)]),t("td",xs,[t("div",hs,i(s.customer_name||"-"),1),t("div",vs,i(s.address||"-"),1)]),t("td",ks,[t("span",ws,i(s.pop||"NON-AREA"),1)]),t("td",ys,[s.technician?(b(),g("div",_s,[e[80]||(e[80]=t("div",{class:"w-2 h-2 rounded-full bg-green-500"},null,-1)),t("span",null,i(s.technician),1)])):(b(),g("span",Ss,"Belum assign"))]),t("td",Ps,[t("span",{class:N(["px-2.5 py-1 rounded-full text-[10px] font-bold",Ie(s.status)])},i(s.status||"-"),3)])],10,ds))),128))])])]),t("div",Cs,[t("div",Bs,[e[82]||(e[82]=R(" Data ",-1)),t("span",$s,i(Ue.value),1),e[83]||(e[83]=R(" - ",-1)),t("span",js,i(Ee.value),1),e[84]||(e[84]=R(" dari ",-1)),t("span",Ms,i(v.total),1)]),t("div",Ds,[t("button",{type:"button",onClick:e[17]||(e[17]=s=>M(v.page-1)),disabled:v.page<=1||Z.value,id:"btn-prev",class:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition"},"Prev",8,Ns),t("span",Ts,[t("span",As,i(v.page),1),e[85]||(e[85]=R(" / ",-1)),t("span",Rs,i(v.total_pages),1)]),t("button",{type:"button",onClick:e[18]||(e[18]=s=>M(v.page+1)),disabled:v.page>=v.total_pages||Z.value,id:"btn-next",class:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-bold text-slate-600 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition"},"Next",8,Vs)])])])],8,St),t("div",{id:"detail-modal",class:N([O.value?"":"hidden","fixed inset-0 z-[9999] bg-black/50 p-4 overflow-y-auto"])},[t("div",Us,[t("div",Es,[t("div",Ls,[t("div",Is,i(E.value==="new"?"#NEW":"#"+(r.ticket_id||"-")),1),t("h3",Os,i(E.value==="new"?"Input Baru":"Detail Data"),1)]),t("button",{type:"button",onClick:ie,class:"px-3 py-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs font-black"}," Tutup ")]),t("form",qs,[t("input",{type:"hidden",id:"edit_id",name:"id",value:r.id||""},null,8,Fs),t("input",{type:"hidden",id:"edit_ticket_id",name:"ticket_id",value:r.ticket_id||""},null,8,zs),e[125]||(e[125]=t("input",{type:"hidden",id:"edit_created_at",name:"created_at",value:""},null,-1)),t("div",{id:"progress-smart-panel",class:N([E.value==="new"?"":"hidden","bg-slate-50 dark:bg-slate-800/40 rounded-xl p-4 border border-slate-100 dark:border-white/10"])},[e[88]||(e[88]=t("div",{class:"flex items-center justify-between mb-2"},[t("h4",{class:"text-xs font-black text-blue-600 uppercase"},"Smart Input"),t("span",{class:"text-[10px] text-slate-400 dark:text-slate-500"},"Otomatis")],-1)),t("div",Hs,[t("div",Ws,[h(t("textarea",{"onUpdate:modelValue":e[19]||(e[19]=s=>se.value=s),id:"progress-smart-input",rows:"6",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900 font-mono",placeholder:`ASTRI NURJANAH
082312549753
SUMBER SARI 2 BANGUN NEGARA
Teknisi: DARWIN, MAKMUR
Sales: GUNAWAN
POP: BNG
Paket: Standar - 10 Mbps
Harga: 300`},null,512),[[_,se.value]]),t("div",{id:"progress-smart-status",class:N(["text-[10px] min-h-[12px]",le.value==="error"?"text-red-500 dark:text-red-400":le.value==="success"?"text-green-600 dark:text-green-400":"text-slate-400 dark:text-slate-500"])},i(be.value),3),e[86]||(e[86]=t("div",{class:"text-[10px] text-slate-400 dark:text-slate-500"},' Tempel data bebas (per baris atau dipisah koma). Bisa pakai label "Nama:", "WA:", "Alamat:" dll, atau tanpa label (urutan: Nama, WA, Alamat, Sales, POP). ',-1))]),t("div",Gs,[t("div",Ks,[e[87]||(e[87]=t("div",{class:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase"},"Review Data",-1)),t("div",{id:"progress-smart-ready",class:N(["text-[10px] font-bold",ae.value==="ready"?"text-emerald-600 dark:text-emerald-400":ae.value==="warn"?"text-amber-600 dark:text-amber-400":ae.value==="error"?"text-red-500 dark:text-red-400":"text-slate-400 dark:text-slate-500"])},i(me.value),3)]),t("div",Js,i(Ce.value),1),t("div",Ys,[J.value.length?(b(!0),g($,{key:0},T(J.value,(s,o)=>(b(),g($,{key:o},[t("div",Zs,i(s.label),1),t("div",Qs,i(s.value),1)],64))),128)):(b(),g("div",Xs,"Tempel data untuk melihat review."))])])])],2),t("div",ea,[t("div",ta,[e[91]||(e[91]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Data Pelanggan",-1)),e[92]||(e[92]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Nama",-1)),h(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>r.customer_name=s),id:"edit_name",name:"customer_name",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Nama pelanggan"},null,512),[[_,r.customer_name]]),t("div",sa,[t("div",null,[e[89]||(e[89]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"WhatsApp",-1)),h(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>r.customer_phone=s),id:"edit_phone",name:"customer_phone",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"08xxx / 62xxx"},null,512),[[_,r.customer_phone]])]),t("div",null,[e[90]||(e[90]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Koordinat",-1)),t("div",aa,[h(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>r.coordinates=s),id:"edit_coordinates",name:"coordinates",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"-6.2,106.8"},null,512),[[_,r.coordinates]]),t("button",{type:"button",onClick:e[23]||(e[23]=s=>Je(r.coordinates)),class:"px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-xs font-black"}," Maps ")])])]),e[93]||(e[93]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1 mt-3"},"Alamat",-1)),h(t("textarea",{"onUpdate:modelValue":e[24]||(e[24]=s=>r.address=s),id:"edit_address",name:"address",rows:"3",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Alamat lengkap..."},null,512),[[_,r.address]])]),t("div",ra,[e[103]||(e[103]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Data Pemasangan",-1)),t("div",oa,[t("div",null,[e[95]||(e[95]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"POP / Area",-1)),h(t("select",{"onUpdate:modelValue":e[25]||(e[25]=s=>r.pop=s),id:"edit_pop",name:"pop",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[e[94]||(e[94]=t("option",{value:""},"-- Pilih --",-1)),(b(!0),g($,null,T(S.pops,s=>(b(),g("option",{key:s,value:s},i(s),9,la))),128))],512),[[V,r.pop]])]),t("div",null,[e[96]||(e[96]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Tanggal (installation_date)",-1)),h(t("input",{"onUpdate:modelValue":e[26]||(e[26]=s=>r.installation_date=s),id:"edit_date",name:"installation_date",type:"date",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},null,512),[[_,r.installation_date]])])]),t("div",na,[t("div",null,[e[97]||(e[97]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Paket",-1)),h(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>r.plan_name=s),id:"edit_plan",name:"plan_name",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Nama paket"},null,512),[[_,r.plan_name]])]),t("div",null,[e[98]||(e[98]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Harga",-1)),h(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>r.price=s),id:"edit_price",name:"price",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Contoh: 250000"},null,512),[[_,r.price]])])]),t("div",ia,[t("div",null,[e[100]||(e[100]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Status",-1)),h(t("select",{"onUpdate:modelValue":e[29]||(e[29]=s=>r.status=s),id:"edit_status",name:"status",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[...e[99]||(e[99]=[t("option",{value:"Baru"},"Baru",-1),t("option",{value:"Survey"},"Survey",-1),t("option",{value:"Proses"},"Proses",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Selesai"},"Selesai",-1),t("option",{value:"Req_Batal"},"Req_Batal",-1),t("option",{value:"Batal"},"Batal",-1)])],512),[[V,r.status]])]),t("div",null,[e[101]||(e[101]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Selesai (finished_at)",-1)),h(t("input",{"onUpdate:modelValue":e[30]||(e[30]=s=>r.finished_at=s),id:"edit_finished_at",name:"finished_at",type:"datetime-local",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},null,512),[[_,r.finished_at]])])]),t("div",da,[h(t("input",{"onUpdate:modelValue":e[31]||(e[31]=s=>r.is_priority=s),id:"edit_priority",name:"is_priority",type:"checkbox",value:"1",class:"w-4 h-4"},null,512),[[kt,r.is_priority]]),e[102]||(e[102]=t("label",{for:"edit_priority",class:"text-xs font-black text-slate-700 dark:text-slate-200"},"Prioritas",-1))])])]),t("div",ua,[t("div",pa,[e[112]||(e[112]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Teknisi",-1)),t("div",ca,[t("div",null,[e[105]||(e[105]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Teknisi 1",-1)),h(t("select",{"onUpdate:modelValue":e[32]||(e[32]=s=>r.technician=s),id:"edit_technician",name:"technician",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[e[104]||(e[104]=t("option",{value:""},"-- Pilih --",-1)),(b(!0),g($,null,T(S.technicians,s=>(b(),g("option",{key:s,value:s},i(s),9,ga))),128))],512),[[V,r.technician]])]),t("div",null,[e[107]||(e[107]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Teknisi 2",-1)),h(t("select",{"onUpdate:modelValue":e[33]||(e[33]=s=>r.technician_2=s),id:"edit_tech_2",name:"technician_2",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[e[106]||(e[106]=t("option",{value:""},"-- Pilih --",-1)),(b(!0),g($,null,T(S.technicians,s=>(b(),g("option",{key:s,value:s},i(s),9,ba))),128))],512),[[V,r.technician_2]])]),t("div",null,[e[109]||(e[109]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Teknisi 3",-1)),h(t("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>r.technician_3=s),id:"edit_tech_3",name:"technician_3",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[e[108]||(e[108]=t("option",{value:""},"-- Pilih --",-1)),(b(!0),g($,null,T(S.technicians,s=>(b(),g("option",{key:s,value:s},i(s),9,ma))),128))],512),[[V,r.technician_3]])]),t("div",null,[e[111]||(e[111]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Teknisi 4",-1)),h(t("select",{"onUpdate:modelValue":e[35]||(e[35]=s=>r.technician_4=s),id:"edit_tech_4",name:"technician_4",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900"},[e[110]||(e[110]=t("option",{value:""},"-- Pilih --",-1)),(b(!0),g($,null,T(S.technicians,s=>(b(),g("option",{key:s,value:s},i(s),9,fa))),128))],512),[[V,r.technician_4]])])])]),t("div",xa,[e[116]||(e[116]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Sales",-1)),t("div",ha,[t("div",null,[e[113]||(e[113]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Sales 1",-1)),h(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>r.sales_name=s),id:"edit_sales_1",name:"sales_name",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Nama sales"},null,512),[[_,r.sales_name]])]),t("div",null,[e[114]||(e[114]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Sales 2",-1)),h(t("input",{"onUpdate:modelValue":e[37]||(e[37]=s=>r.sales_name_2=s),id:"edit_sales_2",name:"sales_name_2",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Nama sales"},null,512),[[_,r.sales_name_2]])]),t("div",null,[e[115]||(e[115]=t("label",{class:"block text-[11px] font-bold text-slate-500 mb-1"},"Sales 3",-1)),h(t("input",{"onUpdate:modelValue":e[38]||(e[38]=s=>r.sales_name_3=s),id:"edit_sales_3",name:"sales_name_3",type:"text",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Nama sales"},null,512),[[_,r.sales_name_3]])])])])]),t("div",va,[t("div",ka,[e[117]||(e[117]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Riwayat",-1)),h(t("textarea",{"onUpdate:modelValue":e[39]||(e[39]=s=>r.notes_old=s),id:"edit_notes_old",name:"notes_old",class:"hidden"},null,512),[[_,r.notes_old]]),t("div",wa,[Pe.value.length===0?(b(),g("span",ya,"Belum ada riwayat.")):(b(!0),g($,{key:1},T(Pe.value,(s,o)=>(b(),g("div",{key:o,class:"border-b border-slate-100 pb-1"},i(s),1))),128))])]),t("div",_a,[e[118]||(e[118]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Tambah Catatan",-1)),h(t("textarea",{"onUpdate:modelValue":e[40]||(e[40]=s=>r.note_append=s),id:"edit_notes",name:"notes_append",rows:"6",class:"w-full px-3 py-2 rounded-lg text-xs border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900",placeholder:"Tulis catatan baru..."},null,512),[[_,r.note_append]]),e[119]||(e[119]=t("p",{class:"mt-2 text-[11px] text-slate-400"},"Catatan akan otomatis ditambahkan ke riwayat (append).",-1))])]),t("div",Sa,[e[122]||(e[122]=t("h4",{class:"text-xs font-black text-slate-700 dark:text-slate-200 mb-3"},"Audit Perubahan Data",-1)),t("div",Pa,[ge.value?(b(),g("span",Ca,"Memuat...")):z.value?(b(),g("span",Ba,"Gagal memuat riwayat perubahan.")):F.value.length===0?(b(),g("span",$a,"Belum ada perubahan.")):(b(!0),g($,{key:3},T(F.value,(s,o)=>(b(),g("div",{key:o,class:"border-b border-slate-100 pb-2"},[t("div",ja,i(s.changed_at||"-")+" - "+i(s.changed_by||"-")+" ("+i(s.changed_by_role||"-")+") via "+i(s.source||"-"),1),t("div",Ma,[t("span",Da,i(Qe(s.field_name)),1),e[120]||(e[120]=R(": ",-1)),t("span",Na,i(String(s.old_value||"").trim()||"-"),1),e[121]||(e[121]=t("span",{class:"text-slate-400 px-1"},"->",-1)),t("span",Ta,i(String(s.new_value||"").trim()||"-"),1)])]))),128))])]),t("div",{id:"panel-approval-batal",class:N([E.value!=="new"&&Ye.value?"":"hidden","bg-red-50 dark:bg-red-900/20 rounded-xl p-4 border border-red-100 dark:border-red-500/20"])},[e[123]||(e[123]=t("h4",{class:"text-xs font-black text-red-700 dark:text-red-200 mb-2"},"Approval Pembatalan",-1)),t("div",Aa,[t("button",{type:"button",onClick:e[41]||(e[41]=s=>Me("approve")),disabled:B.value||q.value,class:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white text-xs font-black"}," Approve Batal ",8,Ra),t("button",{type:"button",onClick:e[42]||(e[42]=s=>Me("reject")),disabled:B.value||q.value,class:"px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-800 text-white text-xs font-black"}," Tolak (Kembali Pending) ",8,Va)])],2),t("div",Ua,[t("button",{type:"button",onClick:it,disabled:B.value||q.value,class:N([E.value==="new"?"hidden":"","px-4 py-2 rounded-lg bg-red-50 hover:bg-red-100 text-red-700 text-xs font-black disabled:opacity-70 disabled:cursor-not-allowed"])}," Hapus ",10,Ea),t("button",{id:"btn-progress-save",type:"button",onClick:nt,disabled:B.value||q.value,class:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-xs font-black disabled:opacity-70 disabled:cursor-not-allowed"},[B.value?(b(),g("span",Ia,[...e[124]||(e[124]=[t("svg",{class:"w-4 h-4 animate-spin",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},[t("circle",{cx:"12",cy:"12",r:"9",stroke:"currentColor","stroke-opacity":"0.3","stroke-width":"3"}),t("path",{d:"M21 12a9 9 0 0 0-9-9",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round"})],-1),R(" Menyimpan... ",-1)])])):(b(),g("span",Oa,"Simpan"))],8,La)])])])],2)]),_:1})],64))}};export{Wa as default};
