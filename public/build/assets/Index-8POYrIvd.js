import{o as V,c as i,a as j,u as H,h as N,m as B,b as e,j as n,F as g,s as v,t as l,e as p,d as k,B as O,T as F,I,f as z,v as T,r as c,y as U}from"./app-D84xlh30.js";import{_ as D}from"./AdminLayout-C8iern4a.js";const G={class:"space-y-8 animate-fade-in"},K={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},q={class:"flex items-start justify-between mb-4"},J={class:"flex items-center space-x-3"},Q={class:"p-3 rounded-lg bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 group-hover:scale-110 transition-transform duration-300"},Y={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},W={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},X={class:"text-xl font-bold text-gray-900 dark:text-white capitalize tracking-tight"},Z={class:"text-xs font-medium text-gray-400 uppercase tracking-wider"},ee={class:"space-y-3 relative z-10"},re={class:"flex items-center justify-between text-sm"},te={class:"px-2 py-0.5 rounded-full text-xs font-bold bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"},se={class:"flex flex-wrap gap-1.5 h-20 overflow-hidden content-start"},ae={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400"},oe={key:1,class:"text-xs text-gray-400 italic py-2"},ne={class:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700 flex justify-end items-center gap-3 relative z-10"},ie=["onClick"],le=["onClick"],de={key:0,class:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},ue={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ce={class:"inline-block align-bottom bg-white dark:bg-dark-900 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl w-full relative z-10 animate-scale-in"},me={class:"px-6 py-5 border-b border-gray-100 dark:border-dark-800 flex justify-between items-center bg-gray-50/50 dark:bg-dark-800/50"},pe={class:"text-xl font-bold text-gray-900 dark:text-white",id:"modal-title"},ge={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},fe={class:"px-6 py-6 space-y-6"},ye={class:"relative rounded-md shadow-sm"},ve=["disabled"],ke={key:0,class:"text-xs text-amber-600 mt-2 flex items-center"},xe={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-4"},be={class:"relative w-full sm:w-64"},he={class:"h-[60vh] sm:h-96 overflow-y-auto custom-scrollbar border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-800/50 p-4 space-y-4"},we={class:"flex items-center justify-between mb-3 border-b border-gray-100 dark:border-dark-700 pb-2"},_e={class:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider flex items-center"},je=["onClick"],Ce={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},Me=["checked","onChange"],Be={class:"text-sm text-gray-600 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors select-none"},ze={key:0,class:"text-center py-12 text-gray-500"},Te={class:"flex justify-between items-center mt-2 text-xs text-gray-500"},$e={class:"bg-gray-50 dark:bg-dark-800 px-6 py-4 flex flex-col-reverse sm:flex-row sm:justify-end gap-3 border-t border-gray-100 dark:border-dark-700"},Ee=["disabled"],Ae={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},x="/api/v1",Pe={__name:"Index",setup(Le){const C=c([]),h=c([]),w=c(!1),m=c(!1),u=c(!1),f=c(!1),y=c(""),o=c({id:null,name:"",permissions:[]});async function _(){w.value=!0;try{const s=await fetch(`${x}/roles`);C.value=await s.json()}catch(s){console.error("Error loading roles:",s)}finally{w.value=!1}}async function $(){try{const s=await fetch(`${x}/permissions`);h.value=await s.json()}catch(s){console.error("Error loading permissions:",s)}}function E(){u.value=!1,o.value={id:null,name:"",permissions:[]},m.value=!0,y.value=""}function A(s){u.value=!0,o.value={id:s.id,name:s.name,permissions:s.permissions.map(r=>r.name)},m.value=!0,y.value=""}async function L(){if(o.value.name){f.value=!0;try{const s=u.value?`${x}/roles/${o.value.id}`:`${x}/roles`,r=u.value?"PUT":"POST",t=await fetch(s,{method:r,headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(o.value)});if(t.ok)m.value=!1,_();else{const a=await t.json();alert(a.message||"Gagal menyimpan role")}}catch(s){console.error("Error saving role:",s),alert("Terjadi kesalahan sistem")}finally{f.value=!1}}}async function R(s){if(confirm(`Yakin ingin menghapus role "${s.name}"? Tindakan ini tidak dapat dibatalkan.`))try{const r=await fetch(`${x}/roles/${s.id}`,{method:"DELETE",headers:{Accept:"application/json"}});if(r.ok)_();else{const t=await r.json();alert(t.message||"Gagal menghapus role")}}catch(r){console.error("Error deleting role:",r)}}const M=U(()=>{const s={},r=y.value.toLowerCase();return h.value.forEach(t=>{if(r&&!t.name.toLowerCase().includes(r))return;const a=t.name.split(" "),d=a.length>1?a.slice(1).join(" "):"System",b=d.charAt(0).toUpperCase()+d.slice(1);s[b]||(s[b]=[]),s[b].push(t)}),Object.keys(s).sort().reduce((t,a)=>(t[a]=s[a],t),{})});function S(s){const r=o.value.permissions.indexOf(s);r===-1?o.value.permissions.push(s):o.value.permissions.splice(r,1)}function P(s,r){r.every(a=>o.value.permissions.includes(a.name))?r.forEach(a=>{const d=o.value.permissions.indexOf(a.name);d!==-1&&o.value.permissions.splice(d,1)}):r.forEach(a=>{o.value.permissions.includes(a.name)||o.value.permissions.push(a.name)})}return V(()=>{_(),$()}),(s,r)=>(n(),i(g,null,[j(H(N),{title:"Kelola Role"}),j(D,null,{default:B(()=>[e("div",G,[e("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-white dark:bg-dark-800 p-6 rounded-2xl shadow-card border border-gray-100 dark:border-dark-700"},[r[6]||(r[6]=e("div",null,[e("h1",{class:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-primary-400"}," Role & Permissions "),e("p",{class:"text-gray-500 dark:text-gray-400 mt-1"}," Atur akses dan keamanan sistem dengan mudah. ")],-1)),e("button",{onClick:E,class:"group relative inline-flex items-center justify-center px-6 py-3 text-sm font-medium text-white transition-all duration-200 bg-primary-600 border border-transparent rounded-xl hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 shadow-glow-blue hover:shadow-glow-blue-lg overflow-hidden"},[...r[5]||(r[5]=[e("span",{class:"absolute inset-0 w-full h-full -mt-1 rounded-lg opacity-30 bg-gradient-to-b from-transparent via-transparent to-black"},null,-1),e("svg",{class:"w-5 h-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),e("span",null,"Tambah Role Baru",-1)])])]),e("div",K,[w.value?(n(),i(g,{key:0},v(3,t=>e("div",{key:t,class:"h-48 bg-gray-100 dark:bg-dark-800 rounded-2xl animate-pulse"})),64)):(n(!0),i(g,{key:1},v(C.value,t=>(n(),i("div",{key:t.id,class:"group relative flex flex-col justify-between bg-white dark:bg-dark-800 rounded-2xl p-6 shadow-card hover:shadow-card-hover transition-all duration-300 border border-transparent hover:border-primary-100 dark:hover:border-primary-900/30"},[r[12]||(r[12]=e("div",{class:"absolute top-0 right-0 p-4 opacity-5 group-hover:opacity-10 transition-opacity"},[e("svg",{class:"w-24 h-24 text-primary-600 transform rotate-12",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})])],-1)),e("div",null,[e("div",q,[e("div",J,[e("div",Q,[t.name==="admin"||t.name==="owner"?(n(),i("svg",Y,[...r[7]||(r[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},null,-1)])])):(n(),i("svg",W,[...r[8]||(r[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])]))]),e("div",null,[e("h3",X,l(t.name.replace(/_/g," ")),1),e("span",Z,l(t.name==="owner"?"Super Admin":"Role Sistem"),1)])])]),e("div",ee,[e("div",re,[r[9]||(r[9]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Akses Permission",-1)),e("span",te,l(t.permissions.length)+" Item ",1)]),e("div",se,[(n(!0),i(g,null,v(t.permissions.slice(0,6),a=>(n(),i("span",{key:a.id,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-50 dark:bg-dark-700 text-gray-600 dark:text-gray-300 border border-gray-100 dark:border-gray-600"},l(a.name),1))),128)),t.permissions.length>6?(n(),i("span",ae," +"+l(t.permissions.length-6)+" lainnya ",1)):p("",!0),t.permissions.length===0?(n(),i("span",oe," Tidak ada permission khusus. ")):p("",!0)])])]),e("div",ne,[e("button",{onClick:a=>A(t),class:"flex-1 inline-flex justify-center items-center px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-dark-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors"},[...r[10]||(r[10]=[e("svg",{class:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),k(" Edit ",-1)])],8,ie),["admin","owner"].includes(t.name)?p("",!0):(n(),i("button",{key:0,onClick:a=>R(t),class:"inline-flex justify-center items-center px-4 py-2 text-sm font-medium text-red-600 bg-red-50 dark:bg-red-900/20 border border-transparent rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"},[...r[11]||(r[11]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,le))])]))),128))])]),(n(),O(F,{to:"body"},[j(I,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:B(()=>[m.value?(n(),i("div",de,[e("div",ue,[e("div",{class:"fixed inset-0 bg-gray-900/50 dark:bg-black/70 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick:r[0]||(r[0]=t=>m.value=!1)}),r[22]||(r[22]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),e("div",ce,[e("div",me,[e("div",null,[e("h3",pe,l(u.value?"Edit Konfigurasi Role":"Buat Role Baru"),1),e("p",ge,l(u.value?`Mengubah akses untuk role: ${o.value.name}`:"Tentukan nama dan hak akses untuk role baru."),1)]),e("button",{onClick:r[1]||(r[1]=t=>m.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700"},[...r[13]||(r[13]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",fe,[e("div",null,[r[16]||(r[16]=e("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"},[k(" Nama Identitas Role "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ye,[r[14]||(r[14]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})])],-1)),z(e("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>o.value.name=t),type:"text",class:"input w-full pl-10 py-2.5 border-gray-300 dark:border-dark-600 focus:ring-primary-500 focus:border-primary-500 rounded-lg dark:bg-dark-800 dark:text-white",placeholder:"Contoh: staff_admin, supervisor_teknisi",disabled:u.value&&["admin","owner"].includes(o.value.name)},null,8,ve),[[T,o.value.name]])]),u.value&&["admin","owner"].includes(o.value.name)?(n(),i("p",ke,[...r[15]||(r[15]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),k(" Role sistem tidak dapat diubah namanya. ",-1)])])):p("",!0)]),e("div",null,[e("div",xe,[r[18]||(r[18]=e("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"}," Akses & Permissions ",-1)),e("div",be,[r[17]||(r[17]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),z(e("input",{"onUpdate:modelValue":r[3]||(r[3]=t=>y.value=t),type:"text",class:"w-full pl-9 pr-3 py-1.5 text-sm border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-800 dark:text-white",placeholder:"Cari izin akses..."},null,512),[[T,y.value]])])]),e("div",he,[(n(!0),i(g,null,v(M.value,(t,a)=>(n(),i("div",{key:a,class:"bg-white dark:bg-dark-800 rounded-lg border border-gray-100 dark:border-dark-700 p-4 shadow-sm"},[e("div",we,[e("h4",_e,[r[19]||(r[19]=e("span",{class:"w-1.5 h-4 bg-primary-500 rounded-full mr-2"},null,-1)),k(" "+l(a),1)]),e("button",{onClick:d=>P(a,t),class:"text-xs text-primary-600 hover:text-primary-700 font-medium hover:underline"}," Toggle Semua ",8,je)]),e("div",Ce,[(n(!0),i(g,null,v(t,d=>(n(),i("label",{key:d.id,class:"group flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-700 cursor-pointer transition-colors border border-transparent hover:border-gray-200 dark:hover:border-dark-600"},[e("input",{type:"checkbox",checked:o.value.permissions.includes(d.name),onChange:b=>S(d.name),class:"mt-0.5 rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"},null,40,Me),e("span",Be,l(d.name),1)]))),128))])]))),128)),Object.keys(M.value).length===0?(n(),i("div",ze,[...r[20]||(r[20]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("p",null,"Tidak ada permission yang cocok dengan pencarian.",-1)])])):p("",!0)]),e("div",Te,[e("span",null,"Total Terpilih: "+l(o.value.permissions.length),1),e("span",null,"Total Tersedia: "+l(h.value.length),1)])])]),e("div",$e,[e("button",{onClick:r[4]||(r[4]=t=>m.value=!1),class:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2.5 bg-white dark:bg-dark-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 sm:text-sm transition-all"}," Batal "),e("button",{onClick:L,disabled:f.value,class:"w-full sm:w-auto inline-flex justify-center rounded-xl border border-transparent shadow-glow-blue px-6 py-2.5 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:text-sm transition-all disabled:opacity-70 disabled:cursor-not-allowed"},[f.value?(n(),i("svg",Ae,[...r[21]||(r[21]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):p("",!0),k(" "+l(f.value?"Menyimpan Perubahan...":"Simpan Konfigurasi"),1)],8,Ee)])])])])):p("",!0)]),_:1})]))]),_:1})],64))}};export{Pe as default};
