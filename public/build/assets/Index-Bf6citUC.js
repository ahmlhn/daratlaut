import{o as fe,c as o,a as ie,u as he,h as we,m as _e,b as t,n as x,t as c,f as q,v as X,j as i,F as f,s as _,e as y,d as C,r as p,y as S}from"./app-DL_lWBci.js";import{_ as Ce}from"./AdminLayout-BIk4ezIf.js";const Se={class:"space-y-6 animate-fade-in"},je={class:"grid grid-cols-1 md:grid-cols-[360px,1fr] gap-6"},Me={class:"p-5 border-b border-gray-100 dark:border-dark-700 bg-gradient-to-b from-gray-50/80 to-white dark:from-dark-800/60 dark:to-dark-800"},Te={class:"flex items-center justify-between gap-3"},Re={class:"text-xs text-gray-500 dark:text-gray-400"},Ee={class:"mt-3 relative"},Ae={class:"mt-3 flex items-center gap-2"},Le={class:"p-2"},Be={key:0,class:"space-y-2 p-2"},Pe={key:1,class:"max-h-[70vh] overflow-y-auto custom-scrollbar"},$e=["onClick"],Oe={class:"flex items-start justify-between gap-3"},ze={class:"min-w-0"},Ne={class:"flex items-center gap-2"},Ue={class:"font-extrabold text-sm capitalize truncate"},De={class:"shrink-0"},Ie={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ve={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},He={key:0,class:"p-6 text-center text-sm text-gray-500 dark:text-gray-400"},Fe={class:"p-5 border-b border-gray-100 dark:border-dark-700 bg-gradient-to-b from-gray-50/80 to-white dark:from-dark-800/60 dark:to-dark-800"},Je={class:"flex items-start justify-between gap-4"},Ke={class:"min-w-0"},Ge={class:"flex items-center gap-2"},qe={class:"text-sm font-extrabold text-gray-900 dark:text-white tracking-tight truncate"},Xe={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 border border-amber-200/60 dark:border-amber-900/40"},Ye={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Qe={key:0,class:"ml-2"},Ze={class:"flex items-center gap-2 shrink-0"},We=["disabled"],et={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},tt={key:0,class:"p-10 text-center"},rt={key:1,class:"p-6 space-y-6"},at={class:"relative rounded-md shadow-sm"},st=["disabled"],nt={key:0,class:"text-xs text-amber-600 mt-2 flex items-center"},ot={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-3 gap-3"},it={class:"border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 overflow-hidden"},lt={class:"overflow-x-auto"},dt={class:"min-w-[1040px] w-full text-sm"},ut={class:"bg-white/60 dark:bg-dark-900/60"},ct={class:"text-xs font-extrabold text-gray-600 dark:text-gray-300"},pt={class:"divide-y divide-gray-200 dark:divide-dark-700"},mt={class:"sticky left-0 z-10 px-4 py-3 bg-white dark:bg-dark-900 border-r border-gray-100 dark:border-dark-700"},gt={class:"flex items-start justify-between gap-3"},kt={class:"text-sm font-bold text-gray-900 dark:text-white"},bt={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},yt={class:"mt-1 text-[11px] text-gray-500 dark:text-gray-400"},vt={class:"inline-flex items-center gap-2 text-[11px] font-semibold text-gray-600 dark:text-gray-300 select-none"},xt=["checked","disabled","onChange"],ft=["checked","disabled","onChange"],ht={key:1,class:"text-xs text-gray-300 dark:text-dark-600 select-none"},wt={class:"px-4 py-3"},_t={key:0,class:"flex flex-wrap gap-2"},Ct=["checked","disabled","onChange"],St={key:1,class:"text-xs text-gray-400 italic"},jt={key:0,class:"space-y-3"},Mt={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},Tt={class:"relative w-full sm:w-80"},Rt={class:"h-[60vh] sm:h-[420px] overflow-y-auto custom-scrollbar border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 p-4 space-y-4"},Et={class:"flex items-center justify-between mb-3 border-b border-gray-100 dark:border-dark-700 pb-2"},At={class:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider flex items-center"},Lt=["onClick"],Bt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},Pt=["checked","onChange"],$t={class:"text-sm text-gray-600 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors select-none"},Ot={key:0,class:"text-center py-12 text-gray-500"},zt={class:"flex justify-between items-center text-xs text-gray-500"},Nt={key:1,class:"pt-4 border-t border-gray-100 dark:border-dark-700"},$="/api/v1",Vt={__name:"Index",setup(Ut){const j=p([]),L=p([]),N=p(!1),R=p(!1),E=p(!1),U=p(""),h=p("all"),M=p(""),w=p(!1),T=p(!1),k=p("none"),m=p(null),d=p({id:null,name:"",permissions:[]}),D=p(null),Y=p(""),le=["admin","owner"],I=[{key:"view",label:"Lihat"},{key:"create",label:"Tambah"},{key:"edit",label:"Edit"},{key:"delete",label:"Hapus"},{key:"approve",label:"Approve"},{key:"export",label:"Export"},{key:"manage",label:"Manage"}],de=[{key:"dashboard",label:"Dashboard",description:"Ringkasan & statistik.",perms:{view:"view dashboard"}},{key:"installations",label:"Pasang Baru",description:"Instalasi, monitoring, approval.",perms:{view:"view installations",create:"create installations",edit:"edit installations",delete:"delete installations",approve:"approve installations"},extras:[{label:"Kirim rekap",perm:"send installations recap"},{label:"Riwayat",perm:"view riwayat installations"}]},{key:"team",label:"Tim",description:"Teknisi/sales/staff.",perms:{view:"view team",create:"create team",edit:"edit team",delete:"delete team",manage:"manage team"}},{key:"teknisi",label:"Teknisi",description:"Tugas, riwayat, rekap.",perms:{view:"view teknisi",edit:"edit teknisi"},extras:[{label:"Kirim rekap",perm:"send teknisi recap"}]},{key:"maps",label:"Maps",description:"Tracking teknisi.",perms:{view:"view maps",manage:"manage maps"}},{key:"chat",label:"Chat",description:"Chat admin.",perms:{view:"view chat",create:"send chat",edit:"edit chat",delete:"delete chat"}},{key:"leads",label:"Leads",description:"Prospek & konversi.",perms:{view:"view leads",create:"create leads",edit:"edit leads",delete:"delete leads"},extras:[{label:"Convert",perm:"convert leads"},{label:"Bulk",perm:"bulk leads"}]},{key:"customers",label:"Pelanggan",description:"Data pelanggan.",perms:{view:"view customers",create:"create customers",edit:"edit customers",delete:"delete customers"}},{key:"plans",label:"Paket Layanan",description:"Produk/paket.",perms:{view:"view plans",create:"create plans",edit:"edit plans",delete:"delete plans"}},{key:"invoices",label:"Invoice",description:"Tagihan.",perms:{view:"view invoices",create:"create invoices",edit:"edit invoices",delete:"delete invoices"}},{key:"payments",label:"Pembayaran",description:"Transaksi.",perms:{view:"view payments",create:"create payments",edit:"edit payments",delete:"delete payments"}},{key:"reports",label:"Laporan",description:"Analitik & export.",perms:{view:"view reports",export:"export reports"}},{key:"finance",label:"Keuangan",description:"Transaksi & approval.",perms:{view:"view finance",create:"create finance",edit:"edit finance",delete:"delete finance",approve:"approve finance",export:"export finance",manage:"manage finance"}},{key:"olts",label:"OLT",description:"Provisioning OLT/ONU.",perms:{view:"view olts",create:"create olts",edit:"edit olts",delete:"delete olts",manage:"manage olt"}},{key:"isolir",label:"Isolir",description:"Suspend/unsuspend.",perms:{manage:"manage isolir"}},{key:"settings",label:"Pengaturan Sistem",description:"Settings, roles, update.",perms:{manage:"manage settings"},extras:[{label:"Kelola role",perm:"manage roles"},{label:"Update sistem",perm:"manage system update"}]}];function V(r){return(r||"").toString().replace(/_/g," ").trim()}function g(r){const e=(r||"").toString().toLowerCase().trim();return le.includes(e)}function Q(r){return JSON.parse(JSON.stringify(r))}function H(r){const e=[],s=new Set;return(r||[]).forEach(n=>{!n||s.has(n)||(s.add(n),e.push(n))}),e}function Z(r){return{name:((r==null?void 0:r.name)||"").toString().trim(),permissions:H((r==null?void 0:r.permissions)||[]).slice().sort()}}function B(){D.value=Q(d.value),Y.value=JSON.stringify(Z(d.value))}const F=S(()=>JSON.stringify(Z(d.value))!==Y.value);function J(){return F.value?confirm("Perubahan belum disimpan. Lanjut dan buang perubahan?"):!0}const v=S(()=>m.value&&(j.value||[]).find(r=>String(r.id)===String(m.value))||null),A=S(()=>k.value==="edit"),ue=S(()=>k.value==="create"),W=S(()=>{const r=(j.value||[]).slice();return r.sort((e,s)=>{const n=((e==null?void 0:e.name)||"").toString().toLowerCase(),l=((s==null?void 0:s.name)||"").toString().toLowerCase(),a=g(n),u=g(l);return a!==u?a?-1:1:n.localeCompare(l)}),r}),ee=S(()=>{const r=U.value.toLowerCase().trim();return W.value.filter(e=>{const s=((e==null?void 0:e.name)||"").toString().toLowerCase();return(h.value==="all"?!0:h.value==="system"?g(s):!g(s))?r?s.includes(r)||V(s).toLowerCase().includes(r):!0:!1})});async function K(){N.value=!0;try{const e=await(await fetch(`${$}/roles`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);if(j.value=Array.isArray(e)?e:[],k.value!=="create"&&!(m.value&&j.value.some(n=>String(n.id)===String(m.value)))){const n=W.value[0];n?O(n,{force:!0,keepMobile:!0}):(k.value="none",m.value=null)}}catch(r){console.error("Error loading roles:",r),j.value=[]}finally{N.value=!1}}async function ce(){R.value=!0;try{const e=await(await fetch(`${$}/permissions`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);L.value=Array.isArray(e)?e:[]}catch(r){console.error("Error loading permissions:",r),L.value=[]}finally{R.value=!1}}function te(){J()&&(k.value="create",m.value=null,d.value={id:null,name:"",permissions:[]},M.value="",w.value=!1,T.value=!0,B())}function O(r,e={}){const s=!!e.force,n=!!e.keepMobile;!s&&!J()||(k.value="edit",m.value=(r==null?void 0:r.id)??null,d.value={id:(r==null?void 0:r.id)??null,name:(r==null?void 0:r.name)??"",permissions:((r==null?void 0:r.permissions)||[]).map(l=>l.name)},M.value="",w.value=!1,n||(T.value=!0),B())}function pe(){const r=v.value;r&&J()&&(k.value="create",m.value=null,d.value={id:null,name:`${r.name}_copy`,permissions:(r.permissions||[]).map(e=>e.name)},M.value="",w.value=!1,T.value=!0,B())}function me(){D.value&&(d.value=Q(D.value))}async function ge(){const r=(d.value.name||"").toString().trim();if(r){E.value=!0;try{const e=A.value?`${$}/roles/${d.value.id}`:`${$}/roles`,s=A.value?"PUT":"POST",n={name:r,permissions:H(d.value.permissions||[])},l=await fetch(e,{method:s,credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),a=await l.json().catch(()=>null);if(!l.ok){alert(a&&(a.message||a.msg)?a.message||a.msg:"Gagal menyimpan role");return}await K();const u=a==null?void 0:a.id,b=u?j.value.find(oe=>String(oe.id)===String(u)):null;b?O(b,{force:!0,keepMobile:!1}):k.value!=="create"&&v.value&&O(v.value,{force:!0,keepMobile:!1})}catch(e){console.error("Error saving role:",e),alert("Terjadi kesalahan sistem")}finally{E.value=!1}}}async function ke(){const r=v.value;if(r&&!g(r.name)&&confirm(`Yakin ingin menghapus role "${r.name}"? Tindakan ini tidak dapat dibatalkan.`)){E.value=!0;try{const e=await fetch(`${$}/roles/${r.id}`,{method:"DELETE",credentials:"same-origin",headers:{Accept:"application/json"}}),s=await e.json().catch(()=>null);if(!e.ok){alert(s&&(s.message||s.msg)?s.message||s.msg:"Gagal menghapus role");return}k.value="none",m.value=null,d.value={id:null,name:"",permissions:[]},M.value="",w.value=!1,T.value=!1,B(),await K()}catch(e){console.error("Error deleting role:",e),alert("Terjadi kesalahan sistem")}finally{E.value=!1}}}const re=S(()=>{const r={},e=M.value.toLowerCase().trim();return(L.value||[]).forEach(s=>{if(!(s!=null&&s.name))return;const n=s.name.toLowerCase();if(e&&!n.includes(e))return;const l=s.name.split(" "),a=l.length>1?l.slice(1).join(" "):"System",u=a.charAt(0).toUpperCase()+a.slice(1);r[u]||(r[u]=[]),r[u].push(s)}),Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{})});function G(r){const e=d.value.permissions||[],s=e.indexOf(r);s===-1?e.push(r):e.splice(s,1),d.value.permissions=e}function be(r){if(r.every(n=>d.value.permissions.includes(n.name))){const n=new Set(r.map(l=>l.name));d.value.permissions=(d.value.permissions||[]).filter(l=>!n.has(l));return}const s=new Set(d.value.permissions||[]);r.forEach(n=>s.add(n.name)),d.value.permissions=Array.from(s)}const ae=S(()=>new Set((L.value||[]).map(r=>r.name)));function se(r){if(!r)return!1;const e=ae.value;return!e||e.size===0?!0:e.has(r)}function P(r,e){var s;return((s=r==null?void 0:r.perms)==null?void 0:s[e])||null}function z(r){const e=[];(I||[]).forEach(l=>{const a=P(r,l.key);a&&e.push(a)}),((r==null?void 0:r.extras)||[]).forEach(l=>{l!=null&&l.perm&&e.push(l.perm)});const s=H(e),n=ae.value;return!n||n.size===0?s:s.filter(l=>n.has(l))}function ne(r){return z(r).length}function ye(r){const e=z(r);if(e.length===0)return 0;const s=new Set(d.value.permissions||[]);return e.filter(n=>s.has(n)).length}function ve(r){const e=z(r);if(e.length===0)return!1;const s=new Set(d.value.permissions||[]);return e.every(n=>s.has(n))}function xe(r){const e=z(r);if(e.length===0)return;const s=new Set(d.value.permissions||[]);e.every(l=>s.has(l))?e.forEach(l=>s.delete(l)):e.forEach(l=>s.add(l)),d.value.permissions=Array.from(s)}return fe(()=>{K(),ce(),B()}),(r,e)=>(i(),o(f,null,[ie(he(we),{title:"Kelola Role"}),ie(Ce,null,{default:_e(()=>{var s,n,l;return[t("div",Se,[t("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-white dark:bg-dark-800 p-6 rounded-2xl shadow-card border border-gray-100 dark:border-dark-700"},[e[9]||(e[9]=t("div",null,[t("h1",{class:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-primary-400"}," Role & Permissions "),t("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"Atur akses dan keamanan sistem dengan cepat.")],-1)),t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",onClick:te,class:"group relative inline-flex items-center justify-center px-5 py-3 text-sm font-medium text-white transition-all duration-200 bg-primary-600 border border-transparent rounded-xl hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 shadow-glow-blue hover:shadow-glow-blue-lg overflow-hidden"},[...e[8]||(e[8]=[t("span",{class:"absolute inset-0 w-full h-full -mt-1 rounded-lg opacity-30 bg-gradient-to-b from-transparent via-transparent to-black"},null,-1),t("svg",{class:"w-5 h-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",null,"Role Baru",-1)])])])]),t("div",je,[t("aside",{class:x([[T.value?"hidden md:block":""],"bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 shadow-card overflow-hidden"])},[t("div",Me,[t("div",Te,[e[10]||(e[10]=t("div",{class:"text-sm font-extrabold text-gray-900 dark:text-white tracking-tight"},"Daftar Role",-1)),t("div",Re,c(j.value.length)+" role",1)]),t("div",Ee,[e[11]||(e[11]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),q(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),type:"text",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-dark-700 rounded-xl focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-900 dark:text-white",placeholder:"Cari role..."},null,512),[[X,U.value]])]),t("div",Ae,[t("button",{type:"button",onClick:e[1]||(e[1]=a=>h.value="all"),class:x(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",h.value==="all"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Semua ",2),t("button",{type:"button",onClick:e[2]||(e[2]=a=>h.value="system"),class:x(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",h.value==="system"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Sistem ",2),t("button",{type:"button",onClick:e[3]||(e[3]=a=>h.value="custom"),class:x(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",h.value==="custom"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Custom ",2)])]),t("div",Le,[N.value?(i(),o("div",Be,[(i(),o(f,null,_(6,a=>t("div",{key:a,class:"h-14 rounded-xl bg-gray-100 dark:bg-dark-900 animate-pulse"})),64))])):(i(),o("div",Pe,[(i(!0),o(f,null,_(ee.value,a=>(i(),o("button",{key:a.id,type:"button",onClick:u=>O(a),class:x(["w-full text-left rounded-xl p-3 border transition-all mb-2",String(m.value)===String(a.id)?"bg-gradient-to-r from-primary-600 to-primary-700 text-white border-transparent shadow-lg shadow-primary-600/20":"bg-white dark:bg-dark-900 border-gray-100 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])},[t("div",Oe,[t("div",ze,[t("div",Ne,[t("span",Ue,c(V(a.name)),1),t("span",{class:x(["inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold border",[g(a.name)?String(m.value)===String(a.id)?"border-white/30 bg-white/10":"border-primary-200/60 bg-primary-50 text-primary-700 dark:bg-primary-900/20 dark:text-primary-300 dark:border-primary-900/40":String(m.value)===String(a.id)?"border-white/30 bg-white/10":"border-gray-200 bg-gray-50 text-gray-700 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700"]])},c(g(a.name)?"SISTEM":"CUSTOM"),3)]),t("div",{class:x(["mt-1 text-[11px] leading-snug",[String(m.value)===String(a.id)?"text-white/80":"text-gray-500 dark:text-gray-400"]])},c((a.permissions||[]).length)+" permission ",3)]),t("div",De,[t("div",{class:x(["h-9 w-9 rounded-xl flex items-center justify-center border",[String(m.value)===String(a.id)?"bg-white/10 border-white/20":"bg-primary-50 dark:bg-primary-900/20 border-primary-100 dark:border-primary-900/30"]])},[g(a.name)?(i(),o("svg",Ie,[...e[12]||(e[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},null,-1)])])):(i(),o("svg",Ve,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])]))],2)])])],10,$e))),128)),ee.value.length===0?(i(),o("div",He," Tidak ada role yang cocok. ")):y("",!0)]))])],2),t("section",{class:x([[T.value?"":"hidden md:block"],"bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 shadow-card overflow-hidden"])},[t("div",Fe,[t("div",Je,[t("div",Ke,[t("div",Ge,[t("button",{type:"button",class:"md:hidden inline-flex items-center justify-center h-9 w-9 rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200",onClick:e[4]||(e[4]=a=>T.value=!1)},[...e[14]||(e[14]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("div",qe,c(ue.value?"Buat Role Baru":v.value?`Edit Role: ${V(v.value.name)}`:"Pilih Role"),1),F.value?(i(),o("span",Xe," Belum disimpan ")):y("",!0)]),t("div",Ye,[C(c(d.value.permissions.length)+" permission dipilih ",1),R.value?(i(),o("span",Qe,"(memuat katalog...)")):y("",!0)])]),t("div",Ze,[A.value?(i(),o("button",{key:0,type:"button",onClick:pe,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Duplikat ")):y("",!0),F.value?(i(),o("button",{key:1,type:"button",onClick:me,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Reset ")):y("",!0),t("button",{type:"button",onClick:ge,disabled:E.value||!d.value.name.trim(),class:"inline-flex items-center justify-center px-4 py-2 text-xs font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-glow-blue"},[E.value?(i(),o("svg",et,[...e[15]||(e[15]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),e[16]||(e[16]=C(" Simpan ",-1))],8,We)])])]),k.value==="none"?(i(),o("div",tt,[t("div",{class:"max-w-md mx-auto"},[e[17]||(e[17]=t("div",{class:"text-lg font-extrabold text-gray-900 dark:text-white"},"Pilih role",-1)),e[18]||(e[18]=t("div",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Pilih role di panel kiri untuk mengubah akses, atau buat role baru. ",-1)),t("button",{type:"button",onClick:te,class:"mt-5 inline-flex items-center justify-center px-5 py-3 text-sm font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-glow-blue"}," Buat Role Baru ")])])):(i(),o("div",rt,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"},[C(" Nama Identitas Role "),t("span",{class:"text-red-500"},"*")],-1)),t("div",at,[e[19]||(e[19]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})])],-1)),q(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>d.value.name=a),type:"text",class:"input w-full pl-10 py-2.5 border-gray-300 dark:border-dark-600 focus:ring-primary-500 focus:border-primary-500 rounded-lg dark:bg-dark-900 dark:text-white",placeholder:"Contoh: staff_admin, supervisor_teknisi",disabled:A.value&&g((s=v.value)==null?void 0:s.name)},null,8,st),[[X,d.value.name]])]),A.value&&g((n=v.value)==null?void 0:n.name)?(i(),o("p",nt,[...e[20]||(e[20]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),C(" Role sistem tidak dapat diubah namanya. ",-1)])])):y("",!0)]),t("div",null,[t("div",ot,[e[23]||(e[23]=t("div",null,[t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Matrix Akses per Modul"),t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"}," Centang permission per aksi. Untuk permission khusus, aktifkan mode lanjutan. ")],-1)),t("button",{type:"button",onClick:e[6]||(e[6]=a=>w.value=!w.value),class:"inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"},[e[22]||(e[22]=t("svg",{class:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),C(" "+c(w.value?"Sembunyikan Mode Lanjutan":"Tampilkan Mode Lanjutan"),1)])]),t("div",it,[t("div",lt,[t("table",dt,[t("thead",ut,[t("tr",ct,[e[24]||(e[24]=t("th",{class:"sticky left-0 z-10 text-left px-4 py-3 bg-white/60 dark:bg-dark-900/60 border-b border-gray-200 dark:border-dark-700"}," Modul ",-1)),(i(),o(f,null,_(I,a=>t("th",{key:a.key,class:"px-3 py-3 text-center border-b border-gray-200 dark:border-dark-700 whitespace-nowrap"},c(a.label),1)),64)),e[25]||(e[25]=t("th",{class:"px-4 py-3 text-left border-b border-gray-200 dark:border-dark-700"},"Extra",-1))])]),t("tbody",pt,[(i(),o(f,null,_(de,a=>t("tr",{key:a.key,class:"bg-white dark:bg-dark-900 hover:bg-gray-50 dark:hover:bg-dark-800/60 transition-colors"},[t("td",mt,[t("div",gt,[t("div",null,[t("div",kt,c(a.label),1),t("div",bt,c(a.description),1),t("div",yt," Terpilih: "+c(ye(a))+"/"+c(ne(a)),1)]),t("label",vt,[t("input",{type:"checkbox",checked:ve(a),disabled:R.value||ne(a)===0,onChange:u=>xe(a),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,xt),e[26]||(e[26]=C(" Semua ",-1))])])]),(i(),o(f,null,_(I,u=>t("td",{key:u.key,class:"px-3 py-3 text-center"},[P(a,u.key)?(i(),o("input",{key:0,type:"checkbox",checked:d.value.permissions.includes(P(a,u.key)),disabled:R.value||!se(P(a,u.key)),onChange:b=>G(P(a,u.key)),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,ft)):(i(),o("span",ht,"-"))])),64)),t("td",wt,[(a.extras||[]).length>0?(i(),o("div",_t,[(i(!0),o(f,null,_(a.extras,u=>(i(),o("label",{key:u.perm,class:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-gray-200 dark:border-dark-700 bg-gray-50 dark:bg-dark-800 text-[11px] font-semibold text-gray-700 dark:text-gray-200 select-none"},[t("input",{type:"checkbox",checked:d.value.permissions.includes(u.perm),disabled:R.value||!se(u.perm),onChange:b=>G(u.perm),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,Ct),t("span",null,c(u.label),1)]))),128))])):(i(),o("div",St,"Tidak ada."))])])),64))])])]),e[27]||(e[27]=t("div",{class:"px-4 py-3 text-xs text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-dark-700"},' Tips: Gunakan "Semua" untuk toggle satu modul. Untuk permission yang tidak muncul di matrix, gunakan Mode Lanjutan. ',-1))])]),w.value?(i(),o("div",jt,[t("div",Mt,[e[29]||(e[29]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"}," Mode Lanjutan: Checklist Permission ",-1)),t("div",Tt,[e[28]||(e[28]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),q(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>M.value=a),type:"text",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-dark-700 rounded-xl focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-900 dark:text-white",placeholder:"Cari permission..."},null,512),[[X,M.value]])])]),t("div",Rt,[(i(!0),o(f,null,_(re.value,(a,u)=>(i(),o("div",{key:u,class:"bg-white dark:bg-dark-900 rounded-lg border border-gray-100 dark:border-dark-700 p-4 shadow-sm"},[t("div",Et,[t("h4",At,[e[30]||(e[30]=t("span",{class:"w-1.5 h-4 bg-primary-500 rounded-full mr-2"},null,-1)),C(" "+c(u),1)]),t("button",{type:"button",onClick:b=>be(a),class:"text-xs text-primary-600 hover:text-primary-700 font-semibold hover:underline"}," Toggle Semua ",8,Lt)]),t("div",Bt,[(i(!0),o(f,null,_(a,b=>(i(),o("label",{key:b.id,class:"group flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-800 cursor-pointer transition-colors border border-transparent hover:border-gray-200 dark:hover:border-dark-700"},[t("input",{type:"checkbox",checked:d.value.permissions.includes(b.name),onChange:oe=>G(b.name),class:"mt-0.5 rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"},null,40,Pt),t("span",$t,c(b.name),1)]))),128))])]))),128)),Object.keys(re.value).length===0?(i(),o("div",Ot,[...e[31]||(e[31]=[t("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",null,"Tidak ada permission yang cocok dengan pencarian.",-1)])])):y("",!0)]),t("div",zt,[t("span",null,"Total Terpilih: "+c(d.value.permissions.length),1),t("span",null,"Total Tersedia: "+c(L.value.length),1)])])):y("",!0),A.value&&!g((l=v.value)==null?void 0:l.name)?(i(),o("div",Nt,[t("div",{class:"flex items-center justify-between gap-3"},[e[33]||(e[33]=t("div",null,[t("div",{class:"text-sm font-extrabold text-gray-900 dark:text-white"},"Danger Zone"),t("div",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Hapus role ini dari sistem.")],-1)),t("button",{type:"button",onClick:ke,class:"inline-flex justify-center items-center px-4 py-2 text-xs font-semibold text-red-600 bg-red-50 dark:bg-red-900/20 border border-transparent rounded-xl hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"},[...e[32]||(e[32]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),C(" Hapus Role ",-1)])])])])):y("",!0)]))],2)])])]}),_:1})],64))}};export{Vt as default};
