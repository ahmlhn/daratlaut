import{C as pl,E as me,G as pa,o as cl,D as bl,c as n,a as ca,u as gl,h as fl,m as ml,b as t,t as d,f as m,x as R,j as i,e as g,d as _,n as M,i as lt,v as w,F as A,s as j,w as ne,r as f,y as V,z as yl}from"./app-PlAuM9nD.js";import{_ as kl}from"./AdminLayout-DHPOt8SH.js";const xl={class:"space-y-4 animate-fade-in"},_l={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 bg-white dark:bg-dark-800 p-5 rounded-xl shadow-card border border-gray-100 dark:border-dark-700"},hl={class:"flex flex-wrap items-center gap-2"},wl={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},Cl={class:"font-semibold text-gray-900 dark:text-white"},Nl={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},Pl={class:"font-semibold text-gray-900 dark:text-white"},Tl={class:"px-3 py-2 rounded-lg bg-red-50/60 dark:bg-red-900/10 border border-red-200/60 dark:border-red-900/30 text-xs"},Sl={class:"font-semibold text-red-700 dark:text-red-300"},El={class:"hidden lg:flex items-center gap-2 ml-2"},Ll=["disabled"],Ol={key:0,class:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-900/30 text-amber-800 dark:text-amber-200 rounded-xl p-4 text-sm"},$l={key:1,class:"bg-white dark:bg-dark-800 border border-gray-100 dark:border-dark-700 rounded-xl p-6"},Ul={key:2,class:"relative"},Ml={class:"grid grid-cols-1 lg:grid-cols-12 gap-4"},Fl={class:"flex flex-wrap items-center gap-2 p-3 border-b border-gray-100 dark:border-dark-700"},Il={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Al={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},jl={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Vl={class:"ml-auto flex items-center gap-2 lg:hidden"},Gl=["disabled"],Rl={class:"relative flex-1 min-h-[420px] lg:min-h-0"},Dl={key:0,class:"absolute inset-0 z-10 flex items-center justify-center p-6 bg-white/85 dark:bg-dark-900/70 backdrop-blur"},Bl={class:"max-w-md text-center"},Kl={class:"mt-1 text-xs text-gray-600 dark:text-gray-300"},Hl={key:1,class:"absolute bottom-3 left-3 right-3 lg:right-auto lg:max-w-md bg-white/90 dark:bg-dark-900/80 backdrop-blur border border-gray-200 dark:border-white/10 rounded-xl p-3 text-xs text-gray-700 dark:text-gray-200 shadow-lg"},Jl={class:"font-semibold"},zl={class:"uppercase"},Wl={key:0,class:"text-gray-600 dark:text-gray-300 mt-1"},ql={key:1,class:"text-gray-600 dark:text-gray-300 mt-1"},Zl={class:"font-semibold"},Xl={key:0,class:"ml-1 text-blue-700 dark:text-blue-300"},Yl={key:2,class:"text-gray-600 dark:text-gray-300 mt-1"},Ql={key:3,class:"mt-2 flex items-center gap-2 text-xs text-gray-700 dark:text-gray-200"},es=["disabled"],ts={class:"mt-2 flex items-center gap-2"},as=["disabled"],ls=["disabled"],ss=["disabled"],os={class:"lg:hidden px-4 pt-2 pb-3 border-b border-gray-100 dark:border-dark-700"},rs={class:"mt-2 flex items-center gap-2"},ns={value:"cables"},is={value:"points"},us={value:"ports"},ds={value:"links"},vs={value:"breaks"},ps={class:"hidden lg:flex items-center gap-1 border-b border-gray-100 dark:border-dark-700 overflow-x-auto"},cs={class:"p-4 overflow-y-auto flex-1 min-h-0"},bs={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},gs={key:1,class:"text-sm text-red-600 dark:text-red-300"},fs={key:2,class:"space-y-3"},ms={class:"flex items-center justify-between"},ys={class:"flex items-center gap-2"},ks=["placeholder"],xs={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},_s={class:"font-semibold text-gray-800 dark:text-gray-200"},hs={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},ws={key:2,class:"space-y-2 pr-1"},Cs=["onClick"],Ns={class:"flex items-start justify-between gap-2"},Ps={class:"text-sm font-semibold text-gray-900 dark:text-white"},Ts={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Ss={key:0},Es={key:1,class:"ml-2"},Ls={key:2,class:"ml-2"},Os={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},$s={class:"font-medium text-gray-700 dark:text-gray-200"},Us={class:"font-medium text-gray-700 dark:text-gray-200"},Ms={class:"flex items-center gap-1 shrink-0"},Fs=["onClick"],Is=["onClick"],As={key:3,class:"space-y-3"},js={class:"flex items-center justify-between"},Vs={class:"flex items-center gap-2"},Gs=["placeholder"],Rs={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},Ds={class:"font-semibold text-gray-800 dark:text-gray-200"},Bs={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Ks={key:2,class:"space-y-2 pr-1"},Hs=["onClick"],Js={class:"flex items-start justify-between gap-2"},zs={class:"text-sm font-semibold text-gray-900 dark:text-white"},Ws={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},qs={key:0},Zs={key:1,class:"ml-2"},Xs={class:"flex items-center gap-1 shrink-0"},Ys=["onClick"],Qs=["onClick"],eo={key:4,class:"space-y-3"},to={class:"flex items-center justify-between"},ao={class:"flex items-center gap-2"},lo=["placeholder"],so={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},oo={class:"font-semibold text-gray-800 dark:text-gray-200"},ro={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},no={key:2,class:"space-y-2 pr-1"},io={class:"flex items-start justify-between gap-2"},uo={class:"text-xs font-bold text-indigo-700 dark:text-indigo-300"},vo={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},po={class:"text-xs text-gray-500 dark:text-gray-400 mt-1 space-y-0.5"},co={class:"font-medium text-gray-700 dark:text-gray-200"},bo={key:0},go={class:"font-medium text-gray-700 dark:text-gray-200"},fo={class:"ml-1"},mo={class:"flex items-center gap-1 shrink-0"},yo=["onClick"],ko=["onClick"],xo={key:5,class:"space-y-3"},_o={class:"flex items-center justify-between"},ho={class:"flex items-center gap-2"},wo=["placeholder"],Co={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},No={class:"font-semibold text-gray-800 dark:text-gray-200"},Po={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},To={key:2,class:"space-y-2 pr-1"},So={class:"flex items-start justify-between gap-2"},Eo={class:"min-w-0"},Lo={class:"text-xs font-bold text-amber-700 dark:text-amber-300"},Oo={key:0,class:"ml-1"},$o={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Uo={class:"font-medium text-gray-700 dark:text-gray-200"},Mo={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1 truncate"},Fo={key:0,class:"text-gray-700 dark:text-gray-200"},Io={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},Ao={key:0},jo={key:1,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Vo={class:"font-medium text-gray-700 dark:text-gray-200"},Go={class:"flex items-center gap-1 shrink-0"},Ro=["onClick"],Do=["onClick"],Bo={key:6,class:"space-y-3"},Ko={class:"flex items-center justify-between"},Ho=["disabled"],Jo={class:"space-y-2"},zo=["value"],Wo={class:"flex items-center gap-2"},qo=["disabled"],Zo=["disabled"],Xo={key:0,class:"text-xs text-red-600 dark:text-red-300"},Yo={key:0,class:"space-y-3"},Qo={class:"text-xs text-gray-500 dark:text-gray-400"},er={class:"font-semibold text-gray-800 dark:text-gray-200"},tr={class:"font-semibold text-gray-800 dark:text-gray-200"},ar={key:0,class:"ml-2 text-amber-700 dark:text-amber-300"},lr={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},sr={key:1,class:"space-y-2 max-h-[260px] overflow-auto pr-1"},or=["onClick"],rr={class:"text-sm font-semibold text-gray-900 dark:text-white"},nr={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},ir={class:"font-medium text-gray-700 dark:text-gray-200"},ur={key:2,class:"rounded-xl border border-gray-100 dark:border-dark-700 p-3 bg-gray-50/40 dark:bg-dark-900/30"},dr={class:"mt-2 space-y-1 max-h-[220px] overflow-auto pr-1"},vr={class:"font-medium text-gray-900 dark:text-white"},pr={class:"text-gray-600 dark:text-gray-300"},cr={key:7,class:"space-y-3"},br={class:"flex items-center justify-between"},gr={class:"flex items-center gap-2"},fr=["placeholder"],mr={class:"flex flex-wrap items-center gap-2"},yr={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},kr={class:"font-semibold text-gray-800 dark:text-gray-200"},xr={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},_r={key:2,class:"space-y-2 pr-1"},hr=["onClick"],wr={class:"flex items-start justify-between gap-2"},Cr={class:"text-xs font-bold"},Nr={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},Pr={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Tr={key:0,class:"ml-2"},Sr={key:0,class:"text-xs text-gray-600 dark:text-gray-300 mt-1 line-clamp-2"},Er={class:"flex items-center gap-1 shrink-0"},Lr=["disabled","onClick"],Or=["onClick"],$r=["onClick"],Ur={class:"relative pointer-events-auto w-full max-w-2xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden max-h-[calc(100vh-2rem)] flex flex-col"},Mr={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Fr={class:"font-semibold text-gray-900 dark:text-white"},Ir={class:"p-4 space-y-3 overflow-y-auto flex-1 min-h-0"},Ar={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},jr={key:0,class:"text-xs text-red-600 mt-1"},Vr={key:0,class:"text-xs text-red-600 mt-1"},Gr={key:0,class:"text-xs text-red-600 mt-1"},Rr={key:0,class:"text-xs text-red-600 mt-1"},Dr={class:"md:col-span-2"},Br={class:"flex flex-col sm:flex-row gap-2"},Kr={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Hr={class:"font-medium text-gray-700 dark:text-gray-200"},Jr={class:"ml-2"},zr={key:0,class:"ml-2"},Wr=["value"],qr=["value"],Zr={class:"md:col-span-2"},Xr={class:"flex items-center gap-2"},Yr={class:"md:col-span-2"},Qr={class:"rounded-xl border border-gray-100 dark:border-dark-700 p-3"},en={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},tn={class:"text-xs text-gray-500 dark:text-gray-400"},an={class:"flex flex-wrap items-center gap-2"},ln={class:"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-200 px-3 py-2 rounded-xl border border-gray-200/70 dark:border-white/10 bg-white/70 dark:bg-dark-900/40"},sn=["disabled"],on=["disabled"],rn=["disabled"],nn=["disabled"],un={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},dn=["disabled"],vn={class:"relative pointer-events-auto w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden max-h-[calc(100vh-2rem)] flex flex-col"},pn={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},cn={class:"font-semibold text-gray-900 dark:text-white"},bn={class:"p-4 space-y-3 overflow-y-auto flex-1 min-h-0"},gn={key:0,class:"text-xs text-red-600 mt-1"},fn={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},mn={key:0,class:"text-xs text-red-600 mt-1"},yn={key:0,class:"text-xs text-red-600 mt-1"},kn={class:"flex items-center gap-2"},xn={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},_n=["disabled"],hn={class:"relative pointer-events-auto w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden max-h-[calc(100vh-2rem)] flex flex-col"},wn={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Cn={class:"font-semibold text-gray-900 dark:text-white"},Nn={class:"p-4 space-y-3 overflow-y-auto flex-1 min-h-0"},Pn=["value"],Tn=["value"],Sn={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},En={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ln=["disabled"],On={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},$n={key:0,class:"text-xs text-red-600 mt-1"},Un={key:0,class:"text-xs text-red-600 mt-1"},Mn={class:"flex items-center gap-2"},Fn={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},In=["disabled"],An={key:3,class:"fixed inset-0 z-[10000] flex items-center justify-center p-4"},jn={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden max-h-[calc(100vh-2rem)] flex flex-col"},Vn={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Gn={class:"font-semibold text-gray-900 dark:text-white"},Rn={class:"p-4 space-y-3 overflow-y-auto flex-1 min-h-0"},Dn=["value"],Bn={key:0,class:"text-xs text-red-600 mt-1"},Kn={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Hn={key:0,class:"text-xs text-red-600 mt-1"},Jn={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},zn=["value"],Wn={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},qn=["disabled"],Zn={key:4,class:"fixed inset-0 z-[10000] flex items-center justify-center p-4"},Xn={class:"relative w-full max-w-2xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden max-h-[calc(100vh-2rem)] flex flex-col"},Yn={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Qn={class:"font-semibold text-gray-900 dark:text-white"},ei={class:"p-4 space-y-3 overflow-y-auto flex-1 min-h-0"},ti=["value"],ai={key:0,class:"text-xs text-red-600 mt-1"},li={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},si={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},oi=["value"],ri={key:0,class:"text-xs text-red-600 mt-1"},ni={key:0,class:"text-xs text-red-600 mt-1"},ii={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ui=["value"],di={key:1,class:"space-y-3 rounded-xl border border-gray-100 dark:border-dark-700 p-3"},vi={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},pi={class:"flex items-center gap-2"},ci={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},bi={key:1,class:"space-y-2 max-h-[260px] overflow-auto pr-1"},gi={class:"col-span-7"},fi=["onUpdate:modelValue"],mi=["value"],yi={class:"col-span-3"},ki=["onUpdate:modelValue"],xi={class:"col-span-2 flex items-center justify-end"},_i=["onClick"],hi={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},wi=["disabled"],Ti={__name:"Index",props:{tenantId:{type:Number,default:0},warning:{type:String,default:null},googleMapsApiKey:{type:String,default:""}},setup(ba){const b=pl("toast"),kt=ba,It=yl(),At=V(()=>{var a,e;return((e=(a=It.props.auth)==null?void 0:a.user)==null?void 0:e.permissions)||[]}),ga=V(()=>{var a,e;return(((e=(a=It.props.auth)==null?void 0:a.user)==null?void 0:e.role)||"").toString().toLowerCase().trim()});function fa(a){const e=(a||"").toString().toLowerCase().trim();return e==="svp lapangan"?"svp_lapangan":e}function st(a){const e=fa(ga.value);return["admin","owner"].includes(e)||At.value.includes("manage fiber")?!0:At.value.includes(a)}const jt=V(()=>st("view fiber")),Z=V(()=>st("create fiber")),X=V(()=>st("edit fiber")),ie=V(()=>st("delete fiber")),Ue=f(!1),ot=f(""),Me=f({cables:0,points:0,breaks_total:0,breaks_open:0}),B=f([]),K=f([]),de=f([]),ye=f([]),Ge=f([]),$=f("cables"),Re=f(!0),De=f(!0),Be=f(!0),Ne=f(null),ae=f(null),Pe=f(null),Fe=f(!1),ue=f(!1),T=f(""),Y=f("ALL"),ve=f(null),rt=f([]),Vt=V(()=>{const a=new Set;return(rt.value||[]).forEach(e=>{const s=Number(e);Number.isFinite(s)&&s>0&&a.add(s)}),a});async function z(a,e={}){const s=await fetch(a,{credentials:"same-origin",headers:{Accept:"application/json",...e.headers||{}},...e}),o=await s.text();let r=null;try{r=o?JSON.parse(o):null}catch{r=null}return{ok:s.ok,status:s.status,data:r,text:o}}async function D(){var a,e,s,o,r,v,c,u,k,P,L,I;if(jt.value){Ue.value=!0,ot.value="";try{const[U,fe]=await Promise.all([z("/api/v1/fiber/map-data"),z("/api/v1/fiber/summary")]);if(!U.ok){const G=((a=U.data)==null?void 0:a.message)||`Gagal memuat data fiber (HTTP ${U.status}).`;throw new Error(G)}fe.ok?Me.value=((e=fe.data)==null?void 0:e.data)||Me.value:Me.value={cables:0,points:0,breaks_total:0,breaks_open:0},B.value=((o=(s=U.data)==null?void 0:s.data)==null?void 0:o.cables)||[],K.value=((v=(r=U.data)==null?void 0:r.data)==null?void 0:v.points)||[],de.value=((u=(c=U.data)==null?void 0:c.data)==null?void 0:u.breaks)||[],ye.value=((P=(k=U.data)==null?void 0:k.data)==null?void 0:P.ports)||[],Ge.value=((I=(L=U.data)==null?void 0:L.data)==null?void 0:I.links)||[],zt(),Sa()}catch(U){console.error("Fiber: loadAll failed",U),ot.value=U&&U.message?U.message:"Gagal memuat data fiber."}finally{Ue.value=!1}}}const xt=f(null);let C=null,Q=null,_t=new Map,ht=new Map,wt=new Map,Te={markers:[],polyline:null},Gt=!1;const Se=f(""),pe=f("roadmap"),Ke={roadmap:{label:"Roadmap",mapTypeId:"roadmap"},satellite:{label:"Satelit",mapTypeId:"satellite"},hybrid:{label:"Hybrid",mapTypeId:"hybrid"}};function ma(a){var s;const e=(a||"").toString().trim();return e?(s=window.google)!=null&&s.maps?Promise.resolve():(window.__fiberGoogleMapsPromise||(window.__fiberGoogleMapsPromise=new Promise((o,r)=>{const v=document.createElement("script"),c=new URLSearchParams({key:e,v:"weekly"});v.src=`https://maps.googleapis.com/maps/api/js?${c.toString()}`,v.async=!0,v.defer=!0,v.onload=()=>o(),v.onerror=()=>r(new Error("Gagal memuat Google Maps. Cek API key/koneksi.")),document.head.appendChild(v)})),window.__fiberGoogleMapsPromise):Promise.reject(new Error("Google Maps API key belum di-set."))}function ya(){var e;if(!C||!((e=window.google)!=null&&e.maps))return;const a=Ke[pe.value]||Ke.roadmap;try{C.setMapTypeId(a.mapTypeId)}catch{}}function Rt(){var a;if(!(!C||!((a=window.google)!=null&&a.maps)))try{window.google.maps.event.trigger(C,"resize")}catch{}}function Dt(){var a;Nt();try{(Te.markers||[]).forEach(e=>{try{e.setMap(null)}catch{}})}catch{}Te.markers=[];try{(a=Te.polyline)==null||a.setMap(null)}catch{}Te.polyline=null}function Ie(a){try{Array.from(a.values()).forEach(e=>{try{e.setMap(null)}catch{}})}catch{}try{a.clear()}catch{}}function ka(){var e;if(!((e=window.google)!=null&&e.maps)||!xt.value)return;const a=Ke[pe.value]||Ke.roadmap;C=new window.google.maps.Map(xt.value,{center:{lat:-2.5489,lng:118.0149},zoom:5,mapTypeId:a.mapTypeId,clickableIcons:!1,fullscreenControl:!1,streetViewControl:!1,mapTypeControl:!1}),Q=new window.google.maps.InfoWindow,C.addListener("click",wa)}function xa(){var a;if(!((a=window.google)!=null&&a.maps)){C=null,Q=null;return}try{window.google.maps.event.clearInstanceListeners(C)}catch{}try{Q==null||Q.close()}catch{}Dt(),Ie(_t),Ie(ht),Ie(wt),C=null,Q=null}const N=f(null),ee=f(null),te=f(!0),ke=f(!1);let ce=[],Ct=null,He=[];function _a(a){var e,s,o,r;if(a){try{if(typeof a.remove=="function"){a.remove();return}}catch{}try{(r=(o=(s=(e=window.google)==null?void 0:e.maps)==null?void 0:s.event)==null?void 0:o.removeListener)==null||r.call(o,a)}catch{}}}function Nt(){try{(He||[]).forEach(a=>_a(a))}catch{}He=[]}function xe(a){const e=Number(a);return Number.isFinite(e)?Math.round(e*1e7)/1e7:null}function ha(){var a;return(a=window.google)!=null&&a.maps?(Ct||(Ct=new window.google.maps.DirectionsService),Ct):null}async function Bt(a,e){const s=ha();if(!s)throw new Error("Google Maps Directions belum siap.");const o={origin:a,destination:e,travelMode:window.google.maps.TravelMode.DRIVING};return new Promise((r,v)=>{try{s.route(o,(c,u)=>{var L;if(u!=="OK"||!((L=c==null?void 0:c.routes)!=null&&L[0])){v(new Error(`Gagal ambil rute jalan (${u||"UNKNOWN"}).`));return}const P=(c.routes[0].overview_path||[]).map(I=>({lat:xe(I.lat()),lng:xe(I.lng())})).filter(I=>Number.isFinite(I.lat)&&Number.isFinite(I.lng));r(P)})}catch(c){v(c)}})}async function wa(a){if(!(a!=null&&a.latLng))return;const e=xe(a.latLng.lat()),s=xe(a.latLng.lng());if(N.value==="pickPoint"){h.value.latitude=e,h.value.longitude=s,b&&b.success("Lokasi titik dipilih dari peta."),F();return}if(N.value==="pickBreak"){x.value.latitude=e,x.value.longitude=s,b&&b.success("Lokasi putus dipilih dari peta."),F();return}if(N.value==="drawCable"){const o=Array.isArray(p.value.path)?p.value.path:[];if(!Number.isFinite(e)||!Number.isFinite(s))return;if(o.length<1||!te.value){ce.push(o.length),o.push({lat:e,lng:s}),p.value.path=o,le();return}if(ke.value)return;ce.push(o.length),ke.value=!0;try{const r=o[o.length-1],v=await Bt({lat:Number(r==null?void 0:r.lat),lng:Number(r==null?void 0:r.lng)},{lat:e,lng:s});if(Array.isArray(v)&&v.length>=2){const c=v.slice(1);p.value.path=o.concat(c)}else o.push({lat:e,lng:s}),p.value.path=o}catch(r){o.push({lat:e,lng:s}),p.value.path=o,b&&b.error((r==null?void 0:r.message)||"Gagal mengikuti jalan. Pakai garis lurus.")}finally{ke.value=!1,le()}}}function F(a={}){const e=(a==null?void 0:a.reopen)!==!1,s=e?ee.value:null;Nt(),N.value=null,ee.value=null,e&&s&&(s==="cable"&&(J.value=!0),s==="point"&&(oe.value=!0),s==="break"&&(re.value=!0)),le()}function Ca(a){const e=document.createElement("div");return e.className="text-sm",(a||[]).forEach(s=>{const o=document.createElement("div");o.textContent=String(s??""),e.appendChild(o)}),e}function Pt(a,e,s=null){if(!C||!Q)return;const o=(e||[]).filter(Boolean);if(!(o.length<1)){try{Q.close()}catch{}Q.setContent(Ca(o));try{if(s){Q.open({map:C,anchor:s});return}a&&Q.setPosition(a),Q.open({map:C})}catch{}}}const Kt=V(()=>{const a=new Map;return(K.value||[]).forEach(e=>{const s=Number((e==null?void 0:e.id)||0);s>0&&a.set(s,e)}),a}),Ht=V(()=>{const a=new Map;return(B.value||[]).forEach(e=>{const s=Number((e==null?void 0:e.id)||0);s>0&&a.set(s,e)}),a});function H(a){const e=Number(a||0);if(!e)return null;const s=Kt.value.get(e);return s?String(s.name||""):null}function Jt(a){const e=Number(a||0);if(!e)return null;const s=Kt.value.get(e);if(!s)return null;const o=xe(Number(s==null?void 0:s.latitude)),r=xe(Number(s==null?void 0:s.longitude));return!Number.isFinite(o)||!Number.isFinite(r)?null:{lat:o,lng:r}}function W(a){const e=Number(a||0);if(!e)return null;const s=Ht.value.get(e);return s?String(s.name||""):null}function Na(a){const e=String(a||"").toUpperCase();return e==="OPEN"?{stroke:"#dc2626",fill:"#ef4444"}:e==="IN_PROGRESS"?{stroke:"#b45309",fill:"#f59e0b"}:e==="FIXED"?{stroke:"#047857",fill:"#10b981"}:{stroke:"#64748b",fill:"#94a3b8"}}function zt(){var a;!C||!((a=window.google)!=null&&a.maps)||(nt(),Wt(),qt(),le())}function nt(){var a;!C||!((a=window.google)!=null&&a.maps)||(Ie(_t),Re.value&&(B.value||[]).forEach(e=>{const s=Array.isArray(e==null?void 0:e.path)?e.path:null;if(!s||s.length<2)return;const o=s.map(G=>({lat:Number(G==null?void 0:G.lat),lng:Number(G==null?void 0:G.lng)})).filter(G=>Number.isFinite(G.lat)&&Number.isFinite(G.lng));if(o.length<2)return;const r=Number(e==null?void 0:e.id)===Number(Ne.value||0),v=Vt.value.size>0,c=Vt.value.has(Number(e==null?void 0:e.id)),u=((e==null?void 0:e.map_color)||"#2563eb").toString(),k=r?6:4,P=c?Math.max(k,6):k,L=v?c?1:.25:.9,I=new window.google.maps.Polyline({path:o,strokeColor:u,strokeWeight:P,strokeOpacity:L,clickable:!0});I.setMap(C),_t.set(Number(e==null?void 0:e.id)||0,I);const U=H(e==null?void 0:e.from_point_id)||"-",fe=H(e==null?void 0:e.to_point_id)||"-";I.addListener("click",G=>{Xt(e,{zoom:!1,panel:"open"}),Pt((G==null?void 0:G.latLng)||null,[`Kabel: ${(e==null?void 0:e.name)||"-"}`,e!=null&&e.code?`Kode: ${e.code}`:null,e!=null&&e.cable_type?`Tipe: ${e.cable_type}`:null,e!=null&&e.core_count?`Core: ${e.core_count}`:null,`Dari: ${U}`,`Ke: ${fe}`])})}))}function Wt(){var a;!C||!((a=window.google)!=null&&a.maps)||(Ie(ht),De.value&&(K.value||[]).forEach(e=>{const s=Number(e==null?void 0:e.latitude),o=Number(e==null?void 0:e.longitude);if(!Number.isFinite(s)||!Number.isFinite(o))return;const r=Number(e==null?void 0:e.id)===Number(ae.value||0),v=new window.google.maps.Marker({position:{lat:s,lng:o},map:C,title:((e==null?void 0:e.name)||"").toString(),clickable:!0,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:r?7:6,fillColor:"#14b8a6",fillOpacity:.9,strokeColor:"#0f766e",strokeWeight:2}});ht.set(Number(e==null?void 0:e.id)||0,v),v.addListener("click",()=>{Yt(e,{zoom:!1,panel:"open"}),Pt(v.getPosition(),[`Titik: ${(e==null?void 0:e.name)||"-"}`,e!=null&&e.point_type?`Tipe: ${e.point_type}`:null,`Koordinat: ${s}, ${o}`],v)})}))}function qt(){var a;!C||!((a=window.google)!=null&&a.maps)||(Ie(wt),Be.value&&(de.value||[]).forEach(e=>{const s=Number(e==null?void 0:e.latitude),o=Number(e==null?void 0:e.longitude);if(!Number.isFinite(s)||!Number.isFinite(o))return;const r=Na(e==null?void 0:e.status),v=Number(e==null?void 0:e.id)===Number(Pe.value||0),c=new window.google.maps.Marker({position:{lat:s,lng:o},map:C,title:`PUTUS: ${String((e==null?void 0:e.status)||"OPEN").toUpperCase()}`,clickable:!0,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:v?8:7,fillColor:r.fill,fillOpacity:.9,strokeColor:r.stroke,strokeWeight:2}});wt.set(Number(e==null?void 0:e.id)||0,c),c.addListener("click",()=>{Qt(e,{zoom:!1,panel:"open"});const u=W(e==null?void 0:e.cable_id)||(e!=null&&e.cable_id?`#${e.cable_id}`:"-"),k=H(e==null?void 0:e.point_id)||(e!=null&&e.point_id?`#${e.point_id}`:"-");Pt(c.getPosition(),[`PUTUS: ${String((e==null?void 0:e.status)||"OPEN").toUpperCase()}`,`Kabel: ${u}`,`Titik: ${k}`,e!=null&&e.severity?`Severity: ${e.severity}`:null],c)})}))}function Pa(a){var e,s,o;try{const r=(e=a==null?void 0:a.getPath)==null?void 0:e.call(a);if(!r||typeof r.getLength!="function")return;const v=[];for(let c=0;c<r.getLength();c+=1){const u=r.getAt(c),k=xe((s=u==null?void 0:u.lat)==null?void 0:s.call(u)),P=xe((o=u==null?void 0:u.lng)==null?void 0:o.call(u));!Number.isFinite(k)||!Number.isFinite(P)||v.push({lat:k,lng:P})}p.value.path=v}catch{}}function Ta(a){var o,r;if(Nt(),!a||!((o=window.google)!=null&&o.maps))return;const e=(r=a.getPath)==null?void 0:r.call(a);if(!e||typeof e.addListener!="function")return;const s=()=>Pa(a);He.push(e.addListener("insert_at",s)),He.push(e.addListener("set_at",s)),He.push(e.addListener("remove_at",s)),s()}function le(){var e;if(!C||!((e=window.google)!=null&&e.maps))return;Dt();const a=(s,o,r={})=>{if(!Number.isFinite(s)||!Number.isFinite(o))return;const v=new window.google.maps.Marker({position:{lat:s,lng:o},map:C,clickable:!1,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:Number(r.scale??6),fillColor:(r.fillColor||"#38bdf8").toString(),fillOpacity:Number(r.fillOpacity??.9),strokeColor:(r.strokeColor||"#0ea5e9").toString(),strokeWeight:Number(r.strokeWeight??2)}});Te.markers.push(v)};if((oe.value||N.value==="pickPoint")&&h.value.latitude!==null&&h.value.longitude!==null){const s=Number(h.value.latitude),o=Number(h.value.longitude);Number.isFinite(s)&&Number.isFinite(o)&&a(s,o,{scale:7,strokeColor:"#0ea5e9",fillColor:"#38bdf8",fillOpacity:.85})}if((re.value||N.value==="pickBreak")&&x.value.latitude!==null&&x.value.longitude!==null){const s=Number(x.value.latitude),o=Number(x.value.longitude);Number.isFinite(s)&&Number.isFinite(o)&&a(s,o,{scale:8,strokeColor:"#f97316",fillColor:"#fb923c",fillOpacity:.85})}if((J.value||N.value==="drawCable"||N.value==="editCable")&&Array.isArray(p.value.path)&&p.value.path.length>0){const s=N.value==="editCable",o=p.value.path.map(r=>({lat:Number(r==null?void 0:r.lat),lng:Number(r==null?void 0:r.lng)})).filter(r=>Number.isFinite(r.lat)&&Number.isFinite(r.lng));if(s||o.forEach(r=>{a(r.lat,r.lng,{scale:3,strokeColor:"#1d4ed8",fillColor:"#60a5fa",fillOpacity:.95})}),o.length>=2){const r={path:"M 0,-1 0,1",strokeOpacity:1,strokeColor:"#1d4ed8",scale:3};Te.polyline=new window.google.maps.Polyline({path:o,strokeColor:"#1d4ed8",strokeOpacity:s?.85:0,strokeWeight:s?4:0,icons:s?[]:[{icon:r,offset:"0",repeat:"12px"}],clickable:s,editable:s,map:C}),s&&Ta(Te.polyline)}}}function Sa(){var s;if(!C||Gt||!((s=window.google)!=null&&s.maps))return;const a=new window.google.maps.LatLngBounds;let e=!1;try{Re.value&&(B.value||[]).forEach(o=>{const r=Array.isArray(o==null?void 0:o.path)?o.path:null;!r||r.length<1||r.forEach(v=>{const c=Number(v==null?void 0:v.lat),u=Number(v==null?void 0:v.lng);!Number.isFinite(c)||!Number.isFinite(u)||(a.extend({lat:c,lng:u}),e=!0)})})}catch{}try{De.value&&(K.value||[]).forEach(o=>{const r=Number(o==null?void 0:o.latitude),v=Number(o==null?void 0:o.longitude);!Number.isFinite(r)||!Number.isFinite(v)||(a.extend({lat:r,lng:v}),e=!0)})}catch{}try{Be.value&&(de.value||[]).forEach(o=>{const r=Number(o==null?void 0:o.latitude),v=Number(o==null?void 0:o.longitude);!Number.isFinite(r)||!Number.isFinite(v)||(a.extend({lat:r,lng:v}),e=!0)})}catch{}if(e)try{C.fitBounds(a),Gt=!0}catch{}}function Ea(a){const e=String(a||"OPEN").toUpperCase();return e==="IN_PROGRESS"?"IN PROGRESS":e}function Zt(a){if(!a)return"";const e=new Date(a);if(!Number.isFinite(e.getTime()))return"";const s=o=>String(o).padStart(2,"0");return`${e.getFullYear()}-${s(e.getMonth()+1)}-${s(e.getDate())}T${s(e.getHours())}:${s(e.getMinutes())}`}function _e(a,e,s=17){var o;if(!(!C||!((o=window.google)!=null&&o.maps)||!Number.isFinite(a)||!Number.isFinite(e))){try{C.panTo({lat:a,lng:e})}catch{}if(Number.isFinite(Number(s)))try{C.setZoom(Number(s))}catch{}}}function La(){try{return window.innerWidth<1024}catch{return!1}}function Tt(a){La()&&(a==="open"&&(ue.value=!0),a==="close"&&(ue.value=!1))}function Oa(a){var v;if(!C||!((v=window.google)!=null&&v.maps))return;const e=typeof a=="object"&&a?a:Ht.value.get(Number(a||0)),s=Array.isArray(e==null?void 0:e.path)?e.path:null;if(!s||s.length<1)return;const o=new window.google.maps.LatLngBounds;let r=!1;if(s.forEach(c=>{const u=Number(c==null?void 0:c.lat),k=Number(c==null?void 0:c.lng);!Number.isFinite(u)||!Number.isFinite(k)||(o.extend({lat:u,lng:k}),r=!0)}),!!r)try{C.fitBounds(o,60)}catch{try{C.fitBounds(o)}catch{}}}function Xt(a,e={}){Ne.value=(a==null?void 0:a.id)??null,ae.value=null,Pe.value=null,$.value="cables",nt(),e.zoom!==!1&&Oa(a),e.panel&&Tt(e.panel)}function Yt(a,e={}){ae.value=(a==null?void 0:a.id)??null,Ne.value=null,Pe.value=null,$.value="points",Wt(),e.zoom!==!1&&_e(Number(a==null?void 0:a.latitude),Number(a==null?void 0:a.longitude),17),e.panel&&Tt(e.panel)}function Qt(a,e={}){Pe.value=(a==null?void 0:a.id)??null,Ne.value=null,ae.value=null,$.value="breaks",qt(),e.zoom!==!1&&_e(Number(a==null?void 0:a.latitude),Number(a==null?void 0:a.longitude),17),e.panel&&Tt(e.panel)}function $a(a,e){const s=Number(a==null?void 0:a.lat),o=Number(a==null?void 0:a.lng),r=Number(e==null?void 0:e.lat),v=Number(e==null?void 0:e.lng);if(!Number.isFinite(s)||!Number.isFinite(o)||!Number.isFinite(r)||!Number.isFinite(v))return 0;const c=6371e3,u=fe=>Number(fe)*Math.PI/180,k=u(r-s),P=u(v-o),L=Math.sin(k/2),I=Math.sin(P/2),U=L*L+Math.cos(u(s))*Math.cos(u(r))*I*I;return 2*c*Math.asin(Math.min(1,Math.sqrt(U)))}function St(a){const e=Array.isArray(a)?a:[];if(e.length<2)return 0;let s=0;for(let o=1;o<e.length;o+=1)s+=$a(e[o-1],e[o]);return s}function ea(a){const e=Number(a);if(!Number.isFinite(e)||e<=0)return"-";if(e<1e3)return`${Math.round(e)} m`;const s=e/1e3;return`${s.toFixed(s<10?2:1)} km`}function it(){var a;return Se.value?(b&&b.error(Se.value),!1):!C||!((a=window.google)!=null&&a.maps)?(b&&b.error("Peta belum siap."),!1):!0}const J=f(!1),Ae=f("create"),ut=f(!1),se=f({}),he=f(!0),we=f(!1),p=f({id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],length_m:"",notes:""}),Et=V(()=>Math.round(St(p.value.path)));function ta(){p.value={id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],length_m:"",notes:""},se.value={},he.value=!0,we.value=!1}function Ua(){Z.value&&(ta(),Ae.value="create",ce=[],he.value=!0,we.value=!0,J.value=!0,ee.value=null,F({reopen:!1}))}function Ma(a){if(!X.value)return;ta(),Ae.value="edit",ce=[],p.value={id:a.id,name:a.name||"",code:a.code||"",cable_type:a.cable_type||"",core_count:a.core_count??"",map_color:a.map_color||"#2563eb",from_point_id:a.from_point_id??"",to_point_id:a.to_point_id??"",path:Array.isArray(a.path)?a.path.slice():[],length_m:a.length_m??"",notes:a.notes||""},he.value=!(p.value.length_m!==""&&p.value.length_m!==null&&p.value.length_m!==void 0),we.value=!1,J.value=!0,ee.value=null,F({reopen:!1});const e=(p.value.path||[])[0];e&&Number.isFinite(Number(e.lat))&&Number.isFinite(Number(e.lng))&&_e(Number(e.lat),Number(e.lng),16)}function Fa(a){var r;if(!C||!((r=window.google)!=null&&r.maps))return;const e=Array.isArray(a)?a:[];if(e.length<1)return;const s=new window.google.maps.LatLngBounds;let o=!1;if(e.forEach(v=>{const c=Number(v==null?void 0:v.lat),u=Number(v==null?void 0:v.lng);!Number.isFinite(c)||!Number.isFinite(u)||(s.extend({lat:c,lng:u}),o=!0)}),!!o)try{C.fitBounds(s)}catch{}}async function aa(a={}){var P;const e=(a==null?void 0:a.force)===!0,s=Number(p.value.from_point_id||0),o=Number(p.value.to_point_id||0);if(!s||!o)return b&&b.error("Pilih Dari Titik dan Ke Titik dulu."),!1;if(s===o)return b&&b.error("Dari Titik dan Ke Titik tidak boleh sama."),!1;const r=Jt(s),v=Jt(o);if(!r||!v)return b&&b.error("Koordinat titik belum lengkap. Isi latitude/longitude di data Titik."),!1;const c=Array.isArray(p.value.path)&&p.value.path.length>=2;if(c&&!e||c&&e&&!confirm("Jalur sudah ada. Timpa jalur dengan jalur otomatis dari titik?"))return!1;let u=[];const k=!!te.value;if(k&&((P=window.google)!=null&&P.maps))try{u=await Bt(r,v)}catch(L){u=[],b&&b.error((L==null?void 0:L.message)||"Gagal mengikuti jalan. Pakai garis lurus.")}return(!Array.isArray(u)||u.length<2)&&(u=[r,v]),ce=[],p.value.path=u,le(),Fa(u),he.value=!0,p.value.length_m=Math.round(St(u)),b&&b.success(k?"Jalur otomatis dibuat (ikut jalan).":"Jalur otomatis dibuat."),!0}async function Ia(){var r,v,c;ut.value=!0,se.value={};const a={name:p.value.name,code:p.value.code||null,cable_type:p.value.cable_type||null,core_count:p.value.core_count!==""?Number(p.value.core_count):null,map_color:p.value.map_color||null,from_point_id:p.value.from_point_id!==""?Number(p.value.from_point_id):null,to_point_id:p.value.to_point_id!==""?Number(p.value.to_point_id):null,path:Array.isArray(p.value.path)&&p.value.path.length>=2?p.value.path:null,length_m:p.value.length_m!==""&&p.value.length_m!==null&&p.value.length_m!==void 0?Number(p.value.length_m):null,notes:p.value.notes||null},e=Ae.value==="edit"&&p.value.id,s=e?`/api/v1/fiber/cables/${p.value.id}`:"/api/v1/fiber/cables",o=e?"PUT":"POST";try{const u=await z(s,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!u.ok)throw u.status===422&&((r=u.data)!=null&&r.errors)?(se.value=u.data.errors,new Error(((v=u.data)==null?void 0:v.message)||"Validasi gagal.")):new Error(((c=u.data)==null?void 0:c.message)||`Gagal menyimpan kabel (HTTP ${u.status}).`);J.value=!1,F(),await D(),b&&b.success("Kabel tersimpan.")}catch(u){console.error("Fiber: saveCable failed",u),b&&b.error((u==null?void 0:u.message)||"Gagal menyimpan kabel.")}finally{ut.value=!1}}async function Aa(a){var s;if(!(!ie.value||!confirm(`Hapus kabel "${(a==null?void 0:a.name)||""}"?`)))try{const o=await z(`/api/v1/fiber/cables/${a.id}`,{method:"DELETE"});if(!o.ok)throw new Error(((s=o.data)==null?void 0:s.message)||`Gagal hapus kabel (HTTP ${o.status}).`);b&&b.success("Kabel dihapus."),Number(Ne.value)===Number(a.id)&&(Ne.value=null),await D()}catch(o){console.error("Fiber: deleteCable failed",o),b&&b.error((o==null?void 0:o.message)||"Gagal hapus kabel.")}}function ja(){J.value&&it()&&(ee.value="cable",J.value=!1,ce=[],N.value="drawCable",le(),b&&b.info(te.value?"Mode gambar jalur aktif (ikut jalan): klik peta untuk set titik berikutnya, lalu klik Selesai untuk kembali.":"Mode gambar jalur aktif: klik peta untuk menambah titik, lalu klik Selesai untuk kembali."))}function Va(){if(!J.value||!it())return;if((Array.isArray(p.value.path)?p.value.path:[]).length<2){b&&b.error("Jalur belum ada. Klik Gambar dulu minimal 2 titik.");return}ee.value="cable",J.value=!1,N.value="editCable",le(),b&&b.info("Mode edit jalur aktif: geser titik/segmen di peta, lalu klik Selesai untuk kembali.")}function la(){const a=Array.isArray(p.value.path)?p.value.path:[];if(a.length!==0){if(ce.length>0){const e=Number(ce.pop());Number.isFinite(e)&&e>=0?p.value.path=a.slice(0,e):(a.pop(),p.value.path=a)}else a.pop(),p.value.path=a;le()}}function Lt(){p.value.path=[],ce=[],le()}function Ga(){const a=Number(Et.value||0);if(!Number.isFinite(a)||a<=0){b&&b.error("Tidak ada jalur untuk dihitung.");return}p.value.length_m=Math.round(a),he.value=!0,b&&b.success("Panjang kabel diisi dari jalur.")}const oe=f(!1),dt=f("create"),vt=f(!1),be=f({}),h=f({id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""});function sa(){h.value={id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""},be.value={}}function Ra(){Z.value&&(sa(),dt.value="create",oe.value=!0,ee.value=null,F({reopen:!1}))}function Da(a){if(!X.value)return;sa(),dt.value="edit",h.value={id:a.id,name:a.name||"",point_type:a.point_type||"",latitude:a.latitude??null,longitude:a.longitude??null,address:a.address||"",notes:a.notes||""},oe.value=!0,ee.value=null,F({reopen:!1});const e=Number(h.value.latitude),s=Number(h.value.longitude);Number.isFinite(e)&&Number.isFinite(s)&&_e(e,s,17)}function Ba(){oe.value&&it()&&(ee.value="point",oe.value=!1,N.value="pickPoint",le(),b&&b.info("Klik peta untuk memilih lokasi titik."))}async function Ka(){var r,v,c;vt.value=!0,be.value={};const a={name:h.value.name,point_type:h.value.point_type||null,latitude:h.value.latitude,longitude:h.value.longitude,address:h.value.address||null,notes:h.value.notes||null},e=dt.value==="edit"&&h.value.id,s=e?`/api/v1/fiber/points/${h.value.id}`:"/api/v1/fiber/points",o=e?"PUT":"POST";try{const u=await z(s,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!u.ok)throw u.status===422&&((r=u.data)!=null&&r.errors)?(be.value=u.data.errors,new Error(((v=u.data)==null?void 0:v.message)||"Validasi gagal.")):new Error(((c=u.data)==null?void 0:c.message)||`Gagal menyimpan titik (HTTP ${u.status}).`);oe.value=!1,F(),await D(),b&&b.success("Titik tersimpan.")}catch(u){console.error("Fiber: savePoint failed",u),b&&b.error((u==null?void 0:u.message)||"Gagal menyimpan titik.")}finally{vt.value=!1}}async function Ha(a){var s;if(!(!ie.value||!confirm(`Hapus titik "${(a==null?void 0:a.name)||""}"?`)))try{const o=await z(`/api/v1/fiber/points/${a.id}`,{method:"DELETE"});if(!o.ok)throw new Error(((s=o.data)==null?void 0:s.message)||`Gagal hapus titik (HTTP ${o.status}).`);b&&b.success("Titik dihapus."),Number(ae.value)===Number(a.id)&&(ae.value=null),await D()}catch(o){console.error("Fiber: deletePoint failed",o),b&&b.error((o==null?void 0:o.message)||"Gagal hapus titik.")}}const re=f(!1),pt=f("create"),ct=f(!1),Ee=f({}),x=f({id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""});function oa(){x.value={id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""},Ee.value={}}function Ja(){Z.value&&(oa(),pt.value="create",re.value=!0,ee.value=null,F({reopen:!1}))}function za(a){if(!X.value)return;oa(),pt.value="edit",x.value={id:a.id,cable_id:a.cable_id??"",point_id:a.point_id??"",status:(a.status||"OPEN").toString().toUpperCase(),severity:a.severity||"",reported_at:Zt(a.reported_at),fixed_at:Zt(a.fixed_at),latitude:a.latitude??null,longitude:a.longitude??null,description:a.description||""},re.value=!0,ee.value=null,F({reopen:!1});const e=Number(x.value.latitude),s=Number(x.value.longitude);Number.isFinite(e)&&Number.isFinite(s)&&_e(e,s,17)}function Wa(){re.value&&it()&&(ee.value="break",re.value=!1,N.value="pickBreak",le(),b&&b.info("Klik peta untuk memilih lokasi putus."))}async function qa(){var r,v,c;ct.value=!0,Ee.value={};const a={cable_id:x.value.cable_id!==""?Number(x.value.cable_id):null,point_id:x.value.point_id!==""?Number(x.value.point_id):null,status:(x.value.status||"OPEN").toString().toUpperCase(),severity:x.value.severity||null,reported_at:x.value.reported_at||null,fixed_at:x.value.fixed_at||null,latitude:x.value.latitude,longitude:x.value.longitude,description:x.value.description||null},e=pt.value==="edit"&&x.value.id,s=e?`/api/v1/fiber/breaks/${x.value.id}`:"/api/v1/fiber/breaks",o=e?"PUT":"POST";try{const u=await z(s,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!u.ok)throw u.status===422&&((r=u.data)!=null&&r.errors)?(Ee.value=u.data.errors,new Error(((v=u.data)==null?void 0:v.message)||"Validasi gagal.")):new Error(((c=u.data)==null?void 0:c.message)||`Gagal menyimpan data putus (HTTP ${u.status}).`);re.value=!1,F(),await D(),b&&b.success("Data putus tersimpan.")}catch(u){console.error("Fiber: saveBreak failed",u),b&&b.error((u==null?void 0:u.message)||"Gagal menyimpan data putus.")}finally{ct.value=!1}}async function Za(a){var s;if(!(!ie.value||!confirm("Hapus data putus ini?")))try{const o=await z(`/api/v1/fiber/breaks/${a.id}`,{method:"DELETE"});if(!o.ok)throw new Error(((s=o.data)==null?void 0:s.message)||`Gagal hapus data putus (HTTP ${o.status}).`);b&&b.success("Data putus dihapus."),Number(Pe.value)===Number(a.id)&&(Pe.value=null),await D()}catch(o){console.error("Fiber: deleteBreak failed",o),b&&b.error((o==null?void 0:o.message)||"Gagal hapus data putus.")}}const Je=f({});function ra(a){var s;const e=String(Number(a||0));return!!((s=Je.value)!=null&&s[e])}async function Xa(a){var r,v,c;if(!X.value||!Z.value)return;const e=String((a==null?void 0:a.status)||"OPEN").toUpperCase();if(!["OPEN","IN_PROGRESS"].includes(e)){b&&b.info("Status putus sudah bukan OPEN/IN_PROGRESS.");return}if(!confirm("Selesaikan data putus ini? Sistem akan membuat titik JOINT_CLOSURE di lokasi putus dan mengubah status menjadi FIXED."))return;const o=String(Number((a==null?void 0:a.id)||0));Je.value={...Je.value||{},[o]:!0};try{const u=W(a==null?void 0:a.cable_id)||(a!=null&&a.cable_id?`Kabel #${a.cable_id}`:""),k=(u?`JC - ${u}`:`Joint Closure - Break #${(a==null?void 0:a.id)||""}`).slice(0,160),P=await z(`/api/v1/fiber/breaks/${a.id}/fix`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({joint_name:k,joint_type:"JOINT_CLOSURE",joint_notes:`Auto dari data putus #${(a==null?void 0:a.id)||""}`})});if(!P.ok)throw new Error(((r=P.data)==null?void 0:r.message)||`Gagal menyelesaikan putus (HTTP ${P.status}).`);await D();const L=((c=(v=P.data)==null?void 0:v.data)==null?void 0:c.joint_point)||null,I=Number(L==null?void 0:L.latitude),U=Number(L==null?void 0:L.longitude);Number.isFinite(I)&&Number.isFinite(U)&&_e(I,U,18),b&&b.success("Data putus diselesaikan. Titik Joint Closure dibuat.")}catch(u){console.error("Fiber: fixBreakWithJoint failed",u),b&&b.error((u==null?void 0:u.message)||"Gagal menyelesaikan putus.")}finally{const u={...Je.value||{}};delete u[o],Je.value=u}}const Le=f(!1),bt=f("create"),gt=f(!1),Oe=f({}),E=f({id:null,point_id:"",port_type:"OLT_PON",port_label:"",cable_id:"",core_no:"",notes:""});function na(){E.value={id:null,point_id:"",port_type:"OLT_PON",port_label:"",cable_id:"",core_no:"",notes:""},Oe.value={}}function Ya(){Z.value&&(na(),ae.value&&(E.value.point_id=String(ae.value)),bt.value="create",Le.value=!0)}function Qa(a){X.value&&(na(),bt.value="edit",E.value={id:a.id,point_id:a.point_id??"",port_type:a.port_type||"OLT_PON",port_label:a.port_label||"",cable_id:a.cable_id??"",core_no:a.core_no??"",notes:a.notes||""},Le.value=!0)}async function el(){var r,v,c;gt.value=!0,Oe.value={};const a={point_id:E.value.point_id!==""?Number(E.value.point_id):null,port_type:(E.value.port_type||"OLT_PON").toString().toUpperCase(),port_label:E.value.port_label||"",cable_id:E.value.cable_id!==""?Number(E.value.cable_id):null,core_no:E.value.core_no!==""?Number(E.value.core_no):null,notes:E.value.notes||null},e=bt.value==="edit"&&E.value.id,s=e?`/api/v1/fiber/ports/${E.value.id}`:"/api/v1/fiber/ports",o=e?"PUT":"POST";try{const u=await z(s,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!u.ok)throw u.status===422&&((r=u.data)!=null&&r.errors)?(Oe.value=u.data.errors,new Error(((v=u.data)==null?void 0:v.message)||"Validasi gagal.")):new Error(((c=u.data)==null?void 0:c.message)||`Gagal menyimpan port (HTTP ${u.status}).`);Le.value=!1,await D(),b&&b.success("Port tersimpan.")}catch(u){console.error("Fiber: savePort failed",u),b&&b.error((u==null?void 0:u.message)||"Gagal menyimpan port.")}finally{gt.value=!1}}async function tl(a){var s;if(!(!ie.value||!confirm(`Hapus port "${(a==null?void 0:a.port_label)||""}"?`)))try{const o=await z(`/api/v1/fiber/ports/${a.id}`,{method:"DELETE"});if(!o.ok)throw new Error(((s=o.data)==null?void 0:s.message)||`Gagal hapus port (HTTP ${o.status}).`);b&&b.success("Port dihapus."),await D()}catch(o){console.error("Fiber: deletePort failed",o),b&&b.error((o==null?void 0:o.message)||"Gagal hapus port.")}}const Ce=f(!1),ft=f("create"),mt=f(!1),ge=f({}),ze=f(8),y=f({id:null,point_id:"",link_type:"SPLICE",from_cable_id:"",from_core_no:"",to_cable_id:"",to_core_no:"",split_group:"",outputs:[],loss_db:"",notes:""}),yt=V(()=>{const a=Array.isArray(Ge.value)?Ge.value:[],e=[],s={};return a.forEach(o=>{const r=((o==null?void 0:o.link_type)||"").toString().toUpperCase(),v=((o==null?void 0:o.split_group)||"").toString();if(r==="SPLIT"&&v){const c=`${Number(o.point_id)||0}|${v}`;s[c]||(s[c]={kind:"SPLIT_GROUP",id:o.id,point_id:o.point_id,link_type:"SPLIT",split_group:v,from_cable_id:o.from_cable_id,from_core_no:o.from_core_no,loss_db:o.loss_db??null,notes:o.notes||"",outputs:[],link_ids:[]}),s[c].outputs.push({to_cable_id:o.to_cable_id,to_core_no:o.to_core_no}),s[c].link_ids.push(o.id);return}e.push({kind:"LINK",...o||{}})}),Object.values(s).forEach(o=>{o.outputs=(o.outputs||[]).filter(r=>(r==null?void 0:r.to_cable_id)&&(r==null?void 0:r.to_core_no)),e.push(o)}),e.sort((o,r)=>{const v=Number((o==null?void 0:o.point_id)||0),c=Number((r==null?void 0:r.point_id)||0);if(v!==c)return v-c;const u=((o==null?void 0:o.link_type)||"").toString(),k=((r==null?void 0:r.link_type)||"").toString();return u.localeCompare(k)}),e}),We=V(()=>(T.value||"").toString().toLowerCase().trim()),qe=V(()=>{const a=String($.value||"cables");return a==="cables"?"Cari kabel (nama/kode/tipe/titik)...":a==="points"?"Cari titik (nama/tipe)...":a==="ports"?"Cari port (label/tipe/kabel/titik)...":a==="links"?"Cari sambungan (titik/kabel/core)...":a==="breaks"?"Cari putus (kabel/titik/status)...":"Cari..."});function S(a,e){return(a||"").toString().toLowerCase().includes(e)}const Ot=V(()=>{const a=Array.isArray(B.value)?B.value:[],e=We.value;return e?a.filter(s=>{const o=H(s==null?void 0:s.from_point_id)||"",r=H(s==null?void 0:s.to_point_id)||"";return S(s==null?void 0:s.name,e)||S(s==null?void 0:s.code,e)||S(s==null?void 0:s.cable_type,e)||S(o,e)||S(r,e)}):a}),$t=V(()=>{const a=Array.isArray(K.value)?K.value:[],e=We.value;return e?a.filter(s=>S(s==null?void 0:s.name,e)||S(s==null?void 0:s.point_type,e)||S(s==null?void 0:s.address,e)||S(s==null?void 0:s.notes,e)):a}),Ut=V(()=>{const a=Array.isArray(ye.value)?ye.value:[],e=We.value;return e?a.filter(s=>{const o=H(s==null?void 0:s.point_id)||"",r=W(s==null?void 0:s.cable_id)||"";return S(s==null?void 0:s.port_label,e)||S(s==null?void 0:s.port_type,e)||S(o,e)||S(r,e)||S(String((s==null?void 0:s.core_no)??""),e)}):a}),Mt=V(()=>{const a=Array.isArray(yt.value)?yt.value:[],e=We.value;return e?a.filter(s=>{const o=H(s==null?void 0:s.point_id)||"",r=W(s==null?void 0:s.from_cable_id)||"",v=W(s==null?void 0:s.to_cable_id)||"",c=((s==null?void 0:s.link_type)||"").toString().toUpperCase();let u="";return(s==null?void 0:s.kind)==="SPLIT_GROUP"&&(u=((s==null?void 0:s.outputs)||[]).map(k=>`${W(k==null?void 0:k.to_cable_id)||""}:${(k==null?void 0:k.to_core_no)??""}`).join(" ")),S(c,e)||S(o,e)||S(r,e)||S(v,e)||S(s==null?void 0:s.split_group,e)||S(String((s==null?void 0:s.from_core_no)??""),e)||S(String((s==null?void 0:s.to_core_no)??""),e)||S(u,e)}):a}),Ft=V(()=>{const a=Array.isArray(de.value)?de.value:[],e=We.value,s=String(Y.value||"ALL").toUpperCase();return a.filter(o=>{const r=String((o==null?void 0:o.status)||"OPEN").toUpperCase();if(s!=="ALL"&&r!==s)return!1;if(!e)return!0;const v=W(o==null?void 0:o.cable_id)||"",c=H(o==null?void 0:o.point_id)||"";return S(r,e)||S(o==null?void 0:o.severity,e)||S(v,e)||S(c,e)||S(o==null?void 0:o.description,e)})});function ia(){y.value={id:null,point_id:"",link_type:"SPLICE",from_cable_id:"",from_core_no:"",to_cable_id:"",to_core_no:"",split_group:"",outputs:[],loss_db:"",notes:""},ge.value={},ze.value=8}function al(a){const e=Math.max(1,Math.min(64,Number(a)||1));y.value.outputs=Array.from({length:e}).map(()=>({to_cable_id:"",to_core_no:""}))}function ll(){const a=Array.isArray(y.value.outputs)?y.value.outputs:[];a.push({to_cable_id:"",to_core_no:""}),y.value.outputs=a}function sl(a){const e=Array.isArray(y.value.outputs)?y.value.outputs:[];a<0||a>=e.length||(e.splice(a,1),y.value.outputs=e)}function ol(){Z.value&&(ia(),ae.value&&(y.value.point_id=String(ae.value)),ft.value="create",Ce.value=!0)}function rl(a){if(X.value){if(ia(),ft.value="edit",(a==null?void 0:a.kind)==="SPLIT_GROUP"){y.value={id:a.id,point_id:a.point_id??"",link_type:"SPLIT",from_cable_id:a.from_cable_id??"",from_core_no:a.from_core_no??"",to_cable_id:"",to_core_no:"",split_group:a.split_group||"",outputs:(a.outputs||[]).map(e=>({to_cable_id:e.to_cable_id??"",to_core_no:e.to_core_no??""})),loss_db:a.loss_db??"",notes:a.notes||""},ze.value=(y.value.outputs||[]).length||8,Ce.value=!0;return}y.value={id:a.id,point_id:a.point_id??"",link_type:(a.link_type||"SPLICE").toString().toUpperCase(),from_cable_id:a.from_cable_id??"",from_core_no:a.from_core_no??"",to_cable_id:a.to_cable_id??"",to_core_no:a.to_core_no??"",split_group:a.split_group||"",outputs:[],loss_db:a.loss_db??"",notes:a.notes||""},Ce.value=!0}}async function nl(){var v,c,u;mt.value=!0,ge.value={};const a=(y.value.link_type||"SPLICE").toString().toUpperCase(),e={point_id:y.value.point_id!==""?Number(y.value.point_id):null,link_type:a,from_cable_id:y.value.from_cable_id!==""?Number(y.value.from_cable_id):null,from_core_no:y.value.from_core_no!==""?Number(y.value.from_core_no):null,split_group:y.value.split_group||null,loss_db:y.value.loss_db!==""?Number(y.value.loss_db):null,notes:y.value.notes||null};if(a==="SPLIT"){const k=Array.isArray(y.value.outputs)?y.value.outputs:[];e.outputs=k.map(P=>({to_cable_id:P.to_cable_id!==""?Number(P.to_cable_id):null,to_core_no:P.to_core_no!==""?Number(P.to_core_no):null})).filter(P=>P.to_cable_id&&P.to_core_no)}else e.to_cable_id=y.value.to_cable_id!==""?Number(y.value.to_cable_id):null,e.to_core_no=y.value.to_core_no!==""?Number(y.value.to_core_no):null;const s=ft.value==="edit"&&y.value.id,o=s?`/api/v1/fiber/links/${y.value.id}`:"/api/v1/fiber/links",r=s?"PUT":"POST";try{const k=await z(o,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!k.ok)throw k.status===422&&((v=k.data)!=null&&v.errors)?(ge.value=k.data.errors,new Error(((c=k.data)==null?void 0:c.message)||"Validasi gagal.")):new Error(((u=k.data)==null?void 0:u.message)||`Gagal menyimpan sambungan (HTTP ${k.status}).`);Ce.value=!1,await D(),b&&b.success("Sambungan tersimpan.")}catch(k){console.error("Fiber: saveLink failed",k),b&&b.error((k==null?void 0:k.message)||"Gagal menyimpan sambungan.")}finally{mt.value=!1}}async function il(a){var o;if(!ie.value)return;const e=(a==null?void 0:a.kind)==="SPLIT_GROUP"?`splitter "${(a==null?void 0:a.split_group)||""}"`:"sambungan ini";if(confirm(`Hapus ${e}?`))try{const r=await z(`/api/v1/fiber/links/${a.id}`,{method:"DELETE"});if(!r.ok)throw new Error(((o=r.data)==null?void 0:o.message)||`Gagal hapus sambungan (HTTP ${r.status}).`);b&&b.success("Sambungan dihapus."),await D()}catch(r){console.error("Fiber: deleteLink failed",r),b&&b.error((r==null?void 0:r.message)||"Gagal hapus sambungan.")}}const Ze=f(""),je=f(!1),Ve=f(""),$e=f(null),ul=V(()=>(ye.value||[]).filter(a=>((a==null?void 0:a.port_type)||"").toString().toUpperCase()==="OLT_PON"));function dl(){ve.value=null,Ve.value="",$e.value=null,rt.value=[],nt()}async function vl(){var a,e,s,o,r,v;if(Ze.value){je.value=!0,Ve.value="",ve.value=null,$e.value=null,rt.value=[];try{const c=await z(`/api/v1/fiber/trace/${Number(Ze.value)}?stop_at_odp_out=1`);if(!c.ok)throw new Error(((a=c.data)==null?void 0:a.message)||`Gagal trace (HTTP ${c.status}).`);ve.value=((e=c.data)==null?void 0:e.data)||null,rt.value=((o=(s=c.data)==null?void 0:s.data)==null?void 0:o.used_cable_ids)||[],nt();const u=((v=(r=c.data)==null?void 0:r.data)==null?void 0:v.endpoints)||[];u.length>0&&($e.value=u[0]),b&&b.success("Trace selesai.")}catch(c){console.error("Fiber: runTrace failed",c),Ve.value=(c==null?void 0:c.message)||"Gagal trace.",b&&b.error(Ve.value)}finally{je.value=!1}}}return me([Re,De,Be],()=>{zt()}),me($,()=>{T.value=""}),me(N,a=>{a&&(ue.value=!1)}),me(Fe,()=>{pa(()=>Rt())}),me(J,a=>{if(!a){we.value=!1;return}Ae.value==="create"&&(we.value=!0)}),me([()=>p.value.from_point_id,()=>p.value.to_point_id],async()=>{if(!J.value||Ae.value!=="create"||!we.value)return;const a=Number(p.value.from_point_id||0),e=Number(p.value.to_point_id||0);if(!a||!e||a===e)return;if(Array.isArray(p.value.path)&&p.value.path.length>=2){we.value=!1;return}await aa({force:!1})&&(we.value=!1)}),me(()=>p.value.path,()=>{if(!he.value)return;const a=Math.round(St(p.value.path));Number.isFinite(a)&&a>0&&(p.value.length_m=a)},{deep:!0}),me(pe,()=>{try{localStorage.setItem("fiber_map_style",pe.value)}catch{}ya()}),me(te,()=>{try{localStorage.setItem("fiber_follow_road",te.value?"1":"0")}catch{}}),cl(()=>{try{const e=localStorage.getItem("fiber_map_style");e&&Ke[e]&&(pe.value=e)}catch{}try{const e=localStorage.getItem("fiber_follow_road");e==="0"&&(te.value=!1),e==="1"&&(te.value=!0)}catch{}Se.value="";const a=(kt.googleMapsApiKey||"").toString().trim();if(!a){Se.value="Google Maps API key belum di-set. Buka Pengaturan -> System -> Google Maps.",D();return}ma(a).then(()=>{pa(()=>{ka(),Rt(),D()})}).catch(e=>{console.error("Fiber: Google Maps load failed",e),Se.value=(e==null?void 0:e.message)||"Gagal memuat Google Maps.",D()})}),bl(()=>{xa()}),(a,e)=>(i(),n(A,null,[ca(gl(fl),{title:"Kabel FO"}),ca(kl,null,{default:ml(()=>{var s,o,r,v,c,u,k,P,L,I,U,fe,G,ua,da;return[t("div",xl,[t("div",_l,[e[99]||(e[99]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Manajemen Kabel FO"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Pemetaan jalur kabel, titik sambungan, dan data putus.")],-1)),t("div",hl,[t("div",wl,[t("span",Cl,d(Me.value.cables),1),e[95]||(e[95]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"kabel",-1))]),t("div",Nl,[t("span",Pl,d(Me.value.points),1),e[96]||(e[96]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"titik",-1))]),t("div",Tl,[t("span",Sl,d(Me.value.breaks_open),1),e[97]||(e[97]=t("span",{class:"text-red-600/70 dark:text-red-300/70 ml-1"},"putus aktif",-1))]),t("div",El,[m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>pe.value=l),class:"input !py-2 !text-xs"},[...e[98]||(e[98]=[t("option",{value:"roadmap"},"Roadmap",-1),t("option",{value:"hybrid"},"Hybrid",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[R,pe.value]]),t("button",{onClick:D,class:"btn btn-secondary !py-2 !text-xs",disabled:Ue.value},"Refresh",8,Ll),t("button",{onClick:e[1]||(e[1]=l=>Fe.value=!Fe.value),class:"btn btn-secondary !py-2 !text-xs"},d(Fe.value?"Tampilkan Panel":"Full Map"),1)])])]),kt.warning?(i(),n("div",Ol,d(kt.warning),1)):g("",!0),jt.value?(i(),n("div",Ul,[ue.value?(i(),n("div",{key:0,class:"fixed inset-0 z-[9000] bg-black/35 backdrop-blur-sm lg:hidden",onClick:e[2]||(e[2]=l=>ue.value=!1)})):g("",!0),t("div",Ml,[t("div",{class:M(["bg-white dark:bg-dark-800 rounded-xl shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden flex flex-col lg:h-[calc(100vh-13rem)]",Fe.value?"lg:col-span-12":"lg:col-span-8"])},[t("div",Fl,[t("label",Il,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>Re.value=l)},null,512),[[lt,Re.value]]),e[101]||(e[101]=_(" Kabel ",-1))]),t("label",Al,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=l=>De.value=l)},null,512),[[lt,De.value]]),e[102]||(e[102]=_(" Titik ",-1))]),t("label",jl,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>Be.value=l)},null,512),[[lt,Be.value]]),e[103]||(e[103]=_(" Putus ",-1))]),t("div",Vl,[m(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>pe.value=l),class:"input !py-2 !text-xs"},[...e[104]||(e[104]=[t("option",{value:"roadmap"},"Roadmap",-1),t("option",{value:"hybrid"},"Hybrid",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[R,pe.value]]),t("button",{onClick:D,class:"btn btn-secondary !py-2 !text-xs",disabled:Ue.value},"Refresh",8,Gl),t("button",{onClick:e[7]||(e[7]=l=>ue.value=!ue.value),class:"btn btn-primary !py-2 !text-xs"},d(ue.value?"Tutup":"Data"),1)])]),t("div",Rl,[t("div",{ref_key:"mapContainer",ref:xt,class:"absolute inset-0 w-full h-full bg-slate-100 dark:bg-slate-900"},null,512),Se.value?(i(),n("div",Dl,[t("div",Bl,[e[105]||(e[105]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Peta tidak dapat dimuat",-1)),t("div",Kl,d(Se.value),1)])])):g("",!0),N.value?(i(),n("div",Hl,[t("div",Jl,[e[106]||(e[106]=_(" Mode peta aktif: ",-1)),t("span",zl,d(N.value==="drawCable"?"gambar kabel":N.value==="editCable"?"edit jalur":N.value==="pickPoint"?"pilih titik":"pilih putus"),1)]),N.value==="editCable"?(i(),n("div",Wl," Geser titik/segmen untuk merapikan jalur, lalu klik tombol Selesai. ")):N.value==="drawCable"?(i(),n("div",ql,[e[107]||(e[107]=_(" Klik peta untuk menambah titik. Mode: ",-1)),t("span",Zl,d(te.value?"Ikuti jalan":"Garis lurus"),1),e[108]||(e[108]=_(". ",-1)),ke.value?(i(),n("span",Xl,"Menghitung rute...")):g("",!0)])):(i(),n("div",Yl," Klik peta untuk memilih lokasi, lalu klik tombol Selesai. ")),N.value==="drawCable"?(i(),n("label",Ql,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>te.value=l),disabled:ke.value},null,8,es),[[lt,te.value]]),e[109]||(e[109]=_(" Ikuti jalan ",-1))])):g("",!0),t("div",ts,[t("button",{class:"btn btn-secondary !py-1 !text-xs",onClick:F,disabled:N.value==="drawCable"&&ke.value},"Selesai",8,as),N.value==="drawCable"?(i(),n("button",{key:0,class:"btn btn-secondary !py-1 !text-xs",onClick:la,disabled:ke.value},"Undo",8,ls)):g("",!0),N.value==="drawCable"?(i(),n("button",{key:1,class:"btn btn-secondary !py-1 !text-xs",onClick:Lt,disabled:ke.value},"Clear",8,ss)):g("",!0),N.value==="editCable"?(i(),n("button",{key:2,class:"btn btn-secondary !py-1 !text-xs",onClick:Lt},"Clear")):g("",!0)])])):g("",!0)])],2),t("div",{class:M(["bg-white dark:bg-dark-800 shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden flex flex-col lg:h-[calc(100vh-13rem)] fixed inset-x-0 bottom-0 z-[9001] lg:static lg:z-auto rounded-t-2xl lg:rounded-xl max-h-[calc(100vh-5rem)] lg:max-h-none transform transition-transform duration-200 ease-out lg:transform-none",[Fe.value?"lg:hidden":"lg:col-span-4",ue.value?"translate-y-0 pointer-events-auto":"translate-y-full pointer-events-none lg:pointer-events-auto lg:translate-y-0"]])},[t("div",os,[e[111]||(e[111]=t("div",{class:"mx-auto h-1 w-10 rounded-full bg-gray-200 dark:bg-white/10"},null,-1)),t("div",rs,[m(t("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>$.value=l),class:"input !py-2 !text-xs flex-1"},[t("option",ns,"Kabel ("+d(B.value.length)+")",1),t("option",is,"Titik ("+d(K.value.length)+")",1),t("option",us,"Port ("+d(ye.value.length)+")",1),t("option",ds,"Sambungan ("+d(Ge.value.length)+")",1),e[110]||(e[110]=t("option",{value:"trace"},"Trace",-1)),t("option",vs,"Putus ("+d(de.value.length)+")",1)],512),[[R,$.value]]),t("button",{class:"btn btn-secondary !py-1.5 !text-xs",onClick:e[10]||(e[10]=l=>ue.value=!1)},"Tutup")])]),t("div",ps,[t("button",{onClick:e[11]||(e[11]=l=>$.value="cables"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="cables"?"text-blue-700 dark:text-blue-300 bg-blue-50/60 dark:bg-blue-900/10":"text-gray-600 dark:text-gray-300"])}," Kabel ("+d(B.value.length)+") ",3),t("button",{onClick:e[12]||(e[12]=l=>$.value="points"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="points"?"text-teal-700 dark:text-teal-300 bg-teal-50/60 dark:bg-teal-900/10":"text-gray-600 dark:text-gray-300"])}," Titik ("+d(K.value.length)+") ",3),t("button",{onClick:e[13]||(e[13]=l=>$.value="ports"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="ports"?"text-indigo-700 dark:text-indigo-300 bg-indigo-50/60 dark:bg-indigo-900/10":"text-gray-600 dark:text-gray-300"])}," Port ("+d(ye.value.length)+") ",3),t("button",{onClick:e[14]||(e[14]=l=>$.value="links"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="links"?"text-amber-700 dark:text-amber-300 bg-amber-50/60 dark:bg-amber-900/10":"text-gray-600 dark:text-gray-300"])}," Sambungan ("+d(Ge.value.length)+") ",3),t("button",{onClick:e[15]||(e[15]=l=>$.value="trace"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="trace"?"text-slate-700 dark:text-slate-200 bg-slate-50/60 dark:bg-slate-700/30":"text-gray-600 dark:text-gray-300"])}," Trace ",2),t("button",{onClick:e[16]||(e[16]=l=>$.value="breaks"),class:M(["px-3 py-3 text-xs font-semibold whitespace-nowrap",$.value==="breaks"?"text-red-700 dark:text-red-300 bg-red-50/60 dark:bg-red-900/10":"text-gray-600 dark:text-gray-300"])}," Putus ("+d(de.value.length)+") ",3)]),t("div",cs,[Ue.value?(i(),n("div",bs,"Memuat...")):ot.value?(i(),n("div",gs,d(ot.value),1)):$.value==="cables"?(i(),n("div",fs,[t("div",ms,[e[112]||(e[112]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Daftar Kabel",-1)),Z.value?(i(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Ua},"Tambah")):g("",!0)]),t("div",ys,[m(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>T.value=l),class:"input w-full !py-2 !text-xs",placeholder:qe.value},null,8,ks),[[w,T.value]]),T.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[18]||(e[18]=l=>T.value="")},"Clear")):g("",!0)]),T.value?(i(),n("div",xs,[e[113]||(e[113]=_(" Hasil: ",-1)),t("span",_s,d(Ot.value.length),1),_(" / "+d(B.value.length),1)])):g("",!0),Ot.value.length===0?(i(),n("div",hs,d(B.value.length===0?"Belum ada data kabel.":"Tidak ada hasil."),1)):(i(),n("div",ws,[(i(!0),n(A,null,j(Ot.value,l=>(i(),n("div",{key:l.id,class:M(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-blue-200 dark:hover:border-blue-900/40 cursor-pointer",Number(Ne.value)===Number(l.id)?"bg-blue-50/60 dark:bg-blue-900/10":"bg-white dark:bg-dark-800"]),onClick:O=>Xt(l,{panel:"close"})},[t("div",Ns,[t("div",null,[t("div",Ps,d(l.name),1),t("div",Ts,[l.cable_type?(i(),n("span",Ss,d(l.cable_type),1)):g("",!0),l.core_count?(i(),n("span",Es,"| "+d(l.core_count)+" core",1)):g("",!0),l.length_m?(i(),n("span",Ls,"| "+d(ea(l.length_m)),1)):g("",!0)]),l.from_point_id||l.to_point_id?(i(),n("div",Os,[t("div",null,[e[114]||(e[114]=_("Dari: ",-1)),t("span",$s,d(H(l.from_point_id)||"-"),1)]),t("div",null,[e[115]||(e[115]=_("Ke: ",-1)),t("span",Us,d(H(l.to_point_id)||"-"),1)])])):g("",!0)]),t("div",Ms,[X.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:ne(O=>Ma(l),["stop"])},"Edit",8,Fs)):g("",!0),ie.value?(i(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:ne(O=>Aa(l),["stop"])},"Hapus",8,Is)):g("",!0)])])],10,Cs))),128))]))])):$.value==="points"?(i(),n("div",As,[t("div",js,[e[116]||(e[116]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Titik Sambungan",-1)),Z.value?(i(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Ra},"Tambah")):g("",!0)]),t("div",Vs,[m(t("input",{"onUpdate:modelValue":e[19]||(e[19]=l=>T.value=l),class:"input w-full !py-2 !text-xs",placeholder:qe.value},null,8,Gs),[[w,T.value]]),T.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[20]||(e[20]=l=>T.value="")},"Clear")):g("",!0)]),T.value?(i(),n("div",Rs,[e[117]||(e[117]=_(" Hasil: ",-1)),t("span",Ds,d($t.value.length),1),_(" / "+d(K.value.length),1)])):g("",!0),$t.value.length===0?(i(),n("div",Bs,d(K.value.length===0?"Belum ada data titik.":"Tidak ada hasil."),1)):(i(),n("div",Ks,[(i(!0),n(A,null,j($t.value,l=>(i(),n("div",{key:l.id,class:M(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-teal-200 dark:hover:border-teal-900/40 cursor-pointer",Number(ae.value)===Number(l.id)?"bg-teal-50/60 dark:bg-teal-900/10":"bg-white dark:bg-dark-800"]),onClick:O=>Yt(l,{panel:"close"})},[t("div",Js,[t("div",null,[t("div",zs,d(l.name),1),t("div",Ws,[l.point_type?(i(),n("span",qs,d(l.point_type),1)):g("",!0),l.latitude&&l.longitude?(i(),n("span",Zs,"| "+d(l.latitude)+", "+d(l.longitude),1)):g("",!0)])]),t("div",Xs,[X.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:ne(O=>Da(l),["stop"])},"Edit",8,Ys)):g("",!0),ie.value?(i(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:ne(O=>Ha(l),["stop"])},"Hapus",8,Qs)):g("",!0)])])],10,Hs))),128))]))])):$.value==="ports"?(i(),n("div",eo,[t("div",to,[e[118]||(e[118]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Port (OLT/ODP)",-1)),Z.value?(i(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Ya},"Tambah")):g("",!0)]),t("div",ao,[m(t("input",{"onUpdate:modelValue":e[21]||(e[21]=l=>T.value=l),class:"input w-full !py-2 !text-xs",placeholder:qe.value},null,8,lo),[[w,T.value]]),T.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[22]||(e[22]=l=>T.value="")},"Clear")):g("",!0)]),T.value?(i(),n("div",so,[e[119]||(e[119]=_(" Hasil: ",-1)),t("span",oo,d(Ut.value.length),1),_(" / "+d(ye.value.length),1)])):g("",!0),Ut.value.length===0?(i(),n("div",ro,d(ye.value.length===0?"Belum ada data port.":"Tidak ada hasil."),1)):(i(),n("div",no,[(i(!0),n(A,null,j(Ut.value,l=>(i(),n("div",{key:l.id,class:"p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-indigo-200 dark:hover:border-indigo-900/40 bg-white dark:bg-dark-800"},[t("div",io,[t("div",null,[t("div",uo,d(String(l.port_type||"").toUpperCase()),1),t("div",vo,d(l.port_label||"#"+l.id),1),t("div",po,[t("div",null,[e[120]||(e[120]=_(" Titik: ",-1)),t("span",co,d(H(l.point_id)||"#"+l.point_id),1)]),l.cable_id&&l.core_no?(i(),n("div",bo,[e[121]||(e[121]=_(" Kabel: ",-1)),t("span",go,d(W(l.cable_id)||"Kabel #"+l.cable_id),1),t("span",fo,"- core "+d(l.core_no),1)])):g("",!0)])]),t("div",mo,[X.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:ne(O=>Qa(l),["stop"])},"Edit",8,yo)):g("",!0),ie.value?(i(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:ne(O=>tl(l),["stop"])},"Hapus",8,ko)):g("",!0)])])]))),128))]))])):$.value==="links"?(i(),n("div",xo,[t("div",_o,[e[122]||(e[122]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Sambungan (Splice/Split)",-1)),Z.value?(i(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:ol},"Tambah")):g("",!0)]),t("div",ho,[m(t("input",{"onUpdate:modelValue":e[23]||(e[23]=l=>T.value=l),class:"input w-full !py-2 !text-xs",placeholder:qe.value},null,8,wo),[[w,T.value]]),T.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[24]||(e[24]=l=>T.value="")},"Clear")):g("",!0)]),T.value?(i(),n("div",Co,[e[123]||(e[123]=_(" Hasil: ",-1)),t("span",No,d(Mt.value.length),1),_(" / "+d(yt.value.length),1)])):g("",!0),Mt.value.length===0?(i(),n("div",Po,d(yt.value.length===0?"Belum ada data sambungan.":"Tidak ada hasil."),1)):(i(),n("div",To,[(i(!0),n(A,null,j(Mt.value,l=>(i(),n("div",{key:l.kind==="SPLIT_GROUP"?"g:"+l.split_group+":"+l.point_id:"l:"+l.id,class:"p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-amber-200 dark:hover:border-amber-900/40 bg-white dark:bg-dark-800"},[t("div",So,[t("div",Eo,[t("div",Lo,[_(d(l.kind==="SPLIT_GROUP"?"SPLIT":String(l.link_type||"").toUpperCase())+" ",1),l.kind==="SPLIT_GROUP"?(i(),n("span",Oo,"- "+d((l.outputs||[]).length)+" output",1)):g("",!0)]),t("div",$o,[e[124]||(e[124]=_(" Titik: ",-1)),t("span",Uo,d(H(l.point_id)||"#"+l.point_id),1)]),t("div",Mo,[_(d(W(l.from_cable_id)||"Kabel #"+l.from_cable_id)+" - core "+d(l.from_core_no)+" ",1),e[125]||(e[125]=t("span",{class:"mx-1 text-gray-400"},"->",-1)),l.kind==="SPLIT_GROUP"?(i(),n("span",Fo,"splitter")):(i(),n(A,{key:1},[_(d(W(l.to_cable_id)||"Kabel #"+l.to_cable_id)+" - core "+d(l.to_core_no),1)],64))]),l.kind==="SPLIT_GROUP"&&(l.outputs||[]).length?(i(),n("div",Io,[_(" Output: "+d((l.outputs||[]).slice(0,4).map(O=>`${W(O.to_cable_id)||"#"+O.to_cable_id}:${O.to_core_no}`).join(", ")),1),(l.outputs||[]).length>4?(i(),n("span",Ao,", ...")):g("",!0)])):g("",!0),l.loss_db!==null&&l.loss_db!==void 0&&l.loss_db!==""?(i(),n("div",jo,[e[126]||(e[126]=_(" Loss: ",-1)),t("span",Vo,d(l.loss_db)+" dB",1)])):g("",!0)]),t("div",Go,[X.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:ne(O=>rl(l),["stop"])},"Edit",8,Ro)):g("",!0),ie.value?(i(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:ne(O=>il(l),["stop"])},"Hapus",8,Do)):g("",!0)])])]))),128))]))])):$.value==="trace"?(i(),n("div",Bo,[t("div",Ko,[e[127]||(e[127]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Tracing End-to-End",-1)),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:dl,disabled:je.value},"Clear",8,Ho)]),t("div",Jo,[t("div",null,[e[129]||(e[129]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Start Port (OLT_PON)",-1)),m(t("select",{"onUpdate:modelValue":e[25]||(e[25]=l=>Ze.value=l),class:"input w-full"},[e[128]||(e[128]=t("option",{value:""},"(pilih port)",-1)),(i(!0),n(A,null,j(ul.value,l=>(i(),n("option",{key:l.id,value:l.id},d(H(l.point_id)||"#"+l.point_id)+" | "+d(l.port_label)+" | "+d(W(l.cable_id)||"Kabel #"+l.cable_id)+":"+d(l.core_no),9,zo))),128))],512),[[R,Ze.value]])]),t("div",Wo,[t("button",{class:"btn btn-primary !py-2 !text-xs",onClick:vl,disabled:je.value||!Ze.value},d(je.value?"Tracing...":"Trace"),9,qo),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:D,disabled:Ue.value||je.value},"Refresh Data",8,Zo)]),Ve.value?(i(),n("div",Xo,d(Ve.value),1)):g("",!0)]),ve.value?(i(),n("div",Yo,[t("div",Qo,[e[130]||(e[130]=_(" Endpoint: ",-1)),t("span",er,d((ve.value.endpoints||[]).length),1),e[131]||(e[131]=t("span",{class:"mx-2"},"|",-1)),e[132]||(e[132]=_(" Visited: ",-1)),t("span",tr,d(ve.value.visited_nodes||0),1),ve.value.truncated?(i(),n("span",ar,"(truncated)")):g("",!0)]),(ve.value.endpoints||[]).length===0?(i(),n("div",lr,[...e[133]||(e[133]=[_(" Tidak ada endpoint ",-1),t("span",{class:"font-mono"},"ODP_OUT",-1),_(" terjangkau dari port ini. ",-1)])])):(i(),n("div",sr,[(i(!0),n(A,null,j(ve.value.endpoints||[],(l,O)=>{var q,Xe,Ye,Qe,et,tt,at,va;return i(),n("div",{key:((q=l.port)==null?void 0:q.id)||O,class:M(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-slate-200 dark:hover:border-slate-700 cursor-pointer",$e.value===l?"bg-slate-50/60 dark:bg-slate-700/30":"bg-white dark:bg-dark-800"]),onClick:Ci=>$e.value=l},[t("div",rr,d(((Xe=l.point)==null?void 0:Xe.name)||H((Ye=l.port)==null?void 0:Ye.point_id)||"-"),1),t("div",nr,[e[134]||(e[134]=_(" Port: ",-1)),t("span",ir,d(((Qe=l.port)==null?void 0:Qe.port_label)||"#"+((et=l.port)==null?void 0:et.id)),1),e[135]||(e[135]=t("span",{class:"mx-2"},"|",-1)),_(" "+d(W((tt=l.port)==null?void 0:tt.cable_id)||"Kabel #"+((at=l.port)==null?void 0:at.cable_id))+":"+d((va=l.port)==null?void 0:va.core_no),1)])],10,or)}),128))])),(s=$e.value)!=null&&s.path?(i(),n("div",ur,[e[137]||(e[137]=t("div",{class:"text-xs font-semibold text-gray-900 dark:text-white"},"Path (ringkas)",-1)),t("div",dr,[(i(!0),n(A,null,j($e.value.path,(l,O)=>{var q,Xe,Ye,Qe,et,tt,at;return i(),n("div",{key:O,class:"text-xs"},[t("div",vr,[_(d(O===0?"START":((q=l.edge)==null?void 0:q.type)==="CABLE"?"KABEL":"LINK "+(((Xe=l.edge)==null?void 0:Xe.link_type)||""))+" ",1),e[136]||(e[136]=t("span",{class:"mx-1 text-gray-400"},"|",-1)),_(" "+d(((Ye=l.point)==null?void 0:Ye.name)||"Titik #"+((Qe=l.node)==null?void 0:Qe.point_id)),1)]),t("div",pr,d(((et=l.cable)==null?void 0:et.name)||"Kabel #"+((tt=l.node)==null?void 0:tt.cable_id))+" - core "+d((at=l.node)==null?void 0:at.core_no),1)])}),128))])])):g("",!0)])):g("",!0)])):(i(),n("div",cr,[t("div",br,[e[138]||(e[138]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Data Putus",-1)),Z.value?(i(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Ja},"Tambah")):g("",!0)]),t("div",gr,[m(t("input",{"onUpdate:modelValue":e[26]||(e[26]=l=>T.value=l),class:"input w-full !py-2 !text-xs",placeholder:qe.value},null,8,fr),[[w,T.value]]),T.value?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[27]||(e[27]=l=>T.value="")},"Clear")):g("",!0)]),t("div",mr,[t("button",{class:M(["px-3 py-1.5 rounded-full text-xs font-semibold border transition",Y.value==="ALL"?"bg-slate-900 text-white border-slate-900 dark:bg-white dark:text-slate-900 dark:border-white":"bg-white dark:bg-dark-800 border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/5"]),onClick:e[28]||(e[28]=l=>Y.value="ALL")}," Semua ",2),t("button",{class:M(["px-3 py-1.5 rounded-full text-xs font-semibold border transition",Y.value==="OPEN"?"bg-red-50 border-red-200 text-red-700 dark:bg-red-900/10 dark:border-red-900/30 dark:text-red-300":"bg-white dark:bg-dark-800 border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/5"]),onClick:e[29]||(e[29]=l=>Y.value="OPEN")}," OPEN ",2),t("button",{class:M(["px-3 py-1.5 rounded-full text-xs font-semibold border transition",Y.value==="IN_PROGRESS"?"bg-amber-50 border-amber-200 text-amber-800 dark:bg-amber-900/10 dark:border-amber-900/30 dark:text-amber-200":"bg-white dark:bg-dark-800 border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/5"]),onClick:e[30]||(e[30]=l=>Y.value="IN_PROGRESS")}," IN PROGRESS ",2),t("button",{class:M(["px-3 py-1.5 rounded-full text-xs font-semibold border transition",Y.value==="FIXED"?"bg-emerald-50 border-emerald-200 text-emerald-700 dark:bg-emerald-900/10 dark:border-emerald-900/30 dark:text-emerald-200":"bg-white dark:bg-dark-800 border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/5"]),onClick:e[31]||(e[31]=l=>Y.value="FIXED")}," FIXED ",2),t("button",{class:M(["px-3 py-1.5 rounded-full text-xs font-semibold border transition",Y.value==="CANCELLED"?"bg-slate-100 border-slate-200 text-slate-700 dark:bg-slate-700/30 dark:border-white/10 dark:text-slate-200":"bg-white dark:bg-dark-800 border-gray-200 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/5"]),onClick:e[32]||(e[32]=l=>Y.value="CANCELLED")}," CANCELLED ",2)]),T.value||Y.value!=="ALL"?(i(),n("div",yr,[e[139]||(e[139]=_(" Hasil: ",-1)),t("span",kr,d(Ft.value.length),1),_(" / "+d(de.value.length),1)])):g("",!0),Ft.value.length===0?(i(),n("div",xr,d(de.value.length===0?"Belum ada data putus.":"Tidak ada hasil."),1)):(i(),n("div",_r,[(i(!0),n(A,null,j(Ft.value,l=>(i(),n("div",{key:l.id,class:M(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-red-200 dark:hover:border-red-900/40 cursor-pointer",Number(Pe.value)===Number(l.id)?"bg-red-50/60 dark:bg-red-900/10":"bg-white dark:bg-dark-800"]),onClick:O=>Qt(l,{panel:"close"})},[t("div",wr,[t("div",null,[t("div",Cr,d(Ea(l.status)),1),t("div",Nr,d(W(l.cable_id)||(l.cable_id?"Kabel #"+l.cable_id:"Tanpa kabel")),1),t("div",Pr,[t("span",null,"Titik: "+d(H(l.point_id)||"-"),1),l.severity?(i(),n("span",Tr,"| "+d(l.severity),1)):g("",!0)]),l.description?(i(),n("div",Sr,d(l.description),1)):g("",!0)]),t("div",Er,[Z.value&&X.value&&["OPEN","IN_PROGRESS"].includes(String(l.status||"OPEN").toUpperCase())?(i(),n("button",{key:0,class:"btn btn-primary !py-1 !px-2 !text-xs",disabled:ra(l.id),onClick:ne(O=>Xa(l),["stop"])},d(ra(l.id)?"Memproses...":"Selesaikan"),9,Lr)):g("",!0),X.value?(i(),n("button",{key:1,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:ne(O=>za(l),["stop"])},"Edit",8,Or)):g("",!0),ie.value?(i(),n("button",{key:2,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:ne(O=>Za(l),["stop"])},"Hapus",8,$r)):g("",!0)])])],10,hr))),128))]))]))])],2)])])):(i(),n("div",$l,[...e[100]||(e[100]=[t("div",{class:"text-gray-900 dark:text-white font-semibold"},"Tidak punya akses",-1),t("div",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},[_(" Butuh permission "),t("code",{class:"px-1 py-0.5 bg-gray-100 dark:bg-dark-700 rounded"},"view fiber"),_(". ")],-1)])]))]),J.value?(i(),n("div",{key:0,class:M(["fixed inset-0 z-[10000] flex items-center justify-center p-4",N.value?"pointer-events-none":""])},[t("div",{class:M(["absolute inset-0 bg-black/40",N.value?"pointer-events-none opacity-20":""]),onClick:e[33]||(e[33]=l=>{J.value=!1,F()})},null,2),t("div",Ur,[t("div",Mr,[t("div",Fr,d(Ae.value==="edit"?"Edit Kabel":"Tambah Kabel"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[34]||(e[34]=l=>{J.value=!1,F()})},"Tutup")]),t("div",Ir,[t("div",Ar,[t("div",null,[e[140]||(e[140]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),m(t("input",{"onUpdate:modelValue":e[35]||(e[35]=l=>p.value.name=l),class:"input w-full",placeholder:"Feeder ODC-POP A"},null,512),[[w,p.value.name]]),se.value.name?(i(),n("div",jr,d((o=se.value.name)==null?void 0:o[0]),1)):g("",!0)]),t("div",null,[e[141]||(e[141]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kode (opsional)",-1)),m(t("input",{"onUpdate:modelValue":e[36]||(e[36]=l=>p.value.code=l),class:"input w-full",placeholder:"FO-001"},null,512),[[w,p.value.code]]),se.value.code?(i(),n("div",Vr,d((r=se.value.code)==null?void 0:r[0]),1)):g("",!0)]),t("div",null,[e[142]||(e[142]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("input",{"onUpdate:modelValue":e[37]||(e[37]=l=>p.value.cable_type=l),class:"input w-full",placeholder:"FEEDER / DISTRIBUTION / DROP"},null,512),[[w,p.value.cable_type]]),se.value.cable_type?(i(),n("div",Gr,d((v=se.value.cable_type)==null?void 0:v[0]),1)):g("",!0)]),t("div",null,[e[143]||(e[143]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Core",-1)),m(t("input",{"onUpdate:modelValue":e[38]||(e[38]=l=>p.value.core_count=l),type:"number",min:"1",class:"input w-full",placeholder:"12"},null,512),[[w,p.value.core_count]]),se.value.core_count?(i(),n("div",Rr,d((c=se.value.core_count)==null?void 0:c[0]),1)):g("",!0)]),t("div",Dr,[e[145]||(e[145]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Panjang (meter)",-1)),t("div",Br,[m(t("input",{"onUpdate:modelValue":e[39]||(e[39]=l=>p.value.length_m=l),type:"number",min:"0",class:"input w-full sm:flex-1",placeholder:"(opsional)",onInput:e[40]||(e[40]=l=>he.value=!1)},null,544),[[w,p.value.length_m]]),t("button",{class:"btn btn-secondary shrink-0 !py-2 !text-xs",onClick:Ga},"Hitung dari jalur")]),t("div",Kr,[e[144]||(e[144]=_(" Estimasi dari jalur: ",-1)),t("span",Hr,d(ea(Et.value)),1),t("span",Jr,"("+d(Et.value)+" m)",1),he.value?(i(),n("span",zr,"[auto]")):g("",!0)])]),t("div",null,[e[147]||(e[147]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dari Titik",-1)),m(t("select",{"onUpdate:modelValue":e[41]||(e[41]=l=>p.value.from_point_id=l),class:"input w-full"},[e[146]||(e[146]=t("option",{value:""},"(kosong)",-1)),(i(!0),n(A,null,j(K.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,Wr))),128))],512),[[R,p.value.from_point_id]])]),t("div",null,[e[149]||(e[149]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Ke Titik",-1)),m(t("select",{"onUpdate:modelValue":e[42]||(e[42]=l=>p.value.to_point_id=l),class:"input w-full"},[e[148]||(e[148]=t("option",{value:""},"(kosong)",-1)),(i(!0),n(A,null,j(K.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,qr))),128))],512),[[R,p.value.to_point_id]])]),t("div",Zr,[e[150]||(e[150]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Warna Jalur",-1)),t("div",Xr,[m(t("input",{"onUpdate:modelValue":e[43]||(e[43]=l=>p.value.map_color=l),type:"color",class:"h-10 w-14 rounded border border-gray-200 dark:border-dark-700 bg-transparent"},null,512),[[w,p.value.map_color]]),m(t("input",{"onUpdate:modelValue":e[44]||(e[44]=l=>p.value.map_color=l),class:"input flex-1",placeholder:"#2563eb"},null,512),[[w,p.value.map_color]])])]),t("div",Yr,[e[151]||(e[151]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[45]||(e[45]=l=>p.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"Keterangan kabel..."},null,512),[[w,p.value.notes]])])]),t("div",Qr,[t("div",en,[t("div",null,[e[152]||(e[152]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Jalur di Peta",-1)),t("div",tn,"Titik: "+d(Array.isArray(p.value.path)?p.value.path.length:0),1)]),t("div",an,[t("label",ln,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[46]||(e[46]=l=>te.value=l)},null,512),[[lt,te.value]]),e[153]||(e[153]=_(" Ikuti jalan ",-1))]),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:e[47]||(e[47]=l=>aa({force:!0})),disabled:!p.value.from_point_id||!p.value.to_point_id}," Auto ",8,sn),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:ja},"Gambar"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Va,disabled:!p.value.path||p.value.path.length<2},"Edit",8,on),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:la,disabled:!p.value.path||p.value.path.length===0},"Undo",8,rn),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Lt,disabled:!p.value.path||p.value.path.length===0},"Clear",8,nn)])]),e[154]||(e[154]=t("div",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[_(" Tips: mode "),t("span",{class:"font-semibold"},"Ikuti jalan"),_(" memakai Google Directions. Jika gagal/limit, otomatis fallback ke garis lurus. Jalur bisa dirapikan lewat tombol "),t("span",{class:"font-semibold"},"Edit"),_(". ")],-1))])]),t("div",un,[t("button",{class:"btn btn-secondary",onClick:e[48]||(e[48]=l=>{J.value=!1,F()})},"Batal"),t("button",{class:"btn btn-primary",disabled:ut.value,onClick:Ia},d(ut.value?"Menyimpan...":"Simpan"),9,dn)])])],2)):g("",!0),oe.value?(i(),n("div",{key:1,class:M(["fixed inset-0 z-[10000] flex items-center justify-center p-4",N.value?"pointer-events-none":""])},[t("div",{class:M(["absolute inset-0 bg-black/40",N.value?"pointer-events-none opacity-20":""]),onClick:e[49]||(e[49]=l=>{oe.value=!1,F()})},null,2),t("div",vn,[t("div",pn,[t("div",cn,d(dt.value==="edit"?"Edit Titik":"Tambah Titik"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[50]||(e[50]=l=>{oe.value=!1,F()})},"Tutup")]),t("div",bn,[t("div",null,[e[155]||(e[155]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),m(t("input",{"onUpdate:modelValue":e[51]||(e[51]=l=>h.value.name=l),class:"input w-full",placeholder:"ODP-01 / Joint A"},null,512),[[w,h.value.name]]),be.value.name?(i(),n("div",gn,d((u=be.value.name)==null?void 0:u[0]),1)):g("",!0)]),t("div",null,[e[156]||(e[156]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("input",{"onUpdate:modelValue":e[52]||(e[52]=l=>h.value.point_type=l),class:"input w-full",placeholder:"ODP / ODC / JOINT / HANDHOLE"},null,512),[[w,h.value.point_type]])]),t("div",fn,[t("div",null,[e[157]||(e[157]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),m(t("input",{"onUpdate:modelValue":e[53]||(e[53]=l=>h.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[w,h.value.latitude]]),be.value.latitude?(i(),n("div",mn,d((k=be.value.latitude)==null?void 0:k[0]),1)):g("",!0)]),t("div",null,[e[158]||(e[158]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),m(t("input",{"onUpdate:modelValue":e[54]||(e[54]=l=>h.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[w,h.value.longitude]]),be.value.longitude?(i(),n("div",yn,d((P=be.value.longitude)==null?void 0:P[0]),1)):g("",!0)])]),t("div",kn,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Ba},"Pilih dari peta"),h.value.latitude&&h.value.longitude?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[55]||(e[55]=l=>_e(Number(h.value.latitude),Number(h.value.longitude),18))},"Zoom")):g("",!0)]),t("div",null,[e[159]||(e[159]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Alamat",-1)),m(t("input",{"onUpdate:modelValue":e[56]||(e[56]=l=>h.value.address=l),class:"input w-full",placeholder:"(opsional)"},null,512),[[w,h.value.address]])]),t("div",null,[e[160]||(e[160]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[57]||(e[57]=l=>h.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"(opsional)"},null,512),[[w,h.value.notes]])])]),t("div",xn,[t("button",{class:"btn btn-secondary",onClick:e[58]||(e[58]=l=>{oe.value=!1,F()})},"Batal"),t("button",{class:"btn btn-primary",disabled:vt.value,onClick:Ka},d(vt.value?"Menyimpan...":"Simpan"),9,_n)])])],2)):g("",!0),re.value?(i(),n("div",{key:2,class:M(["fixed inset-0 z-[10000] flex items-center justify-center p-4",N.value?"pointer-events-none":""])},[t("div",{class:M(["absolute inset-0 bg-black/40",N.value?"pointer-events-none opacity-20":""]),onClick:e[59]||(e[59]=l=>{re.value=!1,F()})},null,2),t("div",hn,[t("div",wn,[t("div",Cn,d(pt.value==="edit"?"Edit Data Putus":"Tambah Data Putus"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[60]||(e[60]=l=>{re.value=!1,F()})},"Tutup")]),t("div",Nn,[t("div",null,[e[162]||(e[162]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kabel",-1)),m(t("select",{"onUpdate:modelValue":e[61]||(e[61]=l=>x.value.cable_id=l),class:"input w-full"},[e[161]||(e[161]=t("option",{value:""},"(kosong)",-1)),(i(!0),n(A,null,j(B.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,Pn))),128))],512),[[R,x.value.cable_id]])]),t("div",null,[e[164]||(e[164]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik (opsional)",-1)),m(t("select",{"onUpdate:modelValue":e[62]||(e[62]=l=>x.value.point_id=l),class:"input w-full"},[e[163]||(e[163]=t("option",{value:""},"(kosong)",-1)),(i(!0),n(A,null,j(K.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,Tn))),128))],512),[[R,x.value.point_id]])]),t("div",Sn,[t("div",null,[e[166]||(e[166]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Status",-1)),m(t("select",{"onUpdate:modelValue":e[63]||(e[63]=l=>x.value.status=l),class:"input w-full"},[...e[165]||(e[165]=[t("option",{value:"OPEN"},"OPEN",-1),t("option",{value:"IN_PROGRESS"},"IN_PROGRESS",-1),t("option",{value:"FIXED"},"FIXED",-1),t("option",{value:"CANCELLED"},"CANCELLED",-1)])],512),[[R,x.value.status]])]),t("div",null,[e[168]||(e[168]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Severity",-1)),m(t("select",{"onUpdate:modelValue":e[64]||(e[64]=l=>x.value.severity=l),class:"input w-full"},[...e[167]||(e[167]=[t("option",{value:""},"(kosong)",-1),t("option",{value:"MINOR"},"MINOR",-1),t("option",{value:"MAJOR"},"MAJOR",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)])],512),[[R,x.value.severity]])])]),t("div",En,[t("div",null,[e[169]||(e[169]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dilaporkan",-1)),m(t("input",{"onUpdate:modelValue":e[65]||(e[65]=l=>x.value.reported_at=l),type:"datetime-local",class:"input w-full"},null,512),[[w,x.value.reported_at]])]),t("div",null,[e[170]||(e[170]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Fixed At",-1)),m(t("input",{"onUpdate:modelValue":e[66]||(e[66]=l=>x.value.fixed_at=l),type:"datetime-local",class:"input w-full",disabled:String(x.value.status).toUpperCase()!=="FIXED"},null,8,Ln),[[w,x.value.fixed_at]])])]),t("div",On,[t("div",null,[e[171]||(e[171]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),m(t("input",{"onUpdate:modelValue":e[67]||(e[67]=l=>x.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[w,x.value.latitude]]),Ee.value.latitude?(i(),n("div",$n,d((L=Ee.value.latitude)==null?void 0:L[0]),1)):g("",!0)]),t("div",null,[e[172]||(e[172]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),m(t("input",{"onUpdate:modelValue":e[68]||(e[68]=l=>x.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[w,x.value.longitude]]),Ee.value.longitude?(i(),n("div",Un,d((I=Ee.value.longitude)==null?void 0:I[0]),1)):g("",!0)])]),t("div",Mn,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Wa},"Pilih dari peta"),x.value.latitude&&x.value.longitude?(i(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[69]||(e[69]=l=>_e(Number(x.value.latitude),Number(x.value.longitude),18))},"Zoom")):g("",!0)]),t("div",null,[e[173]||(e[173]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[70]||(e[70]=l=>x.value.description=l),class:"input w-full min-h-[90px]",placeholder:"Keterangan kejadian putus..."},null,512),[[w,x.value.description]])])]),t("div",Fn,[t("button",{class:"btn btn-secondary",onClick:e[71]||(e[71]=l=>{re.value=!1,F()})},"Batal"),t("button",{class:"btn btn-primary",disabled:ct.value,onClick:qa},d(ct.value?"Menyimpan...":"Simpan"),9,In)])])],2)):g("",!0),Le.value?(i(),n("div",An,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[72]||(e[72]=l=>Le.value=!1)}),t("div",jn,[t("div",Vn,[t("div",Gn,d(bt.value==="edit"?"Edit Port":"Tambah Port"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[73]||(e[73]=l=>Le.value=!1)},"Tutup")]),t("div",Rn,[t("div",null,[e[175]||(e[175]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik",-1)),m(t("select",{"onUpdate:modelValue":e[74]||(e[74]=l=>E.value.point_id=l),class:"input w-full"},[e[174]||(e[174]=t("option",{value:""},"(pilih titik)",-1)),(i(!0),n(A,null,j(K.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,Dn))),128))],512),[[R,E.value.point_id]]),Oe.value.point_id?(i(),n("div",Bn,d((U=Oe.value.point_id)==null?void 0:U[0]),1)):g("",!0)]),t("div",Kn,[t("div",null,[e[177]||(e[177]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("select",{"onUpdate:modelValue":e[75]||(e[75]=l=>E.value.port_type=l),class:"input w-full"},[...e[176]||(e[176]=[t("option",{value:"OLT_PON"},"OLT_PON",-1),t("option",{value:"ODP_OUT"},"ODP_OUT",-1)])],512),[[R,E.value.port_type]])]),t("div",null,[e[178]||(e[178]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Label",-1)),m(t("input",{"onUpdate:modelValue":e[76]||(e[76]=l=>E.value.port_label=l),class:"input w-full",placeholder:"PON 1/1/1 / OUT 1"},null,512),[[w,E.value.port_label]]),Oe.value.port_label?(i(),n("div",Hn,d((fe=Oe.value.port_label)==null?void 0:fe[0]),1)):g("",!0)])]),t("div",Jn,[t("div",null,[e[180]||(e[180]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kabel",-1)),m(t("select",{"onUpdate:modelValue":e[77]||(e[77]=l=>E.value.cable_id=l),class:"input w-full"},[e[179]||(e[179]=t("option",{value:""},"(pilih kabel)",-1)),(i(!0),n(A,null,j(B.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,zn))),128))],512),[[R,E.value.cable_id]])]),t("div",null,[e[181]||(e[181]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Core",-1)),m(t("input",{"onUpdate:modelValue":e[78]||(e[78]=l=>E.value.core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[w,E.value.core_no]])])]),t("div",null,[e[182]||(e[182]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[79]||(e[79]=l=>E.value.notes=l),class:"input w-full min-h-[90px]",placeholder:"(opsional)"},null,512),[[w,E.value.notes]])])]),t("div",Wn,[t("button",{class:"btn btn-secondary",onClick:e[80]||(e[80]=l=>Le.value=!1)},"Batal"),t("button",{class:"btn btn-primary",disabled:gt.value,onClick:el},d(gt.value?"Menyimpan...":"Simpan"),9,qn)])])])):g("",!0),Ce.value?(i(),n("div",Zn,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[81]||(e[81]=l=>Ce.value=!1)}),t("div",Xn,[t("div",Yn,[t("div",Qn,d(ft.value==="edit"?"Edit Sambungan":"Tambah Sambungan"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[82]||(e[82]=l=>Ce.value=!1)},"Tutup")]),t("div",ei,[t("div",null,[e[184]||(e[184]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik",-1)),m(t("select",{"onUpdate:modelValue":e[83]||(e[83]=l=>y.value.point_id=l),class:"input w-full"},[e[183]||(e[183]=t("option",{value:""},"(pilih titik)",-1)),(i(!0),n(A,null,j(K.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,ti))),128))],512),[[R,y.value.point_id]]),ge.value.point_id?(i(),n("div",ai,d((G=ge.value.point_id)==null?void 0:G[0]),1)):g("",!0)]),t("div",li,[t("div",null,[e[186]||(e[186]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("select",{"onUpdate:modelValue":e[84]||(e[84]=l=>y.value.link_type=l),class:"input w-full"},[...e[185]||(e[185]=[t("option",{value:"SPLICE"},"SPLICE",-1),t("option",{value:"PATCH"},"PATCH",-1),t("option",{value:"SPLIT"},"SPLIT",-1)])],512),[[R,y.value.link_type]])]),t("div",null,[e[187]||(e[187]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Loss (dB)",-1)),m(t("input",{"onUpdate:modelValue":e[85]||(e[85]=l=>y.value.loss_db=l),class:"input w-full",placeholder:"0.20"},null,512),[[w,y.value.loss_db]])])]),t("div",si,[t("div",null,[e[189]||(e[189]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"From Cable",-1)),m(t("select",{"onUpdate:modelValue":e[86]||(e[86]=l=>y.value.from_cable_id=l),class:"input w-full"},[e[188]||(e[188]=t("option",{value:""},"(pilih kabel)",-1)),(i(!0),n(A,null,j(B.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,oi))),128))],512),[[R,y.value.from_cable_id]]),ge.value.from_cable_id?(i(),n("div",ri,d((ua=ge.value.from_cable_id)==null?void 0:ua[0]),1)):g("",!0)]),t("div",null,[e[190]||(e[190]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"From Core",-1)),m(t("input",{"onUpdate:modelValue":e[87]||(e[87]=l=>y.value.from_core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[w,y.value.from_core_no]]),ge.value.from_core_no?(i(),n("div",ni,d((da=ge.value.from_core_no)==null?void 0:da[0]),1)):g("",!0)])]),String(y.value.link_type).toUpperCase()!=="SPLIT"?(i(),n("div",ii,[t("div",null,[e[192]||(e[192]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"To Cable",-1)),m(t("select",{"onUpdate:modelValue":e[88]||(e[88]=l=>y.value.to_cable_id=l),class:"input w-full"},[e[191]||(e[191]=t("option",{value:""},"(pilih kabel)",-1)),(i(!0),n(A,null,j(B.value,l=>(i(),n("option",{key:l.id,value:l.id},d(l.name),9,ui))),128))],512),[[R,y.value.to_cable_id]])]),t("div",null,[e[193]||(e[193]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"To Core",-1)),m(t("input",{"onUpdate:modelValue":e[89]||(e[89]=l=>y.value.to_core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[w,y.value.to_core_no]])])])):(i(),n("div",di,[t("div",vi,[t("div",null,[e[194]||(e[194]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Splitter Group (opsional)",-1)),m(t("input",{"onUpdate:modelValue":e[90]||(e[90]=l=>y.value.split_group=l),class:"input w-full",placeholder:"ODP-01 1:8"},null,512),[[w,y.value.split_group]])]),t("div",null,[e[195]||(e[195]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Jumlah Output",-1)),t("div",pi,[m(t("input",{"onUpdate:modelValue":e[91]||(e[91]=l=>ze.value=l),type:"number",min:"1",max:"64",class:"input w-full"},null,512),[[w,ze.value]]),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:e[92]||(e[92]=l=>al(ze.value))},"Buat"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:ll},"Tambah")])])]),(y.value.outputs||[]).length===0?(i(),n("div",ci,[...e[196]||(e[196]=[_(" Output masih kosong. Klik ",-1),t("span",{class:"font-semibold"},"Buat",-1),_(" untuk generate baris output. ",-1)])])):(i(),n("div",bi,[(i(!0),n(A,null,j(y.value.outputs,(l,O)=>(i(),n("div",{key:O,class:"grid grid-cols-12 gap-2 items-center"},[t("div",gi,[m(t("select",{"onUpdate:modelValue":q=>l.to_cable_id=q,class:"input w-full"},[e[197]||(e[197]=t("option",{value:""},"(kabel output)",-1)),(i(!0),n(A,null,j(B.value,q=>(i(),n("option",{key:q.id,value:q.id},d(q.name),9,mi))),128))],8,fi),[[R,l.to_cable_id]])]),t("div",yi,[m(t("input",{"onUpdate:modelValue":q=>l.to_core_no=q,type:"number",min:"1",class:"input w-full",placeholder:"core"},null,8,ki),[[w,l.to_core_no]])]),t("div",xi,[t("button",{class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:q=>sl(O)},"Hapus",8,_i)])]))),128))]))])),t("div",null,[e[198]||(e[198]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[93]||(e[93]=l=>y.value.notes=l),class:"input w-full min-h-[90px]",placeholder:"(opsional)"},null,512),[[w,y.value.notes]])])]),t("div",hi,[t("button",{class:"btn btn-secondary",onClick:e[94]||(e[94]=l=>Ce.value=!1)},"Batal"),t("button",{class:"btn btn-primary",disabled:mt.value,onClick:nl},d(mt.value?"Menyimpan...":"Simpan"),9,wi)])])])):g("",!0)]}),_:1})],64))}};export{Ti as default};
