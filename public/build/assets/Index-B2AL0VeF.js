import{o as ye,c as o,a as re,u as fe,h as xe,m as he,b as t,t as c,j as i,F as y,s as w,e as g,d as C,f as ae,v as se,r as p,y as f}from"./app-PlAuM9nD.js";import{_ as we}from"./AdminLayout-DHPOt8SH.js";const _e={class:"space-y-6 animate-fade-in"},Se={class:"bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 shadow-card overflow-hidden"},Ce={class:"p-5 border-b border-gray-100 dark:border-dark-700 bg-gradient-to-b from-gray-50/80 to-white dark:from-dark-800/60 dark:to-dark-800"},je={class:"flex flex-col md:flex-row md:items-start md:justify-between gap-4"},Me={class:"min-w-0"},Te={class:"mt-1 flex flex-col sm:flex-row sm:items-center gap-2"},Re=["value","disabled"],Ee={value:"",disabled:""},Ae={key:0,label:"Sistem"},Pe=["value"],Le={key:1,label:"Custom"},Be=["value"],Oe={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 border border-amber-200/60 dark:border-amber-900/40"},Ne={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},$e={key:0},ze={key:1},De={key:2},Ie={class:"ml-2"},Ue={key:3,class:"ml-2"},Ve={class:"flex items-center gap-2 shrink-0"},He=["disabled"],Fe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Ke={key:0,class:"p-10 text-center"},Je={key:1,class:"p-6 space-y-6"},Ge={class:"relative rounded-md shadow-sm"},qe=["disabled"],Xe={key:0,class:"text-xs text-amber-600 mt-2 flex items-center"},Ye={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-3 gap-3"},Qe={class:"border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 overflow-hidden"},Ze={class:"overflow-x-auto"},We={class:"min-w-[1040px] w-full text-sm"},et={class:"bg-white/60 dark:bg-dark-900/60"},tt={class:"text-xs font-extrabold text-gray-600 dark:text-gray-300"},rt={class:"divide-y divide-gray-200 dark:divide-dark-700"},at={class:"sticky left-0 z-10 px-4 py-3 bg-white dark:bg-dark-900 border-r border-gray-100 dark:border-dark-700"},st={class:"flex items-start justify-between gap-3"},nt={class:"text-sm font-bold text-gray-900 dark:text-white"},ot={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},it={class:"mt-1 text-[11px] text-gray-500 dark:text-gray-400"},lt={class:"inline-flex items-center gap-2 text-[11px] font-semibold text-gray-600 dark:text-gray-300 select-none"},dt=["checked","disabled","onChange"],ut=["checked","disabled","onChange"],ct={key:1,class:"text-xs text-gray-300 dark:text-dark-600 select-none"},pt={class:"px-4 py-3"},mt={key:0,class:"flex flex-wrap gap-2"},gt=["checked","disabled","onChange"],kt={key:1,class:"text-xs text-gray-400 italic"},bt={key:0,class:"space-y-3"},vt={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},yt={class:"relative w-full sm:w-80"},ft={class:"h-[60vh] sm:h-[420px] overflow-y-auto custom-scrollbar border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 p-4 space-y-4"},xt={class:"flex items-center justify-between mb-3 border-b border-gray-100 dark:border-dark-700 pb-2"},ht={class:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider flex items-center"},wt=["onClick"],_t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},St=["checked","onChange"],Ct={class:"text-sm text-gray-600 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors select-none"},jt={key:0,class:"text-center py-12 text-gray-500"},Mt={class:"flex justify-between items-center text-xs text-gray-500"},Tt={key:1,class:"pt-4 border-t border-gray-100 dark:border-dark-700"},P="/api/v1",Pt={__name:"Index",setup(Rt){const _=p([]),R=p([]),L=p(!1),j=p(!1),M=p(!1),S=p(""),x=p(!1),k=p("none"),m=p(null),l=p({id:null,name:"",permissions:[]}),N=p(null),K=p(""),ne=["admin","owner"],$=[{key:"view",label:"Lihat"},{key:"create",label:"Tambah"},{key:"edit",label:"Edit"},{key:"delete",label:"Hapus"},{key:"approve",label:"Approve"},{key:"export",label:"Export"},{key:"manage",label:"Manage"}],oe=[{key:"dashboard",label:"Dashboard",description:"Ringkasan & statistik.",perms:{view:"view dashboard"}},{key:"installations",label:"Pasang Baru",description:"Instalasi, monitoring, approval.",perms:{view:"view installations",create:"create installations",edit:"edit installations",delete:"delete installations",approve:"approve installations"},extras:[{label:"Kirim rekap",perm:"send installations recap"},{label:"Riwayat",perm:"view riwayat installations"}]},{key:"team",label:"Tim",description:"Teknisi/sales/staff.",perms:{view:"view team",create:"create team",edit:"edit team",delete:"delete team",manage:"manage team"}},{key:"teknisi",label:"Teknisi",description:"Tugas, riwayat, rekap.",perms:{view:"view teknisi",edit:"edit teknisi"},extras:[{label:"Kirim rekap",perm:"send teknisi recap"}]},{key:"maps",label:"Maps",description:"Tracking teknisi.",perms:{view:"view maps",manage:"manage maps"}},{key:"chat",label:"Chat",description:"Chat admin.",perms:{view:"view chat",create:"send chat",edit:"edit chat",delete:"delete chat"}},{key:"leads",label:"Leads",description:"Prospek & konversi.",perms:{view:"view leads",create:"create leads",edit:"edit leads",delete:"delete leads"},extras:[{label:"Convert",perm:"convert leads"},{label:"Bulk",perm:"bulk leads"}]},{key:"customers",label:"Pelanggan",description:"Data pelanggan.",perms:{view:"view customers",create:"create customers",edit:"edit customers",delete:"delete customers"}},{key:"plans",label:"Paket Layanan",description:"Produk/paket.",perms:{view:"view plans",create:"create plans",edit:"edit plans",delete:"delete plans"}},{key:"invoices",label:"Invoice",description:"Tagihan.",perms:{view:"view invoices",create:"create invoices",edit:"edit invoices",delete:"delete invoices"}},{key:"payments",label:"Pembayaran",description:"Transaksi.",perms:{view:"view payments",create:"create payments",edit:"edit payments",delete:"delete payments"}},{key:"reports",label:"Laporan",description:"Analitik & export.",perms:{view:"view reports",export:"export reports"}},{key:"finance",label:"Keuangan",description:"Transaksi & approval.",perms:{view:"view finance",create:"create finance",edit:"edit finance",delete:"delete finance",approve:"approve finance",export:"export finance",manage:"manage finance"}},{key:"fiber",label:"Kabel FO",description:"Pemetaan jalur kabel, titik sambungan, dan data putus.",perms:{view:"view fiber",create:"create fiber",edit:"edit fiber",delete:"delete fiber",manage:"manage fiber"}},{key:"olts",label:"OLT",description:"Provisioning OLT/ONU.",perms:{view:"view olts",create:"create olts",edit:"edit olts",delete:"delete olts",manage:"manage olt"}},{key:"isolir",label:"Isolir",description:"Suspend/unsuspend.",perms:{manage:"manage isolir"}},{key:"settings",label:"Pengaturan Sistem",description:"Settings, roles, update.",perms:{manage:"manage settings"},extras:[{label:"Kelola role",perm:"manage roles"},{label:"Update sistem",perm:"manage system update"}]}];function z(r){return(r||"").toString().replace(/_/g," ").trim()}function h(r){const e=(r||"").toString().toLowerCase().trim();return ne.includes(e)}function J(r){return JSON.parse(JSON.stringify(r))}function D(r){const e=[],s=new Set;return(r||[]).forEach(n=>{!n||s.has(n)||(s.add(n),e.push(n))}),e}function G(r){return{name:((r==null?void 0:r.name)||"").toString().trim(),permissions:D((r==null?void 0:r.permissions)||[]).slice().sort()}}function E(){N.value=J(l.value),K.value=JSON.stringify(G(l.value))}const I=f(()=>JSON.stringify(G(l.value))!==K.value);function U(){return I.value?confirm("Perubahan belum disimpan. Lanjut dan buang perubahan?"):!0}const v=f(()=>m.value&&(_.value||[]).find(r=>String(r.id)===String(m.value))||null),T=f(()=>k.value==="edit"),ie=f(()=>k.value==="create"),V=f(()=>{const r=(_.value||[]).slice();return r.sort((e,s)=>{const n=((e==null?void 0:e.name)||"").toString().toLowerCase(),d=((s==null?void 0:s.name)||"").toString().toLowerCase(),a=h(n),u=h(d);return a!==u?a?-1:1:n.localeCompare(d)}),r}),q=f(()=>V.value.filter(r=>h(r==null?void 0:r.name))),X=f(()=>V.value.filter(r=>!h(r==null?void 0:r.name)));function le(r){const e=(r??"").toString().trim();if(!e)return;const s=(_.value||[]).find(n=>String(n.id)===e)||null;s&&B(s)}async function H(){L.value=!0;try{const e=await(await fetch(`${P}/roles`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);if(_.value=Array.isArray(e)?e:[],k.value!=="create"&&!(m.value&&_.value.some(n=>String(n.id)===String(m.value)))){const n=V.value[0];n?B(n,{force:!0}):(k.value="none",m.value=null)}}catch(r){console.error("Error loading roles:",r),_.value=[]}finally{L.value=!1}}async function de(){j.value=!0;try{const e=await(await fetch(`${P}/permissions`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);R.value=Array.isArray(e)?e:[]}catch(r){console.error("Error loading permissions:",r),R.value=[]}finally{j.value=!1}}function Y(){U()&&(k.value="create",m.value=null,l.value={id:null,name:"",permissions:[]},S.value="",x.value=!1,E())}function B(r,e={}){!e.force&&!U()||(k.value="edit",m.value=(r==null?void 0:r.id)??null,l.value={id:(r==null?void 0:r.id)??null,name:(r==null?void 0:r.name)??"",permissions:((r==null?void 0:r.permissions)||[]).map(n=>n.name)},S.value="",x.value=!1,E())}function ue(){const r=v.value;r&&U()&&(k.value="create",m.value=null,l.value={id:null,name:`${r.name}_copy`,permissions:(r.permissions||[]).map(e=>e.name)},S.value="",x.value=!1,E())}function ce(){N.value&&(l.value=J(N.value))}async function pe(){const r=(l.value.name||"").toString().trim();if(r){M.value=!0;try{const e=T.value?`${P}/roles/${l.value.id}`:`${P}/roles`,s=T.value?"PUT":"POST",n={name:r,permissions:D(l.value.permissions||[])},d=await fetch(e,{method:s,credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),a=await d.json().catch(()=>null);if(!d.ok){alert(a&&(a.message||a.msg)?a.message||a.msg:"Gagal menyimpan role");return}await H();const u=a==null?void 0:a.id,b=u?_.value.find(te=>String(te.id)===String(u)):null;b?B(b,{force:!0}):k.value!=="create"&&v.value&&B(v.value,{force:!0})}catch(e){console.error("Error saving role:",e),alert("Terjadi kesalahan sistem")}finally{M.value=!1}}}async function me(){const r=v.value;if(r&&!h(r.name)&&confirm(`Yakin ingin menghapus role "${r.name}"? Tindakan ini tidak dapat dibatalkan.`)){M.value=!0;try{const e=await fetch(`${P}/roles/${r.id}`,{method:"DELETE",credentials:"same-origin",headers:{Accept:"application/json"}}),s=await e.json().catch(()=>null);if(!e.ok){alert(s&&(s.message||s.msg)?s.message||s.msg:"Gagal menghapus role");return}k.value="none",m.value=null,l.value={id:null,name:"",permissions:[]},S.value="",x.value=!1,E(),await H()}catch(e){console.error("Error deleting role:",e),alert("Terjadi kesalahan sistem")}finally{M.value=!1}}}const Q=f(()=>{const r={},e=S.value.toLowerCase().trim();return(R.value||[]).forEach(s=>{if(!(s!=null&&s.name))return;const n=s.name.toLowerCase();if(e&&!n.includes(e))return;const d=s.name.split(" "),a=d.length>1?d.slice(1).join(" "):"System",u=a.charAt(0).toUpperCase()+a.slice(1);r[u]||(r[u]=[]),r[u].push(s)}),Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{})});function F(r){const e=l.value.permissions||[],s=e.indexOf(r);s===-1?e.push(r):e.splice(s,1),l.value.permissions=e}function ge(r){if(r.every(n=>l.value.permissions.includes(n.name))){const n=new Set(r.map(d=>d.name));l.value.permissions=(l.value.permissions||[]).filter(d=>!n.has(d));return}const s=new Set(l.value.permissions||[]);r.forEach(n=>s.add(n.name)),l.value.permissions=Array.from(s)}const Z=f(()=>new Set((R.value||[]).map(r=>r.name)));function W(r){if(!r)return!1;const e=Z.value;return!e||e.size===0?!0:e.has(r)}function A(r,e){var s;return((s=r==null?void 0:r.perms)==null?void 0:s[e])||null}function O(r){const e=[];($||[]).forEach(d=>{const a=A(r,d.key);a&&e.push(a)}),((r==null?void 0:r.extras)||[]).forEach(d=>{d!=null&&d.perm&&e.push(d.perm)});const s=D(e),n=Z.value;return!n||n.size===0?s:s.filter(d=>n.has(d))}function ee(r){return O(r).length}function ke(r){const e=O(r);if(e.length===0)return 0;const s=new Set(l.value.permissions||[]);return e.filter(n=>s.has(n)).length}function be(r){const e=O(r);if(e.length===0)return!1;const s=new Set(l.value.permissions||[]);return e.every(n=>s.has(n))}function ve(r){const e=O(r);if(e.length===0)return;const s=new Set(l.value.permissions||[]);e.every(d=>s.has(d))?e.forEach(d=>s.delete(d)):e.forEach(d=>s.add(d)),l.value.permissions=Array.from(s)}return ye(()=>{H(),de(),E()}),(r,e)=>(i(),o(y,null,[re(fe(xe),{title:"Kelola Role"}),re(we,null,{default:he(()=>{var s,n,d;return[t("div",_e,[t("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-white dark:bg-dark-800 p-6 rounded-2xl shadow-card border border-gray-100 dark:border-dark-700"},[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-primary-400"}," Role & Permissions "),t("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"Atur akses dan keamanan sistem dengan cepat.")],-1)),t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",onClick:Y,class:"group relative inline-flex items-center justify-center px-5 py-3 text-sm font-medium text-white transition-all duration-200 bg-primary-600 border border-transparent rounded-xl hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 shadow-glow-blue hover:shadow-glow-blue-lg overflow-hidden"},[...e[4]||(e[4]=[t("span",{class:"absolute inset-0 w-full h-full -mt-1 rounded-lg opacity-30 bg-gradient-to-b from-transparent via-transparent to-black"},null,-1),t("svg",{class:"w-5 h-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",null,"Role Baru",-1)])])])]),t("section",Se,[t("div",Ce,[t("div",je,[t("div",Me,[e[6]||(e[6]=t("label",{class:"block text-[11px] font-extrabold text-gray-600 dark:text-gray-300 uppercase tracking-wider"}," Role ",-1)),t("div",Te,[t("select",{value:m.value?String(m.value):"",onChange:e[0]||(e[0]=a=>le(a.target.value)),disabled:L.value,class:"w-full sm:w-[360px] rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-900 dark:text-white text-sm px-3 py-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-60 disabled:cursor-not-allowed"},[t("option",Ee,c(L.value?"Memuat role...":"Pilih role..."),1),q.value.length>0?(i(),o("optgroup",Ae,[(i(!0),o(y,null,w(q.value,a=>(i(),o("option",{key:a.id,value:a.id},c(z(a.name))+" ("+c((a.permissions||[]).length)+") ",9,Pe))),128))])):g("",!0),X.value.length>0?(i(),o("optgroup",Le,[(i(!0),o(y,null,w(X.value,a=>(i(),o("option",{key:a.id,value:a.id},c(z(a.name))+" ("+c((a.permissions||[]).length)+") ",9,Be))),128))])):g("",!0)],40,Re),I.value?(i(),o("span",Oe," Belum disimpan ")):g("",!0)]),t("div",Ne,[ie.value?(i(),o("span",$e,"Mode: buat role baru.")):v.value?(i(),o("span",ze,"Edit: "+c(z(v.value.name))+".",1)):(i(),o("span",De,"Pilih role dari dropdown untuk mulai mengatur akses.")),t("span",Ie,"Dipilih: "+c(l.value.permissions.length)+" permission",1),j.value?(i(),o("span",Ue,"(memuat katalog...)")):g("",!0)])]),t("div",Ve,[T.value?(i(),o("button",{key:0,type:"button",onClick:ue,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Duplikat ")):g("",!0),I.value?(i(),o("button",{key:1,type:"button",onClick:ce,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Reset ")):g("",!0),t("button",{type:"button",onClick:pe,disabled:M.value||!l.value.name.trim(),class:"inline-flex items-center justify-center px-4 py-2 text-xs font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-glow-blue"},[M.value?(i(),o("svg",Fe,[...e[7]||(e[7]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):g("",!0),e[8]||(e[8]=C(" Simpan ",-1))],8,He)])])]),k.value==="none"?(i(),o("div",Ke,[t("div",{class:"max-w-md mx-auto"},[e[9]||(e[9]=t("div",{class:"text-lg font-extrabold text-gray-900 dark:text-white"},"Pilih role",-1)),e[10]||(e[10]=t("div",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Pilih role dari dropdown di atas untuk mengubah akses, atau buat role baru. ",-1)),t("button",{type:"button",onClick:Y,class:"mt-5 inline-flex items-center justify-center px-5 py-3 text-sm font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-glow-blue"}," Buat Role Baru ")])])):(i(),o("div",Je,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"},[C(" Nama Identitas Role "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Ge,[e[11]||(e[11]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})])],-1)),ae(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.name=a),type:"text",class:"input w-full pl-10 py-2.5 border-gray-300 dark:border-dark-600 focus:ring-primary-500 focus:border-primary-500 rounded-lg dark:bg-dark-900 dark:text-white",placeholder:"Contoh: staff_admin, supervisor_teknisi",disabled:T.value&&h((s=v.value)==null?void 0:s.name)},null,8,qe),[[se,l.value.name]])]),T.value&&h((n=v.value)==null?void 0:n.name)?(i(),o("p",Xe,[...e[12]||(e[12]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),C(" Role sistem tidak dapat diubah namanya. ",-1)])])):g("",!0)]),t("div",null,[t("div",Ye,[e[15]||(e[15]=t("div",null,[t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Matrix Akses per Modul"),t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"}," Centang permission per aksi. Untuk permission khusus, aktifkan mode lanjutan. ")],-1)),t("button",{type:"button",onClick:e[2]||(e[2]=a=>x.value=!x.value),class:"inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"},[e[14]||(e[14]=t("svg",{class:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),C(" "+c(x.value?"Sembunyikan Mode Lanjutan":"Tampilkan Mode Lanjutan"),1)])]),t("div",Qe,[t("div",Ze,[t("table",We,[t("thead",et,[t("tr",tt,[e[16]||(e[16]=t("th",{class:"sticky left-0 z-10 text-left px-4 py-3 bg-white/60 dark:bg-dark-900/60 border-b border-gray-200 dark:border-dark-700"}," Modul ",-1)),(i(),o(y,null,w($,a=>t("th",{key:a.key,class:"px-3 py-3 text-center border-b border-gray-200 dark:border-dark-700 whitespace-nowrap"},c(a.label),1)),64)),e[17]||(e[17]=t("th",{class:"px-4 py-3 text-left border-b border-gray-200 dark:border-dark-700"},"Extra",-1))])]),t("tbody",rt,[(i(),o(y,null,w(oe,a=>t("tr",{key:a.key,class:"bg-white dark:bg-dark-900 hover:bg-gray-50 dark:hover:bg-dark-800/60 transition-colors"},[t("td",at,[t("div",st,[t("div",null,[t("div",nt,c(a.label),1),t("div",ot,c(a.description),1),t("div",it," Terpilih: "+c(ke(a))+"/"+c(ee(a)),1)]),t("label",lt,[t("input",{type:"checkbox",checked:be(a),disabled:j.value||ee(a)===0,onChange:u=>ve(a),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,dt),e[18]||(e[18]=C(" Semua ",-1))])])]),(i(),o(y,null,w($,u=>t("td",{key:u.key,class:"px-3 py-3 text-center"},[A(a,u.key)?(i(),o("input",{key:0,type:"checkbox",checked:l.value.permissions.includes(A(a,u.key)),disabled:j.value||!W(A(a,u.key)),onChange:b=>F(A(a,u.key)),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,ut)):(i(),o("span",ct,"-"))])),64)),t("td",pt,[(a.extras||[]).length>0?(i(),o("div",mt,[(i(!0),o(y,null,w(a.extras,u=>(i(),o("label",{key:u.perm,class:"inline-flex items-center gap-2 px-2 py-1 rounded-lg border border-gray-200 dark:border-dark-700 bg-gray-50 dark:bg-dark-800 text-[11px] font-semibold text-gray-700 dark:text-gray-200 select-none"},[t("input",{type:"checkbox",checked:l.value.permissions.includes(u.perm),disabled:j.value||!W(u.perm),onChange:b=>F(u.perm),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed"},null,40,gt),t("span",null,c(u.label),1)]))),128))])):(i(),o("div",kt,"Tidak ada."))])])),64))])])]),e[19]||(e[19]=t("div",{class:"px-4 py-3 text-xs text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-dark-700"},' Tips: Gunakan "Semua" untuk toggle satu modul. Untuk permission yang tidak muncul di matrix, gunakan Mode Lanjutan. ',-1))])]),x.value?(i(),o("div",bt,[t("div",vt,[e[21]||(e[21]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"}," Mode Lanjutan: Checklist Permission ",-1)),t("div",yt,[e[20]||(e[20]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),ae(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>S.value=a),type:"text",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-dark-700 rounded-xl focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-900 dark:text-white",placeholder:"Cari permission..."},null,512),[[se,S.value]])])]),t("div",ft,[(i(!0),o(y,null,w(Q.value,(a,u)=>(i(),o("div",{key:u,class:"bg-white dark:bg-dark-900 rounded-lg border border-gray-100 dark:border-dark-700 p-4 shadow-sm"},[t("div",xt,[t("h4",ht,[e[22]||(e[22]=t("span",{class:"w-1.5 h-4 bg-primary-500 rounded-full mr-2"},null,-1)),C(" "+c(u),1)]),t("button",{type:"button",onClick:b=>ge(a),class:"text-xs text-primary-600 hover:text-primary-700 font-semibold hover:underline"}," Toggle Semua ",8,wt)]),t("div",_t,[(i(!0),o(y,null,w(a,b=>(i(),o("label",{key:b.id,class:"group flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-800 cursor-pointer transition-colors border border-transparent hover:border-gray-200 dark:hover:border-dark-700"},[t("input",{type:"checkbox",checked:l.value.permissions.includes(b.name),onChange:te=>F(b.name),class:"mt-0.5 rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"},null,40,St),t("span",Ct,c(b.name),1)]))),128))])]))),128)),Object.keys(Q.value).length===0?(i(),o("div",jt,[...e[23]||(e[23]=[t("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",null,"Tidak ada permission yang cocok dengan pencarian.",-1)])])):g("",!0)]),t("div",Mt,[t("span",null,"Total Terpilih: "+c(l.value.permissions.length),1),t("span",null,"Total Tersedia: "+c(R.value.length),1)])])):g("",!0),T.value&&!h((d=v.value)==null?void 0:d.name)?(i(),o("div",Tt,[t("div",{class:"flex items-center justify-between gap-3"},[e[25]||(e[25]=t("div",null,[t("div",{class:"text-sm font-extrabold text-gray-900 dark:text-white"},"Danger Zone"),t("div",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Hapus role ini dari sistem.")],-1)),t("button",{type:"button",onClick:me,class:"inline-flex justify-center items-center px-4 py-2 text-xs font-semibold text-red-600 bg-red-50 dark:bg-red-900/20 border border-transparent rounded-xl hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"},[...e[24]||(e[24]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),C(" Hapus Role ",-1)])])])])):g("",!0)]))])])]}),_:1})],64))}};export{Pt as default};
