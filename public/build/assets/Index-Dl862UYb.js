import{C as yt,E as He,o as mt,G as xt,D as ft,c as n,a as ze,u as kt,h as _t,m as ht,b as t,t as v,f as m,x as j,j as o,e as b,d as G,i as Ee,n as se,F as R,s as W,w as re,v as w,r as y,y as ne,z as wt}from"./app-CZ15VHRC.js";import{_ as Ct}from"./AdminLayout-BqGLF0av.js";const Nt={class:"space-y-4 animate-fade-in"},Lt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 bg-white dark:bg-dark-800 p-5 rounded-xl shadow-card border border-gray-100 dark:border-dark-700"},Tt={class:"flex flex-wrap items-center gap-2"},Et={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},Pt={class:"font-semibold text-gray-900 dark:text-white"},St={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},$t={class:"font-semibold text-gray-900 dark:text-white"},Ot={class:"px-3 py-2 rounded-lg bg-red-50/60 dark:bg-red-900/10 border border-red-200/60 dark:border-red-900/30 text-xs"},Ft={class:"font-semibold text-red-700 dark:text-red-300"},Mt={class:"hidden lg:flex items-center gap-2 ml-2"},Ut=["disabled"],Vt={key:0,class:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-900/30 text-amber-800 dark:text-amber-200 rounded-xl p-4 text-sm"},Bt={key:1,class:"bg-white dark:bg-dark-800 border border-gray-100 dark:border-dark-700 rounded-xl p-6"},Dt={key:2,class:"grid grid-cols-1 lg:grid-cols-12 gap-4"},At={class:"lg:col-span-8 bg-white dark:bg-dark-800 rounded-xl shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden"},It={class:"flex flex-wrap items-center gap-2 p-3 border-b border-gray-100 dark:border-dark-700"},jt={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Gt={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Rt={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Kt={class:"ml-auto flex items-center gap-2 lg:hidden"},Ht=["disabled"],zt={class:"relative"},Jt={key:0,class:"absolute bottom-3 left-3 right-3 lg:right-auto lg:max-w-md bg-white/90 dark:bg-dark-900/80 backdrop-blur border border-gray-200 dark:border-white/10 rounded-xl p-3 text-xs text-gray-700 dark:text-gray-200 shadow-lg"},Zt={class:"font-semibold"},Xt={class:"uppercase"},Wt={class:"mt-2 flex items-center gap-2"},Yt={class:"lg:col-span-4 bg-white dark:bg-dark-800 rounded-xl shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden"},qt={class:"flex items-center border-b border-gray-100 dark:border-dark-700"},Qt={class:"p-4"},ea={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ta={key:1,class:"text-sm text-red-600 dark:text-red-300"},aa={key:2,class:"space-y-3"},la={class:"flex items-center justify-between"},sa={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ra={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},na=["onClick"],oa={class:"flex items-start justify-between gap-2"},ia={class:"text-sm font-semibold text-gray-900 dark:text-white"},da={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},ua={key:0},va={key:1,class:"ml-2"},pa={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ca={class:"font-medium text-gray-700 dark:text-gray-200"},ba={class:"font-medium text-gray-700 dark:text-gray-200"},ga={class:"flex items-center gap-1 shrink-0"},ya=["onClick"],ma=["onClick"],xa={key:3,class:"space-y-3"},fa={class:"flex items-center justify-between"},ka={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},_a={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},ha=["onClick"],wa={class:"flex items-start justify-between gap-2"},Ca={class:"text-sm font-semibold text-gray-900 dark:text-white"},Na={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},La={key:0},Ta={key:1,class:"ml-2"},Ea={class:"flex items-center gap-1 shrink-0"},Pa=["onClick"],Sa=["onClick"],$a={key:4,class:"space-y-3"},Oa={class:"flex items-center justify-between"},Fa={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Ma={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},Ua=["onClick"],Va={class:"flex items-start justify-between gap-2"},Ba={class:"text-xs font-bold"},Da={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},Aa={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Ia={key:0,class:"ml-2"},ja={key:0,class:"text-xs text-gray-600 dark:text-gray-300 mt-1 line-clamp-2"},Ga={class:"flex items-center gap-1 shrink-0"},Ra=["onClick"],Ka=["onClick"],Ha={key:0,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},za={class:"relative w-full max-w-2xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},Ja={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Za={class:"font-semibold text-gray-900 dark:text-white"},Xa={class:"p-4 space-y-3"},Wa={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ya={key:0,class:"text-xs text-red-600 mt-1"},qa={key:0,class:"text-xs text-red-600 mt-1"},Qa={key:0,class:"text-xs text-red-600 mt-1"},el={key:0,class:"text-xs text-red-600 mt-1"},tl=["value"],al=["value"],ll={class:"md:col-span-2"},sl={class:"flex items-center gap-2"},rl={class:"md:col-span-2"},nl={class:"rounded-xl border border-gray-100 dark:border-dark-700 p-3"},ol={class:"flex items-center justify-between gap-2"},il={class:"text-xs text-gray-500 dark:text-gray-400"},dl={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},ul=["disabled"],vl={key:1,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},pl={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},cl={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},bl={class:"font-semibold text-gray-900 dark:text-white"},gl={class:"p-4 space-y-3"},yl={key:0,class:"text-xs text-red-600 mt-1"},ml={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},xl={key:0,class:"text-xs text-red-600 mt-1"},fl={key:0,class:"text-xs text-red-600 mt-1"},kl={class:"flex items-center gap-2"},_l={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},hl=["disabled"],wl={key:2,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},Cl={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},Nl={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Ll={class:"font-semibold text-gray-900 dark:text-white"},Tl={class:"p-4 space-y-3"},El=["value"],Pl=["value"],Sl={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},$l={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ol=["disabled"],Fl={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ml={key:0,class:"text-xs text-red-600 mt-1"},Ul={key:0,class:"text-xs text-red-600 mt-1"},Vl={class:"flex items-center gap-2"},Bl={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},Dl=["disabled"],jl={__name:"Index",props:{tenantId:{type:Number,default:0},warning:{type:String,default:null}},setup(Je){const p=yt("toast"),Pe=Je,Se=wt(),$e=ne(()=>{var a,e;return((e=(a=Se.props.auth)==null?void 0:a.user)==null?void 0:e.permissions)||[]}),Ze=ne(()=>{var a,e;return(((e=(a=Se.props.auth)==null?void 0:a.user)==null?void 0:e.role)||"").toString().toLowerCase().trim()});function Xe(a){const e=(a||"").toString().toLowerCase().trim();return e==="svp lapangan"?"svp_lapangan":e}function be(a){const e=Xe(Ze.value);return["admin","owner"].includes(e)||$e.value.includes("manage fiber")?!0:$e.value.includes(a)}const Oe=ne(()=>be("view fiber")),Y=ne(()=>be("create fiber")),q=ne(()=>be("edit fiber")),Q=ne(()=>be("delete fiber")),oe=y(!1),ie=y(""),ee=y({cables:0,points:0,breaks_total:0,breaks_open:0}),K=y([]),$=y([]),de=y([]),L=y("cables"),ue=y(!0),ve=y(!0),pe=y(!0),E=y(null),P=y(null),S=y(null);async function B(a,e={}){const r=await fetch(a,{credentials:"same-origin",headers:{Accept:"application/json",...e.headers||{}},...e}),s=await r.text();let g=null;try{g=s?JSON.parse(s):null}catch{g=null}return{ok:r.ok,status:r.status,data:g,text:s}}async function O(){var a,e,r,s,g,f,h,d;if(Oe.value){oe.value=!0,ie.value="";try{const[x,ce]=await Promise.all([B("/api/v1/fiber/map-data"),B("/api/v1/fiber/summary")]);if(!x.ok){const _e=((a=x.data)==null?void 0:a.message)||`Gagal memuat data fiber (HTTP ${x.status}).`;throw new Error(_e)}ce.ok?ee.value=((e=ce.data)==null?void 0:e.data)||ee.value:ee.value={cables:0,points:0,breaks_total:0,breaks_open:0},K.value=((s=(r=x.data)==null?void 0:r.data)==null?void 0:s.cables)||[],$.value=((f=(g=x.data)==null?void 0:g.data)==null?void 0:f.points)||[],de.value=((d=(h=x.data)==null?void 0:h.data)==null?void 0:d.breaks)||[],De(),Qe()}catch(x){console.error("Fiber: loadAll failed",x),ie.value=x&&x.message?x.message:"Gagal memuat data fiber."}finally{oe.value=!1}}}const he=y(null);let k=null,te=null,ae=null,H=null,z=null,J=null,D=null,Fe=!1;const A=y("voyager"),we={voyager:{label:"Voyager",tile:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",tileOpts:{maxZoom:19,subdomains:"abcd"},labels:null},light:{label:"Light",tile:"https://{s}.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}{r}.png",tileOpts:{maxZoom:19,subdomains:"abcd"},labels:null},satellite:{label:"Satelit",tile:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",tileOpts:{maxZoom:19},labels:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",labelOpts:{maxZoom:19,opacity:.85}}};function Me(){if(!k)return;const a=we[A.value]||we.voyager;if(te){try{k.removeLayer(te)}catch{}te=null}if(ae){try{k.removeLayer(ae)}catch{}ae=null}te=window.L.tileLayer(a.tile,{attribution:"&copy; OpenStreetMap contributors",...a.tileOpts||{}}),te.addTo(k),a.labels&&(ae=window.L.tileLayer(a.labels,{...a.labelOpts||{}}),ae.addTo(k))}function We(){!window.L||!he.value||(k=window.L.map(he.value,{zoomControl:!0}).setView([-2.5489,118.0149],5),H=window.L.layerGroup().addTo(k),z=window.L.layerGroup().addTo(k),J=window.L.layerGroup().addTo(k),D=window.L.layerGroup().addTo(k),Me(),k.on("click",Ve))}function Ye(){if(k){try{k.off("click",Ve)}catch{}try{k.remove()}catch{}k=null,te=null,ae=null,H=null,z=null,J=null,D=null}}const _=y(null);function Ue(a){const e=Number(a);return Number.isFinite(e)?Math.round(e*1e7)/1e7:null}function Ve(a){if(!(a!=null&&a.latlng))return;const e=Ue(a.latlng.lat),r=Ue(a.latlng.lng);if(_.value==="pickPoint"){c.value.latitude=e,c.value.longitude=r,_.value=null,p&&p.success("Lokasi titik dipilih dari peta."),C();return}if(_.value==="pickBreak"){u.value.latitude=e,u.value.longitude=r,_.value=null,p&&p.success("Lokasi putus dipilih dari peta."),C();return}if(_.value==="drawCable"){const s=Array.isArray(i.value.path)?i.value.path:[];s.push({lat:e,lng:r}),i.value.path=s,C()}}function N(){_.value=null,C()}function Ce(a){const e=document.createElement("div");return e.className="text-sm",(a||[]).forEach(r=>{const s=document.createElement("div");s.textContent=String(r??""),e.appendChild(s)}),e}function le(a){const e=Number(a||0);if(!e)return null;const r=($.value||[]).find(s=>Number(s==null?void 0:s.id)===e);return r?String(r.name||""):null}function Be(a){const e=Number(a||0);if(!e)return null;const r=(K.value||[]).find(s=>Number(s==null?void 0:s.id)===e);return r?String(r.name||""):null}function qe(a){const e=String(a||"").toUpperCase();return e==="OPEN"?{stroke:"#dc2626",fill:"#ef4444"}:e==="IN_PROGRESS"?{stroke:"#b45309",fill:"#f59e0b"}:e==="FIXED"?{stroke:"#047857",fill:"#10b981"}:{stroke:"#64748b",fill:"#94a3b8"}}function De(){!k||!window.L||(Ne(),Le(),Te(),C())}function Ne(){H&&(H.clearLayers(),ue.value&&(K.value||[]).forEach(a=>{const e=Array.isArray(a==null?void 0:a.path)?a.path:null;if(!e||e.length<2)return;const r=e.map(x=>[Number(x==null?void 0:x.lat),Number(x==null?void 0:x.lng)]).filter(x=>Number.isFinite(x[0])&&Number.isFinite(x[1]));if(r.length<2)return;const s=Number(a==null?void 0:a.id)===Number(E.value||0),g=((a==null?void 0:a.map_color)||"#2563eb").toString(),f=window.L.polyline(r,{color:g,weight:s?6:4,opacity:.9});f.on("click",()=>{E.value=a.id,P.value=null,S.value=null,L.value="cables",Ne()});const h=le(a==null?void 0:a.from_point_id)||"-",d=le(a==null?void 0:a.to_point_id)||"-";f.bindPopup(Ce([`Kabel: ${(a==null?void 0:a.name)||"-"}`,a!=null&&a.code?`Kode: ${a.code}`:null,a!=null&&a.cable_type?`Tipe: ${a.cable_type}`:null,a!=null&&a.core_count?`Core: ${a.core_count}`:null,`Dari: ${h}`,`Ke: ${d}`].filter(Boolean))),f.addTo(H)}))}function Le(){z&&(z.clearLayers(),ve.value&&($.value||[]).forEach(a=>{const e=Number(a==null?void 0:a.latitude),r=Number(a==null?void 0:a.longitude);if(!Number.isFinite(e)||!Number.isFinite(r))return;const s=Number(a==null?void 0:a.id)===Number(P.value||0),g=window.L.circleMarker([e,r],{radius:s?8:6,color:"#0f766e",weight:2,fillColor:"#14b8a6",fillOpacity:.9});g.on("click",()=>{P.value=a.id,E.value=null,S.value=null,L.value="points",Le()}),g.bindPopup(Ce([`Titik: ${(a==null?void 0:a.name)||"-"}`,a!=null&&a.point_type?`Tipe: ${a.point_type}`:null,`Koordinat: ${e}, ${r}`].filter(Boolean))),g.addTo(z)}))}function Te(){J&&(J.clearLayers(),pe.value&&(de.value||[]).forEach(a=>{const e=Number(a==null?void 0:a.latitude),r=Number(a==null?void 0:a.longitude);if(!Number.isFinite(e)||!Number.isFinite(r))return;const s=qe(a==null?void 0:a.status),g=Number(a==null?void 0:a.id)===Number(S.value||0),f=window.L.circleMarker([e,r],{radius:g?9:7,color:s.stroke,weight:2,fillColor:s.fill,fillOpacity:.9});f.on("click",()=>{S.value=a.id,E.value=null,P.value=null,L.value="breaks",Te()});const h=Be(a==null?void 0:a.cable_id)||(a!=null&&a.cable_id?`#${a.cable_id}`:"-"),d=le(a==null?void 0:a.point_id)||(a!=null&&a.point_id?`#${a.point_id}`:"-");f.bindPopup(Ce([`PUTUS: ${String((a==null?void 0:a.status)||"OPEN").toUpperCase()}`,`Kabel: ${h}`,`Titik: ${d}`,a!=null&&a.severity?`Severity: ${a.severity}`:null].filter(Boolean))),f.addTo(J)}))}function C(){if(!(!D||!window.L)){if(D.clearLayers(),M.value&&c.value.latitude!==null&&c.value.longitude!==null){const a=Number(c.value.latitude),e=Number(c.value.longitude);Number.isFinite(a)&&Number.isFinite(e)&&window.L.circleMarker([a,e],{radius:7,color:"#0ea5e9",weight:2,fillColor:"#38bdf8",fillOpacity:.85}).addTo(D)}if(V.value&&u.value.latitude!==null&&u.value.longitude!==null){const a=Number(u.value.latitude),e=Number(u.value.longitude);Number.isFinite(a)&&Number.isFinite(e)&&window.L.circleMarker([a,e],{radius:8,color:"#f97316",weight:2,fillColor:"#fb923c",fillOpacity:.85}).addTo(D)}if(F.value&&Array.isArray(i.value.path)&&i.value.path.length>0){const a=i.value.path.map(e=>[Number(e==null?void 0:e.lat),Number(e==null?void 0:e.lng)]).filter(e=>Number.isFinite(e[0])&&Number.isFinite(e[1]));a.forEach(e=>{window.L.circleMarker(e,{radius:4,color:"#1d4ed8",weight:2,fillColor:"#60a5fa",fillOpacity:.95}).addTo(D)}),a.length>=2&&window.L.polyline(a,{color:"#1d4ed8",weight:4,opacity:.9,dashArray:"6, 8"}).addTo(D)}}}function Qe(){if(!k||Fe)return;const a=[];try{H&&ue.value&&H.eachLayer(e=>{e.getBounds&&a.push(e.getBounds())})}catch{}try{z&&ve.value&&z.eachLayer(e=>{e.getLatLng&&a.push(window.L.latLngBounds([e.getLatLng(),e.getLatLng()]))})}catch{}try{J&&pe.value&&J.eachLayer(e=>{e.getLatLng&&a.push(window.L.latLngBounds([e.getLatLng(),e.getLatLng()]))})}catch{}if(a.length!==0)try{let e=null;a.forEach(r=>{e?e.extend(r):e=r}),e&&e.isValid&&e.isValid()&&(k.fitBounds(e.pad(.2)),Fe=!0)}catch{}}function et(a){const e=String(a||"OPEN").toUpperCase();return e==="IN_PROGRESS"?"IN PROGRESS":e}function Ae(a){if(!a)return"";const e=new Date(a);if(!Number.isFinite(e.getTime()))return"";const r=s=>String(s).padStart(2,"0");return`${e.getFullYear()}-${r(e.getMonth()+1)}-${r(e.getDate())}T${r(e.getHours())}:${r(e.getMinutes())}`}function Z(a,e,r=17){!k||!Number.isFinite(a)||!Number.isFinite(e)||k.setView([a,e],r,{animate:!0})}const F=y(!1),ge=y("create"),ye=y(!1),T=y({}),i=y({id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],notes:""});function Ie(){i.value={id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],notes:""},T.value={}}function tt(){Y.value&&(Ie(),ge.value="create",F.value=!0,_.value=null,C())}function at(a){if(!q.value)return;Ie(),ge.value="edit",i.value={id:a.id,name:a.name||"",code:a.code||"",cable_type:a.cable_type||"",core_count:a.core_count??"",map_color:a.map_color||"#2563eb",from_point_id:a.from_point_id??"",to_point_id:a.to_point_id??"",path:Array.isArray(a.path)?a.path.slice():[],notes:a.notes||""},F.value=!0,_.value=null,C();const e=(i.value.path||[])[0];e&&Number.isFinite(Number(e.lat))&&Number.isFinite(Number(e.lng))&&Z(Number(e.lat),Number(e.lng),16)}async function lt(){var g,f,h;ye.value=!0,T.value={};const a={name:i.value.name,code:i.value.code||null,cable_type:i.value.cable_type||null,core_count:i.value.core_count!==""?Number(i.value.core_count):null,map_color:i.value.map_color||null,from_point_id:i.value.from_point_id!==""?Number(i.value.from_point_id):null,to_point_id:i.value.to_point_id!==""?Number(i.value.to_point_id):null,path:Array.isArray(i.value.path)&&i.value.path.length>=2?i.value.path:null,notes:i.value.notes||null},e=ge.value==="edit"&&i.value.id,r=e?`/api/v1/fiber/cables/${i.value.id}`:"/api/v1/fiber/cables",s=e?"PUT":"POST";try{const d=await B(r,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((g=d.data)!=null&&g.errors)?(T.value=d.data.errors,new Error(((f=d.data)==null?void 0:f.message)||"Validasi gagal.")):new Error(((h=d.data)==null?void 0:h.message)||`Gagal menyimpan kabel (HTTP ${d.status}).`);F.value=!1,N(),await O(),p&&p.success("Kabel tersimpan.")}catch(d){console.error("Fiber: saveCable failed",d),p&&p.error((d==null?void 0:d.message)||"Gagal menyimpan kabel.")}finally{ye.value=!1}}async function st(a){var r;if(!(!Q.value||!confirm(`Hapus kabel "${(a==null?void 0:a.name)||""}"?`)))try{const s=await B(`/api/v1/fiber/cables/${a.id}`,{method:"DELETE"});if(!s.ok)throw new Error(((r=s.data)==null?void 0:r.message)||`Gagal hapus kabel (HTTP ${s.status}).`);p&&p.success("Kabel dihapus."),Number(E.value)===Number(a.id)&&(E.value=null),await O()}catch(s){console.error("Fiber: deleteCable failed",s),p&&p.error((s==null?void 0:s.message)||"Gagal hapus kabel.")}}function rt(){F.value&&(_.value="drawCable",C(),p&&p.info("Mode gambar jalur aktif: klik peta untuk menambah titik."))}function je(){const a=Array.isArray(i.value.path)?i.value.path:[];a.length!==0&&(a.pop(),i.value.path=a,C())}function Ge(){i.value.path=[],C()}const M=y(!1),me=y("create"),xe=y(!1),U=y({}),c=y({id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""});function Re(){c.value={id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""},U.value={}}function nt(){Y.value&&(Re(),me.value="create",M.value=!0,_.value=null,C())}function ot(a){if(!q.value)return;Re(),me.value="edit",c.value={id:a.id,name:a.name||"",point_type:a.point_type||"",latitude:a.latitude??null,longitude:a.longitude??null,address:a.address||"",notes:a.notes||""},M.value=!0,_.value=null,C();const e=Number(c.value.latitude),r=Number(c.value.longitude);Number.isFinite(e)&&Number.isFinite(r)&&Z(e,r,17)}function it(){M.value&&(_.value="pickPoint",C(),p&&p.info("Klik peta untuk memilih lokasi titik."))}async function dt(){var g,f,h;xe.value=!0,U.value={};const a={name:c.value.name,point_type:c.value.point_type||null,latitude:c.value.latitude,longitude:c.value.longitude,address:c.value.address||null,notes:c.value.notes||null},e=me.value==="edit"&&c.value.id,r=e?`/api/v1/fiber/points/${c.value.id}`:"/api/v1/fiber/points",s=e?"PUT":"POST";try{const d=await B(r,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((g=d.data)!=null&&g.errors)?(U.value=d.data.errors,new Error(((f=d.data)==null?void 0:f.message)||"Validasi gagal.")):new Error(((h=d.data)==null?void 0:h.message)||`Gagal menyimpan titik (HTTP ${d.status}).`);M.value=!1,N(),await O(),p&&p.success("Titik tersimpan.")}catch(d){console.error("Fiber: savePoint failed",d),p&&p.error((d==null?void 0:d.message)||"Gagal menyimpan titik.")}finally{xe.value=!1}}async function ut(a){var r;if(!(!Q.value||!confirm(`Hapus titik "${(a==null?void 0:a.name)||""}"?`)))try{const s=await B(`/api/v1/fiber/points/${a.id}`,{method:"DELETE"});if(!s.ok)throw new Error(((r=s.data)==null?void 0:r.message)||`Gagal hapus titik (HTTP ${s.status}).`);p&&p.success("Titik dihapus."),Number(P.value)===Number(a.id)&&(P.value=null),await O()}catch(s){console.error("Fiber: deletePoint failed",s),p&&p.error((s==null?void 0:s.message)||"Gagal hapus titik.")}}const V=y(!1),fe=y("create"),ke=y(!1),X=y({}),u=y({id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""});function Ke(){u.value={id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""},X.value={}}function vt(){Y.value&&(Ke(),fe.value="create",V.value=!0,_.value=null,C())}function pt(a){if(!q.value)return;Ke(),fe.value="edit",u.value={id:a.id,cable_id:a.cable_id??"",point_id:a.point_id??"",status:(a.status||"OPEN").toString().toUpperCase(),severity:a.severity||"",reported_at:Ae(a.reported_at),fixed_at:Ae(a.fixed_at),latitude:a.latitude??null,longitude:a.longitude??null,description:a.description||""},V.value=!0,_.value=null,C();const e=Number(u.value.latitude),r=Number(u.value.longitude);Number.isFinite(e)&&Number.isFinite(r)&&Z(e,r,17)}function ct(){V.value&&(_.value="pickBreak",C(),p&&p.info("Klik peta untuk memilih lokasi putus."))}async function bt(){var g,f,h;ke.value=!0,X.value={};const a={cable_id:u.value.cable_id!==""?Number(u.value.cable_id):null,point_id:u.value.point_id!==""?Number(u.value.point_id):null,status:(u.value.status||"OPEN").toString().toUpperCase(),severity:u.value.severity||null,reported_at:u.value.reported_at||null,fixed_at:u.value.fixed_at||null,latitude:u.value.latitude,longitude:u.value.longitude,description:u.value.description||null},e=fe.value==="edit"&&u.value.id,r=e?`/api/v1/fiber/breaks/${u.value.id}`:"/api/v1/fiber/breaks",s=e?"PUT":"POST";try{const d=await B(r,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((g=d.data)!=null&&g.errors)?(X.value=d.data.errors,new Error(((f=d.data)==null?void 0:f.message)||"Validasi gagal.")):new Error(((h=d.data)==null?void 0:h.message)||`Gagal menyimpan data putus (HTTP ${d.status}).`);V.value=!1,N(),await O(),p&&p.success("Data putus tersimpan.")}catch(d){console.error("Fiber: saveBreak failed",d),p&&p.error((d==null?void 0:d.message)||"Gagal menyimpan data putus.")}finally{ke.value=!1}}async function gt(a){var r;if(!(!Q.value||!confirm("Hapus data putus ini?")))try{const s=await B(`/api/v1/fiber/breaks/${a.id}`,{method:"DELETE"});if(!s.ok)throw new Error(((r=s.data)==null?void 0:r.message)||`Gagal hapus data putus (HTTP ${s.status}).`);p&&p.success("Data putus dihapus."),Number(S.value)===Number(a.id)&&(S.value=null),await O()}catch(s){console.error("Fiber: deleteBreak failed",s),p&&p.error((s==null?void 0:s.message)||"Gagal hapus data putus.")}}return He([ue,ve,pe],()=>{De()}),He(A,()=>{try{localStorage.setItem("fiber_map_style",A.value)}catch{}Me()}),mt(()=>{try{const e=localStorage.getItem("fiber_map_style");e&&we[e]&&(A.value=e)}catch{}(window.L?Promise.resolve():new Promise((e,r)=>{const s=document.createElement("link");s.rel="stylesheet",s.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(s);const g=document.createElement("script");g.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",g.onload=()=>e(),g.onerror=()=>r(new Error("Failed to load Leaflet")),document.head.appendChild(g)})).then(()=>{xt(()=>{We(),O()})}).catch(e=>{console.error("Fiber: Leaflet load failed",e),ie.value="Gagal memuat Leaflet. Cek koneksi internet."})}),ft(()=>{Ye()}),(a,e)=>(o(),n(R,null,[ze(kt(_t),{title:"Kabel FO"}),ze(Ct,null,{default:ht(()=>{var r,s,g,f,h,d,x,ce,_e;return[t("div",Nt,[t("div",Lt,[e[47]||(e[47]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Manajemen Kabel FO"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Pemetaan jalur kabel, titik sambungan, dan data putus.")],-1)),t("div",Tt,[t("div",Et,[t("span",Pt,v(ee.value.cables),1),e[43]||(e[43]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"kabel",-1))]),t("div",St,[t("span",$t,v(ee.value.points),1),e[44]||(e[44]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"titik",-1))]),t("div",Ot,[t("span",Ft,v(ee.value.breaks_open),1),e[45]||(e[45]=t("span",{class:"text-red-600/70 dark:text-red-300/70 ml-1"},"putus aktif",-1))]),t("div",Mt,[m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>A.value=l),class:"input !py-2 !text-xs"},[...e[46]||(e[46]=[t("option",{value:"voyager"},"Voyager",-1),t("option",{value:"light"},"Light",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[j,A.value]]),t("button",{onClick:O,class:"btn btn-secondary !py-2 !text-xs",disabled:oe.value},"Refresh",8,Ut)])])]),Pe.warning?(o(),n("div",Vt,v(Pe.warning),1)):b("",!0),Oe.value?(o(),n("div",Dt,[t("div",At,[t("div",It,[t("label",jt,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=l=>ue.value=l)},null,512),[[Ee,ue.value]]),e[49]||(e[49]=G(" Kabel ",-1))]),t("label",Gt,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=l=>ve.value=l)},null,512),[[Ee,ve.value]]),e[50]||(e[50]=G(" Titik ",-1))]),t("label",Rt,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>pe.value=l)},null,512),[[Ee,pe.value]]),e[51]||(e[51]=G(" Putus ",-1))]),t("div",Kt,[m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>A.value=l),class:"input !py-2 !text-xs"},[...e[52]||(e[52]=[t("option",{value:"voyager"},"Voyager",-1),t("option",{value:"light"},"Light",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[j,A.value]]),t("button",{onClick:O,class:"btn btn-secondary !py-2 !text-xs",disabled:oe.value},"Refresh",8,Ht)])]),t("div",zt,[t("div",{ref_key:"mapContainer",ref:he,class:"w-full h-[420px] lg:h-[calc(100vh-13rem)] bg-slate-100 dark:bg-slate-900"},null,512),_.value?(o(),n("div",Jt,[t("div",Zt,[e[53]||(e[53]=G(" Mode peta aktif: ",-1)),t("span",Xt,v(_.value==="drawCable"?"gambar kabel":_.value==="pickPoint"?"pilih titik":"pilih putus"),1)]),e[54]||(e[54]=t("div",{class:"text-gray-600 dark:text-gray-300 mt-1"},"Klik peta untuk input. Tekan tombol untuk berhenti.",-1)),t("div",Wt,[t("button",{class:"btn btn-secondary !py-1 !text-xs",onClick:N},"Selesai"),_.value==="drawCable"?(o(),n("button",{key:0,class:"btn btn-secondary !py-1 !text-xs",onClick:je},"Undo")):b("",!0),_.value==="drawCable"?(o(),n("button",{key:1,class:"btn btn-secondary !py-1 !text-xs",onClick:Ge},"Clear")):b("",!0)])])):b("",!0)])]),t("div",Yt,[t("div",qt,[t("button",{onClick:e[5]||(e[5]=l=>L.value="cables"),class:se(["flex-1 px-3 py-3 text-xs font-semibold",L.value==="cables"?"text-blue-700 dark:text-blue-300 bg-blue-50/60 dark:bg-blue-900/10":"text-gray-600 dark:text-gray-300"])}," Kabel ("+v(K.value.length)+") ",3),t("button",{onClick:e[6]||(e[6]=l=>L.value="points"),class:se(["flex-1 px-3 py-3 text-xs font-semibold",L.value==="points"?"text-teal-700 dark:text-teal-300 bg-teal-50/60 dark:bg-teal-900/10":"text-gray-600 dark:text-gray-300"])}," Titik ("+v($.value.length)+") ",3),t("button",{onClick:e[7]||(e[7]=l=>L.value="breaks"),class:se(["flex-1 px-3 py-3 text-xs font-semibold",L.value==="breaks"?"text-red-700 dark:text-red-300 bg-red-50/60 dark:bg-red-900/10":"text-gray-600 dark:text-gray-300"])}," Putus ("+v(de.value.length)+") ",3)]),t("div",Qt,[oe.value?(o(),n("div",ea,"Memuat...")):ie.value?(o(),n("div",ta,v(ie.value),1)):L.value==="cables"?(o(),n("div",aa,[t("div",la,[e[55]||(e[55]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Daftar Kabel",-1)),Y.value?(o(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:tt},"Tambah")):b("",!0)]),K.value.length===0?(o(),n("div",sa,"Belum ada data kabel.")):(o(),n("div",ra,[(o(!0),n(R,null,W(K.value,l=>(o(),n("div",{key:l.id,class:se(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-blue-200 dark:hover:border-blue-900/40 cursor-pointer",Number(E.value)===Number(l.id)?"bg-blue-50/60 dark:bg-blue-900/10":"bg-white dark:bg-dark-800"]),onClick:I=>{E.value=l.id,P.value=null,S.value=null,Ne()}},[t("div",oa,[t("div",null,[t("div",ia,v(l.name),1),t("div",da,[l.cable_type?(o(),n("span",ua,v(l.cable_type),1)):b("",!0),l.core_count?(o(),n("span",va,"• "+v(l.core_count)+" core",1)):b("",!0)]),l.from_point_id||l.to_point_id?(o(),n("div",pa,[t("div",null,[e[56]||(e[56]=G("Dari: ",-1)),t("span",ca,v(le(l.from_point_id)||"-"),1)]),t("div",null,[e[57]||(e[57]=G("Ke: ",-1)),t("span",ba,v(le(l.to_point_id)||"-"),1)])])):b("",!0)]),t("div",ga,[q.value?(o(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:re(I=>at(l),["stop"])},"Edit",8,ya)):b("",!0),Q.value?(o(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:re(I=>st(l),["stop"])},"Hapus",8,ma)):b("",!0)])])],10,na))),128))]))])):L.value==="points"?(o(),n("div",xa,[t("div",fa,[e[58]||(e[58]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Titik Sambungan",-1)),Y.value?(o(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:nt},"Tambah")):b("",!0)]),$.value.length===0?(o(),n("div",ka,"Belum ada data titik.")):(o(),n("div",_a,[(o(!0),n(R,null,W($.value,l=>(o(),n("div",{key:l.id,class:se(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-teal-200 dark:hover:border-teal-900/40 cursor-pointer",Number(P.value)===Number(l.id)?"bg-teal-50/60 dark:bg-teal-900/10":"bg-white dark:bg-dark-800"]),onClick:I=>{P.value=l.id,E.value=null,S.value=null,Le(),Z(Number(l.latitude),Number(l.longitude),17)}},[t("div",wa,[t("div",null,[t("div",Ca,v(l.name),1),t("div",Na,[l.point_type?(o(),n("span",La,v(l.point_type),1)):b("",!0),l.latitude&&l.longitude?(o(),n("span",Ta,"• "+v(l.latitude)+", "+v(l.longitude),1)):b("",!0)])]),t("div",Ea,[q.value?(o(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:re(I=>ot(l),["stop"])},"Edit",8,Pa)):b("",!0),Q.value?(o(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:re(I=>ut(l),["stop"])},"Hapus",8,Sa)):b("",!0)])])],10,ha))),128))]))])):(o(),n("div",$a,[t("div",Oa,[e[59]||(e[59]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Data Putus",-1)),Y.value?(o(),n("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:vt},"Tambah")):b("",!0)]),de.value.length===0?(o(),n("div",Fa,"Belum ada data putus.")):(o(),n("div",Ma,[(o(!0),n(R,null,W(de.value,l=>(o(),n("div",{key:l.id,class:se(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-red-200 dark:hover:border-red-900/40 cursor-pointer",Number(S.value)===Number(l.id)?"bg-red-50/60 dark:bg-red-900/10":"bg-white dark:bg-dark-800"]),onClick:I=>{S.value=l.id,E.value=null,P.value=null,Te(),Z(Number(l.latitude),Number(l.longitude),17)}},[t("div",Va,[t("div",null,[t("div",Ba,v(et(l.status)),1),t("div",Da,v(Be(l.cable_id)||(l.cable_id?"Kabel #"+l.cable_id:"Tanpa kabel")),1),t("div",Aa,[t("span",null,"Titik: "+v(le(l.point_id)||"-"),1),l.severity?(o(),n("span",Ia,"• "+v(l.severity),1)):b("",!0)]),l.description?(o(),n("div",ja,v(l.description),1)):b("",!0)]),t("div",Ga,[q.value?(o(),n("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:re(I=>pt(l),["stop"])},"Edit",8,Ra)):b("",!0),Q.value?(o(),n("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:re(I=>gt(l),["stop"])},"Hapus",8,Ka)):b("",!0)])])],10,Ua))),128))]))]))])])])):(o(),n("div",Bt,[...e[48]||(e[48]=[t("div",{class:"text-gray-900 dark:text-white font-semibold"},"Tidak punya akses",-1),t("div",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},[G(" Butuh permission "),t("code",{class:"px-1 py-0.5 bg-gray-100 dark:bg-dark-700 rounded"},"view fiber"),G(". ")],-1)])]))]),F.value?(o(),n("div",Ha,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[8]||(e[8]=l=>{F.value=!1,N()})}),t("div",za,[t("div",Ja,[t("div",Za,v(ge.value==="edit"?"Edit Kabel":"Tambah Kabel"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[9]||(e[9]=l=>{F.value=!1,N()})},"Tutup")]),t("div",Xa,[t("div",Wa,[t("div",null,[e[60]||(e[60]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>i.value.name=l),class:"input w-full",placeholder:"Feeder ODC-POP A"},null,512),[[w,i.value.name]]),T.value.name?(o(),n("div",Ya,v((r=T.value.name)==null?void 0:r[0]),1)):b("",!0)]),t("div",null,[e[61]||(e[61]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kode (opsional)",-1)),m(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>i.value.code=l),class:"input w-full",placeholder:"FO-001"},null,512),[[w,i.value.code]]),T.value.code?(o(),n("div",qa,v((s=T.value.code)==null?void 0:s[0]),1)):b("",!0)]),t("div",null,[e[62]||(e[62]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>i.value.cable_type=l),class:"input w-full",placeholder:"FEEDER / DISTRIBUTION / DROP"},null,512),[[w,i.value.cable_type]]),T.value.cable_type?(o(),n("div",Qa,v((g=T.value.cable_type)==null?void 0:g[0]),1)):b("",!0)]),t("div",null,[e[63]||(e[63]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Core",-1)),m(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>i.value.core_count=l),type:"number",min:"1",class:"input w-full",placeholder:"12"},null,512),[[w,i.value.core_count]]),T.value.core_count?(o(),n("div",el,v((f=T.value.core_count)==null?void 0:f[0]),1)):b("",!0)]),t("div",null,[e[65]||(e[65]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dari Titik",-1)),m(t("select",{"onUpdate:modelValue":e[14]||(e[14]=l=>i.value.from_point_id=l),class:"input w-full"},[e[64]||(e[64]=t("option",{value:""},"(kosong)",-1)),(o(!0),n(R,null,W($.value,l=>(o(),n("option",{key:l.id,value:l.id},v(l.name),9,tl))),128))],512),[[j,i.value.from_point_id]])]),t("div",null,[e[67]||(e[67]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Ke Titik",-1)),m(t("select",{"onUpdate:modelValue":e[15]||(e[15]=l=>i.value.to_point_id=l),class:"input w-full"},[e[66]||(e[66]=t("option",{value:""},"(kosong)",-1)),(o(!0),n(R,null,W($.value,l=>(o(),n("option",{key:l.id,value:l.id},v(l.name),9,al))),128))],512),[[j,i.value.to_point_id]])]),t("div",ll,[e[68]||(e[68]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Warna Jalur",-1)),t("div",sl,[m(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>i.value.map_color=l),type:"color",class:"h-10 w-14 rounded border border-gray-200 dark:border-dark-700 bg-transparent"},null,512),[[w,i.value.map_color]]),m(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>i.value.map_color=l),class:"input flex-1",placeholder:"#2563eb"},null,512),[[w,i.value.map_color]])])]),t("div",rl,[e[69]||(e[69]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[18]||(e[18]=l=>i.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"Keterangan kabel..."},null,512),[[w,i.value.notes]])])]),t("div",nl,[t("div",ol,[t("div",null,[e[70]||(e[70]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Jalur di Peta",-1)),t("div",il,"Titik: "+v(Array.isArray(i.value.path)?i.value.path.length:0),1)]),t("div",{class:"flex flex-wrap items-center gap-2"},[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:rt},"Gambar"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:je},"Undo"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Ge},"Clear")])])])]),t("div",dl,[t("button",{class:"btn btn-secondary",onClick:e[19]||(e[19]=l=>{F.value=!1,N()})},"Batal"),t("button",{class:"btn btn-primary",disabled:ye.value,onClick:lt},v(ye.value?"Menyimpan...":"Simpan"),9,ul)])])])):b("",!0),M.value?(o(),n("div",vl,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[20]||(e[20]=l=>{M.value=!1,N()})}),t("div",pl,[t("div",cl,[t("div",bl,v(me.value==="edit"?"Edit Titik":"Tambah Titik"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[21]||(e[21]=l=>{M.value=!1,N()})},"Tutup")]),t("div",gl,[t("div",null,[e[71]||(e[71]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),m(t("input",{"onUpdate:modelValue":e[22]||(e[22]=l=>c.value.name=l),class:"input w-full",placeholder:"ODP-01 / Joint A"},null,512),[[w,c.value.name]]),U.value.name?(o(),n("div",yl,v((h=U.value.name)==null?void 0:h[0]),1)):b("",!0)]),t("div",null,[e[72]||(e[72]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),m(t("input",{"onUpdate:modelValue":e[23]||(e[23]=l=>c.value.point_type=l),class:"input w-full",placeholder:"ODP / ODC / JOINT / HANDHOLE"},null,512),[[w,c.value.point_type]])]),t("div",ml,[t("div",null,[e[73]||(e[73]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),m(t("input",{"onUpdate:modelValue":e[24]||(e[24]=l=>c.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[w,c.value.latitude]]),U.value.latitude?(o(),n("div",xl,v((d=U.value.latitude)==null?void 0:d[0]),1)):b("",!0)]),t("div",null,[e[74]||(e[74]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),m(t("input",{"onUpdate:modelValue":e[25]||(e[25]=l=>c.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[w,c.value.longitude]]),U.value.longitude?(o(),n("div",fl,v((x=U.value.longitude)==null?void 0:x[0]),1)):b("",!0)])]),t("div",kl,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:it},"Pilih dari peta"),c.value.latitude&&c.value.longitude?(o(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[26]||(e[26]=l=>Z(Number(c.value.latitude),Number(c.value.longitude),18))},"Zoom")):b("",!0)]),t("div",null,[e[75]||(e[75]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Alamat",-1)),m(t("input",{"onUpdate:modelValue":e[27]||(e[27]=l=>c.value.address=l),class:"input w-full",placeholder:"(opsional)"},null,512),[[w,c.value.address]])]),t("div",null,[e[76]||(e[76]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[28]||(e[28]=l=>c.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"(opsional)"},null,512),[[w,c.value.notes]])])]),t("div",_l,[t("button",{class:"btn btn-secondary",onClick:e[29]||(e[29]=l=>{M.value=!1,N()})},"Batal"),t("button",{class:"btn btn-primary",disabled:xe.value,onClick:dt},v(xe.value?"Menyimpan...":"Simpan"),9,hl)])])])):b("",!0),V.value?(o(),n("div",wl,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[30]||(e[30]=l=>{V.value=!1,N()})}),t("div",Cl,[t("div",Nl,[t("div",Ll,v(fe.value==="edit"?"Edit Data Putus":"Tambah Data Putus"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[31]||(e[31]=l=>{V.value=!1,N()})},"Tutup")]),t("div",Tl,[t("div",null,[e[78]||(e[78]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kabel",-1)),m(t("select",{"onUpdate:modelValue":e[32]||(e[32]=l=>u.value.cable_id=l),class:"input w-full"},[e[77]||(e[77]=t("option",{value:""},"(kosong)",-1)),(o(!0),n(R,null,W(K.value,l=>(o(),n("option",{key:l.id,value:l.id},v(l.name),9,El))),128))],512),[[j,u.value.cable_id]])]),t("div",null,[e[80]||(e[80]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik (opsional)",-1)),m(t("select",{"onUpdate:modelValue":e[33]||(e[33]=l=>u.value.point_id=l),class:"input w-full"},[e[79]||(e[79]=t("option",{value:""},"(kosong)",-1)),(o(!0),n(R,null,W($.value,l=>(o(),n("option",{key:l.id,value:l.id},v(l.name),9,Pl))),128))],512),[[j,u.value.point_id]])]),t("div",Sl,[t("div",null,[e[82]||(e[82]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Status",-1)),m(t("select",{"onUpdate:modelValue":e[34]||(e[34]=l=>u.value.status=l),class:"input w-full"},[...e[81]||(e[81]=[t("option",{value:"OPEN"},"OPEN",-1),t("option",{value:"IN_PROGRESS"},"IN_PROGRESS",-1),t("option",{value:"FIXED"},"FIXED",-1),t("option",{value:"CANCELLED"},"CANCELLED",-1)])],512),[[j,u.value.status]])]),t("div",null,[e[84]||(e[84]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Severity",-1)),m(t("select",{"onUpdate:modelValue":e[35]||(e[35]=l=>u.value.severity=l),class:"input w-full"},[...e[83]||(e[83]=[t("option",{value:""},"(kosong)",-1),t("option",{value:"MINOR"},"MINOR",-1),t("option",{value:"MAJOR"},"MAJOR",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)])],512),[[j,u.value.severity]])])]),t("div",$l,[t("div",null,[e[85]||(e[85]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dilaporkan",-1)),m(t("input",{"onUpdate:modelValue":e[36]||(e[36]=l=>u.value.reported_at=l),type:"datetime-local",class:"input w-full"},null,512),[[w,u.value.reported_at]])]),t("div",null,[e[86]||(e[86]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Fixed At",-1)),m(t("input",{"onUpdate:modelValue":e[37]||(e[37]=l=>u.value.fixed_at=l),type:"datetime-local",class:"input w-full",disabled:String(u.value.status).toUpperCase()!=="FIXED"},null,8,Ol),[[w,u.value.fixed_at]])])]),t("div",Fl,[t("div",null,[e[87]||(e[87]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),m(t("input",{"onUpdate:modelValue":e[38]||(e[38]=l=>u.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[w,u.value.latitude]]),X.value.latitude?(o(),n("div",Ml,v((ce=X.value.latitude)==null?void 0:ce[0]),1)):b("",!0)]),t("div",null,[e[88]||(e[88]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),m(t("input",{"onUpdate:modelValue":e[39]||(e[39]=l=>u.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[w,u.value.longitude]]),X.value.longitude?(o(),n("div",Ul,v((_e=X.value.longitude)==null?void 0:_e[0]),1)):b("",!0)])]),t("div",Vl,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:ct},"Pilih dari peta"),u.value.latitude&&u.value.longitude?(o(),n("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[40]||(e[40]=l=>Z(Number(u.value.latitude),Number(u.value.longitude),18))},"Zoom")):b("",!0)]),t("div",null,[e[89]||(e[89]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),m(t("textarea",{"onUpdate:modelValue":e[41]||(e[41]=l=>u.value.description=l),class:"input w-full min-h-[90px]",placeholder:"Keterangan kejadian putus..."},null,512),[[w,u.value.description]])])]),t("div",Bl,[t("button",{class:"btn btn-secondary",onClick:e[42]||(e[42]=l=>{V.value=!1,N()})},"Batal"),t("button",{class:"btn btn-primary",disabled:ke.value,onClick:bt},v(ke.value?"Menyimpan...":"Simpan"),9,Dl)])])])):b("",!0)]}),_:1})],64))}};export{jl as default};
