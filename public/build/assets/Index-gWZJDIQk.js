import{o as xe,c as o,a as oe,u as he,h as we,m as _e,b as t,n as k,t as c,f as K,v as Y,j as i,F as _,s as L,e as g,d as S,r as m,y as C}from"./app-C7kZMgjI.js";import{_ as Se}from"./AdminLayout-CPyUPKQ9.js";const Ce={class:"space-y-6 animate-fade-in"},je={class:"grid grid-cols-1 md:grid-cols-[360px,1fr] gap-6"},Me={class:"p-5 border-b border-gray-100 dark:border-dark-700 bg-gradient-to-b from-gray-50/80 to-white dark:from-dark-800/60 dark:to-dark-800"},Te={class:"flex items-center justify-between gap-3"},Le={class:"text-xs text-gray-500 dark:text-gray-400"},Pe={class:"mt-3 relative"},Ee={class:"mt-3 flex items-center gap-2"},Re={class:"p-2"},Ae={key:0,class:"space-y-2 p-2"},Be={key:1,class:"max-h-[70vh] overflow-y-auto custom-scrollbar"},Oe=["onClick"],ze={class:"flex items-start justify-between gap-3"},$e={class:"min-w-0"},Ne={class:"flex items-center gap-2"},Ve={class:"font-extrabold text-sm capitalize truncate"},De={class:"shrink-0"},Ie={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ue={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},He={key:0,class:"p-6 text-center text-sm text-gray-500 dark:text-gray-400"},Fe={class:"p-5 border-b border-gray-100 dark:border-dark-700 bg-gradient-to-b from-gray-50/80 to-white dark:from-dark-800/60 dark:to-dark-800"},Je={class:"flex items-start justify-between gap-4"},qe={class:"min-w-0"},Ge={class:"flex items-center gap-2"},Ke={class:"text-sm font-extrabold text-gray-900 dark:text-white tracking-tight truncate"},Ye={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 border border-amber-200/60 dark:border-amber-900/40"},Qe={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ze={key:0,class:"ml-2"},We={class:"flex items-center gap-2 shrink-0"},Xe=["disabled"],et={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},tt={key:0,class:"p-10 text-center"},rt={key:1,class:"p-6 space-y-6"},at={class:"relative rounded-md shadow-sm"},st=["disabled"],nt={key:0,class:"text-xs text-amber-600 mt-2 flex items-center"},ot={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-3 gap-3"},it={class:"border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 p-4"},lt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},dt={class:"flex items-start justify-between gap-3"},ut={class:"text-sm font-bold text-gray-900 dark:text-white"},ct={key:0,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 border border-amber-200/60 dark:border-amber-900/40"},mt={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},pt={class:"shrink-0"},gt=["value","onChange"],vt=["value"],bt={class:"mt-3 flex flex-wrap gap-1.5"},kt={key:0,class:"inline-flex items-center px-2 py-1 rounded text-[11px] font-semibold bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300"},yt={key:1,class:"text-[11px] text-gray-400 italic py-1"},ft={key:0,class:"space-y-3"},xt={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3"},ht={class:"relative w-full sm:w-80"},wt={class:"h-[60vh] sm:h-[420px] overflow-y-auto custom-scrollbar border border-gray-200 dark:border-dark-700 rounded-xl bg-gray-50/50 dark:bg-dark-900/20 p-4 space-y-4"},_t={class:"flex items-center justify-between mb-3 border-b border-gray-100 dark:border-dark-700 pb-2"},St={class:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider flex items-center"},Ct=["onClick"],jt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},Mt=["checked","onChange"],Tt={class:"text-sm text-gray-600 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors select-none"},Lt={key:0,class:"text-center py-12 text-gray-500"},Pt={class:"flex justify-between items-center text-xs text-gray-500"},Et={key:1,class:"pt-4 border-t border-gray-100 dark:border-dark-700"},B="/api/v1",Ot={__name:"Index",setup(Rt){const j=m([]),R=m([]),V=m(!1),D=m(!1),P=m(!1),I=m(""),f=m("all"),M=m(""),x=m(!1),T=m(!1),b=m("none"),p=m(null),l=m({id:null,name:"",permissions:[]}),U=m(null),Q=m(""),ie=["admin","owner"],le=[{value:"none",label:"Tidak ada"},{value:"read",label:"Lihat"},{value:"operator",label:"Operator"},{value:"manager",label:"Manager"}],de=[{key:"dashboard",label:"Dashboard",description:"Ringkasan & statistik.",levels:{read:["view dashboard"],operator:["view dashboard"],manager:["view dashboard"]}},{key:"installations",label:"Pasang Baru",description:"Instalasi, monitoring, approval.",levels:{read:["view installations","view riwayat installations"],operator:["view installations","create installations","edit installations","view riwayat installations"],manager:["view installations","create installations","edit installations","delete installations","approve installations","send installations recap","view riwayat installations"]}},{key:"team",label:"Tim",description:"Teknisi/sales/staff.",levels:{read:["view team"],operator:["view team","create team","edit team"],manager:["manage team","view team","create team","edit team","delete team"]}},{key:"teknisi",label:"Teknisi",description:"Tugas, riwayat, rekap.",levels:{read:["view teknisi"],operator:["view teknisi","edit teknisi"],manager:["view teknisi","edit teknisi","send teknisi recap"]}},{key:"maps",label:"Maps",description:"Tracking teknisi.",levels:{read:["view maps"],operator:["view maps","manage maps"],manager:["view maps","manage maps"]}},{key:"chat",label:"Chat",description:"Chat admin.",levels:{read:["view chat"],operator:["view chat","send chat","edit chat"],manager:["view chat","send chat","edit chat","delete chat"]}},{key:"leads",label:"Leads",description:"Prospek & konversi.",levels:{read:["view leads"],operator:["view leads","create leads","edit leads","convert leads","bulk leads"],manager:["view leads","create leads","edit leads","delete leads","convert leads","bulk leads"]}},{key:"customers",label:"Pelanggan",description:"Data pelanggan.",levels:{read:["view customers"],operator:["view customers","create customers","edit customers"],manager:["view customers","create customers","edit customers","delete customers"]}},{key:"plans",label:"Paket Layanan",description:"Produk/paket.",levels:{read:["view plans"],operator:["view plans","create plans","edit plans"],manager:["view plans","create plans","edit plans","delete plans"]}},{key:"invoices",label:"Invoice",description:"Tagihan.",levels:{read:["view invoices"],operator:["view invoices","create invoices","edit invoices"],manager:["view invoices","create invoices","edit invoices","delete invoices"]}},{key:"payments",label:"Pembayaran",description:"Transaksi.",levels:{read:["view payments"],operator:["view payments","create payments","edit payments"],manager:["view payments","create payments","edit payments","delete payments"]}},{key:"reports",label:"Laporan",description:"Analitik & export.",levels:{read:["view reports"],operator:["view reports","export reports"],manager:["view reports","export reports"]}},{key:"finance",label:"Keuangan",description:"Transaksi & approval.",levels:{read:["view finance"],operator:["view finance","create finance","edit finance","export finance"],manager:["manage finance","view finance","create finance","edit finance","delete finance","approve finance","export finance"]}},{key:"olts",label:"OLT",description:"Provisioning OLT/ONU.",levels:{read:["view olts"],operator:["manage olt","view olts","create olts","edit olts"],manager:["manage olt","view olts","create olts","edit olts","delete olts"]}},{key:"isolir",label:"Isolir",description:"Suspend/unsuspend.",levels:{read:[],operator:["manage isolir"],manager:["manage isolir"]}},{key:"settings",label:"Pengaturan Sistem",description:"Settings, roles, update.",levels:{read:[],operator:["manage settings"],manager:["manage settings","manage roles","manage system update"]}}];function H(r){return(r||"").toString().replace(/_/g," ").trim()}function v(r){const e=(r||"").toString().toLowerCase().trim();return ie.includes(e)}function Z(r){return JSON.parse(JSON.stringify(r))}function O(r){const e=[],s=new Set;return(r||[]).forEach(n=>{!n||s.has(n)||(s.add(n),e.push(n))}),e}function W(r){return{name:((r==null?void 0:r.name)||"").toString().trim(),permissions:O((r==null?void 0:r.permissions)||[]).slice().sort()}}function A(){U.value=Z(l.value),Q.value=JSON.stringify(W(l.value))}const F=C(()=>JSON.stringify(W(l.value))!==Q.value);function J(){return F.value?confirm("Perubahan belum disimpan. Lanjut dan buang perubahan?"):!0}const y=C(()=>p.value&&(j.value||[]).find(r=>String(r.id)===String(p.value))||null),E=C(()=>b.value==="edit"),ue=C(()=>b.value==="create"),X=C(()=>{const r=(j.value||[]).slice();return r.sort((e,s)=>{const n=((e==null?void 0:e.name)||"").toString().toLowerCase(),d=((s==null?void 0:s.name)||"").toString().toLowerCase(),a=v(n),u=v(d);return a!==u?a?-1:1:n.localeCompare(d)}),r}),ee=C(()=>{const r=I.value.toLowerCase().trim();return X.value.filter(e=>{const s=((e==null?void 0:e.name)||"").toString().toLowerCase();return(f.value==="all"?!0:f.value==="system"?v(s):!v(s))?r?s.includes(r)||H(s).toLowerCase().includes(r):!0:!1})});async function q(){V.value=!0;try{const e=await(await fetch(`${B}/roles`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);if(j.value=Array.isArray(e)?e:[],b.value!=="create"&&!(p.value&&j.value.some(n=>String(n.id)===String(p.value)))){const n=X.value[0];n?z(n,{force:!0,keepMobile:!0}):(b.value="none",p.value=null)}}catch(r){console.error("Error loading roles:",r),j.value=[]}finally{V.value=!1}}async function ce(){D.value=!0;try{const e=await(await fetch(`${B}/permissions`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json().catch(()=>[]);R.value=Array.isArray(e)?e:[]}catch(r){console.error("Error loading permissions:",r),R.value=[]}finally{D.value=!1}}function te(){J()&&(b.value="create",p.value=null,l.value={id:null,name:"",permissions:[]},M.value="",x.value=!1,T.value=!0,A())}function z(r,e={}){const s=!!e.force,n=!!e.keepMobile;!s&&!J()||(b.value="edit",p.value=(r==null?void 0:r.id)??null,l.value={id:(r==null?void 0:r.id)??null,name:(r==null?void 0:r.name)??"",permissions:((r==null?void 0:r.permissions)||[]).map(d=>d.name)},M.value="",x.value=!1,n||(T.value=!0),A())}function me(){const r=y.value;r&&J()&&(b.value="create",p.value=null,l.value={id:null,name:`${r.name}_copy`,permissions:(r.permissions||[]).map(e=>e.name)},M.value="",x.value=!1,T.value=!0,A())}function pe(){U.value&&(l.value=Z(U.value))}async function ge(){const r=(l.value.name||"").toString().trim();if(r){P.value=!0;try{const e=E.value?`${B}/roles/${l.value.id}`:`${B}/roles`,s=E.value?"PUT":"POST",n={name:r,permissions:O(l.value.permissions||[])},d=await fetch(e,{method:s,credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),a=await d.json().catch(()=>null);if(!d.ok){alert(a&&(a.message||a.msg)?a.message||a.msg:"Gagal menyimpan role");return}await q();const u=a==null?void 0:a.id,w=u?j.value.find(ne=>String(ne.id)===String(u)):null;w?z(w,{force:!0,keepMobile:!1}):b.value!=="create"&&y.value&&z(y.value,{force:!0,keepMobile:!1})}catch(e){console.error("Error saving role:",e),alert("Terjadi kesalahan sistem")}finally{P.value=!1}}}async function ve(){const r=y.value;if(r&&!v(r.name)&&confirm(`Yakin ingin menghapus role "${r.name}"? Tindakan ini tidak dapat dibatalkan.`)){P.value=!0;try{const e=await fetch(`${B}/roles/${r.id}`,{method:"DELETE",credentials:"same-origin",headers:{Accept:"application/json"}}),s=await e.json().catch(()=>null);if(!e.ok){alert(s&&(s.message||s.msg)?s.message||s.msg:"Gagal menghapus role");return}b.value="none",p.value=null,l.value={id:null,name:"",permissions:[]},M.value="",x.value=!1,T.value=!1,A(),await q()}catch(e){console.error("Error deleting role:",e),alert("Terjadi kesalahan sistem")}finally{P.value=!1}}}const re=C(()=>{const r={},e=M.value.toLowerCase().trim();return(R.value||[]).forEach(s=>{if(!(s!=null&&s.name))return;const n=s.name.toLowerCase();if(e&&!n.includes(e))return;const d=s.name.split(" "),a=d.length>1?d.slice(1).join(" "):"System",u=a.charAt(0).toUpperCase()+a.slice(1);r[u]||(r[u]=[]),r[u].push(s)}),Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{})});function be(r){const e=l.value.permissions||[],s=e.indexOf(r);s===-1?e.push(r):e.splice(s,1),l.value.permissions=e}function ke(r){if(r.every(n=>l.value.permissions.includes(n.name))){const n=new Set(r.map(d=>d.name));l.value.permissions=(l.value.permissions||[]).filter(d=>!n.has(d));return}const s=new Set(l.value.permissions||[]);r.forEach(n=>s.add(n.name)),l.value.permissions=Array.from(s)}const ye=C(()=>new Set((R.value||[]).map(r=>r.name)));function h(r,e){var d;const s=(((d=r==null?void 0:r.levels)==null?void 0:d[e])||[]).slice(),n=ye.value;return!n||n.size===0?s:s.filter(a=>n.has(a))}function ae(r){return O([...h(r,"read"),...h(r,"operator"),...h(r,"manager")])}function se(r){const e=ae(r),s=new Set(l.value.permissions||[]);return e.filter(n=>s.has(n))}function G(r,e){if(r.size!==e.size)return!1;for(const s of r)if(!e.has(s))return!1;return!0}function $(r){const e=new Set(se(r));if(e.size===0)return"none";const s=new Set(h(r,"read")),n=new Set(h(r,"operator")),d=new Set(h(r,"manager"));return G(e,s)?"read":G(e,n)?"operator":G(e,d)?"manager":"custom"}function fe(r,e){if(!r||!["none","read","operator","manager"].includes(e))return;const s=new Set(ae(r)),n=(l.value.permissions||[]).filter(d=>!s.has(d));e!=="none"&&n.push(...h(r,e)),l.value.permissions=O(n)}function N(r){const e=$(r),s=e==="custom"?se(r):e==="none"?[]:h(r,e),n=s.slice(0,3),d=Math.max(0,s.length-n.length);return{list:s,head:n,extra:d,level:e}}return xe(()=>{q(),ce(),A()}),(r,e)=>(i(),o(_,null,[oe(he(we),{title:"Kelola Role"}),oe(Se,null,{default:_e(()=>{var s,n,d;return[t("div",Ce,[t("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 bg-white dark:bg-dark-800 p-6 rounded-2xl shadow-card border border-gray-100 dark:border-dark-700"},[e[9]||(e[9]=t("div",null,[t("h1",{class:"text-3xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-primary-400"}," Role & Permissions "),t("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"Atur akses dan keamanan sistem dengan cepat.")],-1)),t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",onClick:te,class:"group relative inline-flex items-center justify-center px-5 py-3 text-sm font-medium text-white transition-all duration-200 bg-primary-600 border border-transparent rounded-xl hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 shadow-glow-blue hover:shadow-glow-blue-lg overflow-hidden"},[...e[8]||(e[8]=[t("span",{class:"absolute inset-0 w-full h-full -mt-1 rounded-lg opacity-30 bg-gradient-to-b from-transparent via-transparent to-black"},null,-1),t("svg",{class:"w-5 h-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",null,"Role Baru",-1)])])])]),t("div",je,[t("aside",{class:k([[T.value?"hidden md:block":""],"bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 shadow-card overflow-hidden"])},[t("div",Me,[t("div",Te,[e[10]||(e[10]=t("div",{class:"text-sm font-extrabold text-gray-900 dark:text-white tracking-tight"},"Daftar Role",-1)),t("div",Le,c(j.value.length)+" role",1)]),t("div",Pe,[e[11]||(e[11]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),K(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),type:"text",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-dark-700 rounded-xl focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-900 dark:text-white",placeholder:"Cari role..."},null,512),[[Y,I.value]])]),t("div",Ee,[t("button",{type:"button",onClick:e[1]||(e[1]=a=>f.value="all"),class:k(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",f.value==="all"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Semua ",2),t("button",{type:"button",onClick:e[2]||(e[2]=a=>f.value="system"),class:k(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",f.value==="system"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Sistem ",2),t("button",{type:"button",onClick:e[3]||(e[3]=a=>f.value="custom"),class:k(["px-3 py-1.5 rounded-xl text-xs font-semibold border transition-colors",f.value==="custom"?"bg-primary-600 text-white border-transparent":"bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])}," Custom ",2)])]),t("div",Re,[V.value?(i(),o("div",Ae,[(i(),o(_,null,L(6,a=>t("div",{key:a,class:"h-14 rounded-xl bg-gray-100 dark:bg-dark-900 animate-pulse"})),64))])):(i(),o("div",Be,[(i(!0),o(_,null,L(ee.value,a=>(i(),o("button",{key:a.id,type:"button",onClick:u=>z(a),class:k(["w-full text-left rounded-xl p-3 border transition-all mb-2",String(p.value)===String(a.id)?"bg-gradient-to-r from-primary-600 to-primary-700 text-white border-transparent shadow-lg shadow-primary-600/20":"bg-white dark:bg-dark-900 border-gray-100 dark:border-dark-700 hover:bg-gray-50 dark:hover:bg-dark-800"])},[t("div",ze,[t("div",$e,[t("div",Ne,[t("span",Ve,c(H(a.name)),1),t("span",{class:k(["inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold border",[v(a.name)?String(p.value)===String(a.id)?"border-white/30 bg-white/10":"border-primary-200/60 bg-primary-50 text-primary-700 dark:bg-primary-900/20 dark:text-primary-300 dark:border-primary-900/40":String(p.value)===String(a.id)?"border-white/30 bg-white/10":"border-gray-200 bg-gray-50 text-gray-700 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700"]])},c(v(a.name)?"SISTEM":"CUSTOM"),3)]),t("div",{class:k(["mt-1 text-[11px] leading-snug",[String(p.value)===String(a.id)?"text-white/80":"text-gray-500 dark:text-gray-400"]])},c((a.permissions||[]).length)+" permission ",3)]),t("div",De,[t("div",{class:k(["h-9 w-9 rounded-xl flex items-center justify-center border",[String(p.value)===String(a.id)?"bg-white/10 border-white/20":"bg-primary-50 dark:bg-primary-900/20 border-primary-100 dark:border-primary-900/30"]])},[v(a.name)?(i(),o("svg",Ie,[...e[12]||(e[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},null,-1)])])):(i(),o("svg",Ue,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])]))],2)])])],10,Oe))),128)),ee.value.length===0?(i(),o("div",He," Tidak ada role yang cocok. ")):g("",!0)]))])],2),t("section",{class:k([[T.value?"":"hidden md:block"],"bg-white dark:bg-dark-800 rounded-2xl border border-gray-100 dark:border-dark-700 shadow-card overflow-hidden"])},[t("div",Fe,[t("div",Je,[t("div",qe,[t("div",Ge,[t("button",{type:"button",class:"md:hidden inline-flex items-center justify-center h-9 w-9 rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200",onClick:e[4]||(e[4]=a=>T.value=!1)},[...e[14]||(e[14]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("div",Ke,c(ue.value?"Buat Role Baru":y.value?`Edit Role: ${H(y.value.name)}`:"Pilih Role"),1),F.value?(i(),o("span",Ye," Belum disimpan ")):g("",!0)]),t("div",Qe,[S(c(l.value.permissions.length)+" permission dipilih ",1),D.value?(i(),o("span",Ze,"(memuat katalog...)")):g("",!0)])]),t("div",We,[E.value?(i(),o("button",{key:0,type:"button",onClick:me,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Duplikat ")):g("",!0),F.value?(i(),o("button",{key:1,type:"button",onClick:pe,class:"hidden sm:inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"}," Reset ")):g("",!0),t("button",{type:"button",onClick:ge,disabled:P.value||!l.value.name.trim(),class:"inline-flex items-center justify-center px-4 py-2 text-xs font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-60 disabled:cursor-not-allowed shadow-glow-blue"},[P.value?(i(),o("svg",et,[...e[15]||(e[15]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):g("",!0),e[16]||(e[16]=S(" Simpan ",-1))],8,Xe)])])]),b.value==="none"?(i(),o("div",tt,[t("div",{class:"max-w-md mx-auto"},[e[17]||(e[17]=t("div",{class:"text-lg font-extrabold text-gray-900 dark:text-white"},"Pilih role",-1)),e[18]||(e[18]=t("div",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Pilih role di panel kiri untuk mengubah akses, atau buat role baru. ",-1)),t("button",{type:"button",onClick:te,class:"mt-5 inline-flex items-center justify-center px-5 py-3 text-sm font-semibold rounded-xl bg-primary-600 text-white hover:bg-primary-700 shadow-glow-blue"}," Buat Role Baru ")])])):(i(),o("div",rt,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"},[S(" Nama Identitas Role "),t("span",{class:"text-red-500"},"*")],-1)),t("div",at,[e[19]||(e[19]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})])],-1)),K(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.name=a),type:"text",class:"input w-full pl-10 py-2.5 border-gray-300 dark:border-dark-600 focus:ring-primary-500 focus:border-primary-500 rounded-lg dark:bg-dark-900 dark:text-white",placeholder:"Contoh: staff_admin, supervisor_teknisi",disabled:E.value&&v((s=y.value)==null?void 0:s.name)},null,8,st),[[Y,l.value.name]])]),E.value&&v((n=y.value)==null?void 0:n.name)?(i(),o("p",nt,[...e[20]||(e[20]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),S(" Role sistem tidak dapat diubah namanya. ",-1)])])):g("",!0)]),t("div",null,[t("div",ot,[e[23]||(e[23]=t("div",null,[t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Preset Akses per Modul"),t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"}," Pilih level akses. Untuk detail granular, aktifkan mode lanjutan. ")],-1)),t("button",{type:"button",onClick:e[6]||(e[6]=a=>x.value=!x.value),class:"inline-flex items-center justify-center px-3 py-2 text-xs font-semibold rounded-xl border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-900 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-dark-800 transition-colors"},[e[22]||(e[22]=t("svg",{class:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),S(" "+c(x.value?"Sembunyikan Mode Lanjutan":"Tampilkan Mode Lanjutan"),1)])]),t("div",it,[t("div",lt,[(i(),o(_,null,L(de,a=>t("div",{key:a.key,class:k(["p-4 rounded-xl border bg-white dark:bg-dark-900 transition-colors",[$(a)==="custom"?"border-amber-200 dark:border-amber-900/40":"border-gray-100 dark:border-dark-700"]])},[t("div",dt,[t("div",null,[t("div",ut,[S(c(a.label)+" ",1),$(a)==="custom"?(i(),o("span",ct," Custom ")):g("",!0)]),t("div",mt,c(a.description),1)]),t("div",pt,[t("select",{value:$(a),onChange:u=>fe(a,u.target.value),class:"text-sm rounded-lg border border-gray-200 dark:border-dark-700 bg-white dark:bg-dark-800 text-gray-800 dark:text-gray-200 focus:ring-primary-500 focus:border-primary-500 px-3 py-2"},[e[24]||(e[24]=t("option",{value:"custom",disabled:""},"Custom",-1)),(i(),o(_,null,L(le,u=>t("option",{key:u.value,value:u.value},c(u.label),9,vt)),64))],40,gt)])]),t("div",bt,[(i(!0),o(_,null,L(N(a).head,u=>(i(),o("span",{key:u,class:"inline-flex items-center px-2 py-1 rounded text-[11px] font-medium bg-gray-50 dark:bg-dark-800 text-gray-600 dark:text-gray-300 border border-gray-100 dark:border-dark-700"},c(u),1))),128)),N(a).extra>0?(i(),o("span",kt," +"+c(N(a).extra),1)):g("",!0),N(a).list.length===0?(i(),o("span",yt," Tidak ada akses. ")):g("",!0)])],2)),64))])])]),x.value?(i(),o("div",ft,[t("div",xt,[e[26]||(e[26]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300"}," Mode Lanjutan: Checklist Permission ",-1)),t("div",ht,[e[25]||(e[25]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),K(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>M.value=a),type:"text",class:"w-full pl-9 pr-3 py-2 text-sm border border-gray-200 dark:border-dark-700 rounded-xl focus:ring-primary-500 focus:border-primary-500 dark:bg-dark-900 dark:text-white",placeholder:"Cari permission..."},null,512),[[Y,M.value]])])]),t("div",wt,[(i(!0),o(_,null,L(re.value,(a,u)=>(i(),o("div",{key:u,class:"bg-white dark:bg-dark-900 rounded-lg border border-gray-100 dark:border-dark-700 p-4 shadow-sm"},[t("div",_t,[t("h4",St,[e[27]||(e[27]=t("span",{class:"w-1.5 h-4 bg-primary-500 rounded-full mr-2"},null,-1)),S(" "+c(u),1)]),t("button",{type:"button",onClick:w=>ke(a),class:"text-xs text-primary-600 hover:text-primary-700 font-semibold hover:underline"}," Toggle Semua ",8,Ct)]),t("div",jt,[(i(!0),o(_,null,L(a,w=>(i(),o("label",{key:w.id,class:"group flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-800 cursor-pointer transition-colors border border-transparent hover:border-gray-200 dark:hover:border-dark-700"},[t("input",{type:"checkbox",checked:l.value.permissions.includes(w.name),onChange:ne=>be(w.name),class:"mt-0.5 rounded border-gray-300 text-primary-600 focus:ring-primary-500 cursor-pointer"},null,40,Mt),t("span",Tt,c(w.name),1)]))),128))])]))),128)),Object.keys(re.value).length===0?(i(),o("div",Lt,[...e[28]||(e[28]=[t("svg",{class:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",null,"Tidak ada permission yang cocok dengan pencarian.",-1)])])):g("",!0)]),t("div",Pt,[t("span",null,"Total Terpilih: "+c(l.value.permissions.length),1),t("span",null,"Total Tersedia: "+c(R.value.length),1)])])):g("",!0),E.value&&!v((d=y.value)==null?void 0:d.name)?(i(),o("div",Et,[t("div",{class:"flex items-center justify-between gap-3"},[e[30]||(e[30]=t("div",null,[t("div",{class:"text-sm font-extrabold text-gray-900 dark:text-white"},"Danger Zone"),t("div",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Hapus role ini dari sistem.")],-1)),t("button",{type:"button",onClick:ve,class:"inline-flex justify-center items-center px-4 py-2 text-xs font-semibold text-red-600 bg-red-50 dark:bg-red-900/20 border border-transparent rounded-xl hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"},[...e[29]||(e[29]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),S(" Hapus Role ",-1)])])])])):g("",!0)]))],2)])])]}),_:1})],64))}};export{Ot as default};
