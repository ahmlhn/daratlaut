import{C as ca,E as Lt,o as ba,G as ga,D as ya,c as s,a as St,u as xa,h as ka,m as ma,b as t,t as n,f as y,x as $,j as o,e as p,d as h,i as ot,n as W,F as N,s as E,w as Y,v as _,r as b,y as oe,z as fa}from"./app-Bbu4H21f.js";import{_ as _a}from"./AdminLayout-ryQMfyJt.js";const wa={class:"space-y-4 animate-fade-in"},ha={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 bg-white dark:bg-dark-800 p-5 rounded-xl shadow-card border border-gray-100 dark:border-dark-700"},Ca={class:"flex flex-wrap items-center gap-2"},Ta={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},Na={class:"font-semibold text-gray-900 dark:text-white"},Pa={class:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-dark-700 border border-gray-200 dark:border-dark-600 text-xs"},La={class:"font-semibold text-gray-900 dark:text-white"},Sa={class:"px-3 py-2 rounded-lg bg-red-50/60 dark:bg-red-900/10 border border-red-200/60 dark:border-red-900/30 text-xs"},Ea={class:"font-semibold text-red-700 dark:text-red-300"},Oa={class:"hidden lg:flex items-center gap-2 ml-2"},$a=["disabled"],Ua={key:0,class:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-900/30 text-amber-800 dark:text-amber-200 rounded-xl p-4 text-sm"},Va={key:1,class:"bg-white dark:bg-dark-800 border border-gray-100 dark:border-dark-700 rounded-xl p-6"},Fa={key:2,class:"grid grid-cols-1 lg:grid-cols-12 gap-4"},Ia={class:"lg:col-span-8 bg-white dark:bg-dark-800 rounded-xl shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden"},Ma={class:"flex flex-wrap items-center gap-2 p-3 border-b border-gray-100 dark:border-dark-700"},Aa={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Ba={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},Ga={class:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300"},ja={class:"ml-auto flex items-center gap-2 lg:hidden"},Da=["disabled"],Ra={class:"relative"},Ka={key:0,class:"absolute bottom-3 left-3 right-3 lg:right-auto lg:max-w-md bg-white/90 dark:bg-dark-900/80 backdrop-blur border border-gray-200 dark:border-white/10 rounded-xl p-3 text-xs text-gray-700 dark:text-gray-200 shadow-lg"},Ha={class:"font-semibold"},za={class:"uppercase"},Ja={class:"mt-2 flex items-center gap-2"},Za={class:"lg:col-span-4 bg-white dark:bg-dark-800 rounded-xl shadow-card border border-gray-100 dark:border-dark-700 overflow-hidden"},Xa={class:"flex items-center gap-1 border-b border-gray-100 dark:border-dark-700 overflow-x-auto"},Wa={class:"p-4"},Ya={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},qa={key:1,class:"text-sm text-red-600 dark:text-red-300"},Qa={key:2,class:"space-y-3"},el={class:"flex items-center justify-between"},tl={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},al={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},ll=["onClick"],sl={class:"flex items-start justify-between gap-2"},ol={class:"text-sm font-semibold text-gray-900 dark:text-white"},rl={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},nl={key:0},il={key:1,class:"ml-2"},dl={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ul={class:"font-medium text-gray-700 dark:text-gray-200"},pl={class:"font-medium text-gray-700 dark:text-gray-200"},vl={class:"flex items-center gap-1 shrink-0"},cl=["onClick"],bl=["onClick"],gl={key:3,class:"space-y-3"},yl={class:"flex items-center justify-between"},xl={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},kl={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},ml=["onClick"],fl={class:"flex items-start justify-between gap-2"},_l={class:"text-sm font-semibold text-gray-900 dark:text-white"},wl={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},hl={key:0},Cl={key:1,class:"ml-2"},Tl={class:"flex items-center gap-1 shrink-0"},Nl=["onClick"],Pl=["onClick"],Ll={key:4,class:"space-y-3"},Sl={class:"flex items-center justify-between"},El={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Ol={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},$l={class:"flex items-start justify-between gap-2"},Ul={class:"text-xs font-bold text-indigo-700 dark:text-indigo-300"},Vl={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},Fl={class:"text-xs text-gray-500 dark:text-gray-400 mt-1 space-y-0.5"},Il={class:"font-medium text-gray-700 dark:text-gray-200"},Ml={key:0},Al={class:"font-medium text-gray-700 dark:text-gray-200"},Bl={class:"ml-1"},Gl={class:"flex items-center gap-1 shrink-0"},jl=["onClick"],Dl=["onClick"],Rl={key:5,class:"space-y-3"},Kl={class:"flex items-center justify-between"},Hl={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},zl={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},Jl={class:"flex items-start justify-between gap-2"},Zl={class:"min-w-0"},Xl={class:"text-xs font-bold text-amber-700 dark:text-amber-300"},Wl={key:0,class:"ml-1"},Yl={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ql={class:"font-medium text-gray-700 dark:text-gray-200"},Ql={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1 truncate"},es={key:0,class:"text-gray-700 dark:text-gray-200"},ts={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},as={key:0},ls={key:1,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ss={class:"font-medium text-gray-700 dark:text-gray-200"},os={class:"flex items-center gap-1 shrink-0"},rs=["onClick"],ns=["onClick"],is={key:6,class:"space-y-3"},ds={class:"flex items-center justify-between"},us=["disabled"],ps={class:"space-y-2"},vs=["value"],cs={class:"flex items-center gap-2"},bs=["disabled"],gs=["disabled"],ys={key:0,class:"text-xs text-red-600 dark:text-red-300"},xs={key:0,class:"space-y-3"},ks={class:"text-xs text-gray-500 dark:text-gray-400"},ms={class:"font-semibold text-gray-800 dark:text-gray-200"},fs={class:"font-semibold text-gray-800 dark:text-gray-200"},_s={key:0,class:"ml-2 text-amber-700 dark:text-amber-300"},ws={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},hs={key:1,class:"space-y-2 max-h-[260px] overflow-auto pr-1"},Cs=["onClick"],Ts={class:"text-sm font-semibold text-gray-900 dark:text-white"},Ns={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Ps={class:"font-medium text-gray-700 dark:text-gray-200"},Ls={key:2,class:"rounded-xl border border-gray-100 dark:border-dark-700 p-3 bg-gray-50/40 dark:bg-dark-900/30"},Ss={class:"mt-2 space-y-1 max-h-[220px] overflow-auto pr-1"},Es={class:"font-medium text-gray-900 dark:text-white"},Os={class:"text-gray-600 dark:text-gray-300"},$s={key:7,class:"space-y-3"},Us={class:"flex items-center justify-between"},Vs={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Fs={key:1,class:"space-y-2 max-h-[420px] lg:max-h-[calc(100vh-18rem)] overflow-auto pr-1"},Is=["onClick"],Ms={class:"flex items-start justify-between gap-2"},As={class:"text-xs font-bold"},Bs={class:"text-sm font-semibold text-gray-900 dark:text-white mt-1"},Gs={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},js={key:0,class:"ml-2"},Ds={key:0,class:"text-xs text-gray-600 dark:text-gray-300 mt-1 line-clamp-2"},Rs={class:"flex items-center gap-1 shrink-0"},Ks=["onClick"],Hs=["onClick"],zs={key:0,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},Js={class:"relative w-full max-w-2xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},Zs={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Xs={class:"font-semibold text-gray-900 dark:text-white"},Ws={class:"p-4 space-y-3"},Ys={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},qs={key:0,class:"text-xs text-red-600 mt-1"},Qs={key:0,class:"text-xs text-red-600 mt-1"},eo={key:0,class:"text-xs text-red-600 mt-1"},to={key:0,class:"text-xs text-red-600 mt-1"},ao=["value"],lo=["value"],so={class:"md:col-span-2"},oo={class:"flex items-center gap-2"},ro={class:"md:col-span-2"},no={class:"rounded-xl border border-gray-100 dark:border-dark-700 p-3"},io={class:"flex items-center justify-between gap-2"},uo={class:"text-xs text-gray-500 dark:text-gray-400"},po={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},vo=["disabled"],co={key:1,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},bo={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},go={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},yo={class:"font-semibold text-gray-900 dark:text-white"},xo={class:"p-4 space-y-3"},ko={key:0,class:"text-xs text-red-600 mt-1"},mo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},fo={key:0,class:"text-xs text-red-600 mt-1"},_o={key:0,class:"text-xs text-red-600 mt-1"},wo={class:"flex items-center gap-2"},ho={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},Co=["disabled"],To={key:2,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},No={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},Po={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Lo={class:"font-semibold text-gray-900 dark:text-white"},So={class:"p-4 space-y-3"},Eo=["value"],Oo=["value"],$o={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Uo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Vo=["disabled"],Fo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Io={key:0,class:"text-xs text-red-600 mt-1"},Mo={key:0,class:"text-xs text-red-600 mt-1"},Ao={class:"flex items-center gap-2"},Bo={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},Go=["disabled"],jo={key:3,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},Do={class:"relative w-full max-w-xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},Ro={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},Ko={class:"font-semibold text-gray-900 dark:text-white"},Ho={class:"p-4 space-y-3"},zo=["value"],Jo={key:0,class:"text-xs text-red-600 mt-1"},Zo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Xo={key:0,class:"text-xs text-red-600 mt-1"},Wo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Yo=["value"],qo={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},Qo=["disabled"],er={key:4,class:"fixed inset-0 z-[80] flex items-center justify-center p-4"},tr={class:"relative w-full max-w-2xl bg-white dark:bg-dark-800 rounded-2xl shadow-xl border border-gray-100 dark:border-dark-700 overflow-hidden"},ar={class:"p-4 border-b border-gray-100 dark:border-dark-700 flex items-center justify-between"},lr={class:"font-semibold text-gray-900 dark:text-white"},sr={class:"p-4 space-y-3"},or=["value"],rr={key:0,class:"text-xs text-red-600 mt-1"},nr={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ir={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},dr=["value"],ur={key:0,class:"text-xs text-red-600 mt-1"},pr={key:0,class:"text-xs text-red-600 mt-1"},vr={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},cr=["value"],br={key:1,class:"space-y-3 rounded-xl border border-gray-100 dark:border-dark-700 p-3"},gr={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},yr={class:"flex items-center gap-2"},xr={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},kr={key:1,class:"space-y-2 max-h-[260px] overflow-auto pr-1"},mr={class:"col-span-7"},fr=["onUpdate:modelValue"],_r=["value"],wr={class:"col-span-3"},hr=["onUpdate:modelValue"],Cr={class:"col-span-2 flex items-center justify-end"},Tr=["onClick"],Nr={class:"p-4 border-t border-gray-100 dark:border-dark-700 flex items-center justify-end gap-2"},Pr=["disabled"],Or={__name:"Index",props:{tenantId:{type:Number,default:0},warning:{type:String,default:null}},setup(Et){const v=ca("toast"),rt=Et,nt=fa(),it=oe(()=>{var a,e;return((e=(a=nt.props.auth)==null?void 0:a.user)==null?void 0:e.permissions)||[]}),Ot=oe(()=>{var a,e;return(((e=(a=nt.props.auth)==null?void 0:a.user)==null?void 0:e.role)||"").toString().toLowerCase().trim()});function $t(a){const e=(a||"").toString().toLowerCase().trim();return e==="svp lapangan"?"svp_lapangan":e}function Ge(a){const e=$t(Ot.value);return["admin","owner"].includes(e)||it.value.includes("manage fiber")?!0:it.value.includes(a)}const dt=oe(()=>Ge("view fiber")),K=oe(()=>Ge("create fiber")),H=oe(()=>Ge("edit fiber")),z=oe(()=>Ge("delete fiber")),me=b(!1),Te=b(""),fe=b({cables:0,points:0,breaks_total:0,breaks_open:0}),j=b([]),D=b([]),Ne=b([]),Pe=b([]),je=b([]),P=b("cables"),Le=b(!0),Se=b(!0),Ee=b(!0),J=b(null),I=b(null),Z=b(null),q=b(null),De=b([]),ut=oe(()=>{const a=new Set;return(De.value||[]).forEach(e=>{const i=Number(e);Number.isFinite(i)&&i>0&&a.add(i)}),a});async function B(a,e={}){const i=await fetch(a,{credentials:"same-origin",headers:{Accept:"application/json",...e.headers||{}},...e}),r=await i.text();let u=null;try{u=r?JSON.parse(r):null}catch{u=null}return{ok:i.ok,status:i.status,data:u,text:r}}async function M(){var a,e,i,r,u,m,k,d,C,V,se,ke;if(dt.value){me.value=!0,Te.value="";try{const[O,F]=await Promise.all([B("/api/v1/fiber/map-data"),B("/api/v1/fiber/summary")]);if(!O.ok){const Qe=((a=O.data)==null?void 0:a.message)||`Gagal memuat data fiber (HTTP ${O.status}).`;throw new Error(Qe)}F.ok?fe.value=((e=F.data)==null?void 0:e.data)||fe.value:fe.value={cables:0,points:0,breaks_total:0,breaks_open:0},j.value=((r=(i=O.data)==null?void 0:i.data)==null?void 0:r.cables)||[],D.value=((m=(u=O.data)==null?void 0:u.data)==null?void 0:m.points)||[],Ne.value=((d=(k=O.data)==null?void 0:k.data)==null?void 0:d.breaks)||[],Pe.value=((V=(C=O.data)==null?void 0:C.data)==null?void 0:V.ports)||[],je.value=((ke=(se=O.data)==null?void 0:se.data)==null?void 0:ke.links)||[],gt(),It()}catch(O){console.error("Fiber: loadAll failed",O),Te.value=O&&O.message?O.message:"Gagal memuat data fiber."}finally{me.value=!1}}}const et=b(null);let L=null,_e=null,we=null,ue=null,pe=null,ve=null,re=null,pt=!1;const ne=b("voyager"),tt={voyager:{label:"Voyager",tile:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",tileOpts:{maxZoom:19,subdomains:"abcd"},labels:null},light:{label:"Light",tile:"https://{s}.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}{r}.png",tileOpts:{maxZoom:19,subdomains:"abcd"},labels:null},satellite:{label:"Satelit",tile:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",tileOpts:{maxZoom:19},labels:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",labelOpts:{maxZoom:19,opacity:.85}}};function vt(){if(!L)return;const a=tt[ne.value]||tt.voyager;if(_e){try{L.removeLayer(_e)}catch{}_e=null}if(we){try{L.removeLayer(we)}catch{}we=null}_e=window.L.tileLayer(a.tile,{attribution:"&copy; OpenStreetMap contributors",...a.tileOpts||{}}),_e.addTo(L),a.labels&&(we=window.L.tileLayer(a.labels,{...a.labelOpts||{}}),we.addTo(L))}function Ut(){!window.L||!et.value||(L=window.L.map(et.value,{zoomControl:!0}).setView([-2.5489,118.0149],5),ue=window.L.layerGroup().addTo(L),pe=window.L.layerGroup().addTo(L),ve=window.L.layerGroup().addTo(L),re=window.L.layerGroup().addTo(L),vt(),L.on("click",bt))}function Vt(){if(L){try{L.off("click",bt)}catch{}try{L.remove()}catch{}L=null,_e=null,we=null,ue=null,pe=null,ve=null,re=null}}const S=b(null);function ct(a){const e=Number(a);return Number.isFinite(e)?Math.round(e*1e7)/1e7:null}function bt(a){if(!(a!=null&&a.latlng))return;const e=ct(a.latlng.lat),i=ct(a.latlng.lng);if(S.value==="pickPoint"){f.value.latitude=e,f.value.longitude=i,S.value=null,v&&v.success("Lokasi titik dipilih dari peta."),U();return}if(S.value==="pickBreak"){x.value.latitude=e,x.value.longitude=i,S.value=null,v&&v.success("Lokasi putus dipilih dari peta."),U();return}if(S.value==="drawCable"){const r=Array.isArray(g.value.path)?g.value.path:[];r.push({lat:e,lng:i}),g.value.path=r,U()}}function G(){S.value=null,U()}function at(a){const e=document.createElement("div");return e.className="text-sm",(a||[]).forEach(i=>{const r=document.createElement("div");r.textContent=String(i??""),e.appendChild(r)}),e}function X(a){const e=Number(a||0);if(!e)return null;const i=(D.value||[]).find(r=>Number(r==null?void 0:r.id)===e);return i?String(i.name||""):null}function ie(a){const e=Number(a||0);if(!e)return null;const i=(j.value||[]).find(r=>Number(r==null?void 0:r.id)===e);return i?String(i.name||""):null}function Ft(a){const e=String(a||"").toUpperCase();return e==="OPEN"?{stroke:"#dc2626",fill:"#ef4444"}:e==="IN_PROGRESS"?{stroke:"#b45309",fill:"#f59e0b"}:e==="FIXED"?{stroke:"#047857",fill:"#10b981"}:{stroke:"#64748b",fill:"#94a3b8"}}function gt(){!L||!window.L||(Oe(),lt(),st(),U())}function Oe(){ue&&(ue.clearLayers(),Le.value&&(j.value||[]).forEach(a=>{const e=Array.isArray(a==null?void 0:a.path)?a.path:null;if(!e||e.length<2)return;const i=e.map(F=>[Number(F==null?void 0:F.lat),Number(F==null?void 0:F.lng)]).filter(F=>Number.isFinite(F[0])&&Number.isFinite(F[1]));if(i.length<2)return;const r=Number(a==null?void 0:a.id)===Number(J.value||0),u=ut.value.size>0,m=ut.value.has(Number(a==null?void 0:a.id)),k=((a==null?void 0:a.map_color)||"#2563eb").toString(),d=r?6:4,C=m?Math.max(d,6):d,V=u?m?1:.25:.9,se=window.L.polyline(i,{color:k,weight:C,opacity:V});se.on("click",()=>{J.value=a.id,I.value=null,Z.value=null,P.value="cables",Oe()});const ke=X(a==null?void 0:a.from_point_id)||"-",O=X(a==null?void 0:a.to_point_id)||"-";se.bindPopup(at([`Kabel: ${(a==null?void 0:a.name)||"-"}`,a!=null&&a.code?`Kode: ${a.code}`:null,a!=null&&a.cable_type?`Tipe: ${a.cable_type}`:null,a!=null&&a.core_count?`Core: ${a.core_count}`:null,`Dari: ${ke}`,`Ke: ${O}`].filter(Boolean))),se.addTo(ue)}))}function lt(){pe&&(pe.clearLayers(),Se.value&&(D.value||[]).forEach(a=>{const e=Number(a==null?void 0:a.latitude),i=Number(a==null?void 0:a.longitude);if(!Number.isFinite(e)||!Number.isFinite(i))return;const r=Number(a==null?void 0:a.id)===Number(I.value||0),u=window.L.circleMarker([e,i],{radius:r?8:6,color:"#0f766e",weight:2,fillColor:"#14b8a6",fillOpacity:.9});u.on("click",()=>{I.value=a.id,J.value=null,Z.value=null,P.value="points",lt()}),u.bindPopup(at([`Titik: ${(a==null?void 0:a.name)||"-"}`,a!=null&&a.point_type?`Tipe: ${a.point_type}`:null,`Koordinat: ${e}, ${i}`].filter(Boolean))),u.addTo(pe)}))}function st(){ve&&(ve.clearLayers(),Ee.value&&(Ne.value||[]).forEach(a=>{const e=Number(a==null?void 0:a.latitude),i=Number(a==null?void 0:a.longitude);if(!Number.isFinite(e)||!Number.isFinite(i))return;const r=Ft(a==null?void 0:a.status),u=Number(a==null?void 0:a.id)===Number(Z.value||0),m=window.L.circleMarker([e,i],{radius:u?9:7,color:r.stroke,weight:2,fillColor:r.fill,fillOpacity:.9});m.on("click",()=>{Z.value=a.id,J.value=null,I.value=null,P.value="breaks",st()});const k=ie(a==null?void 0:a.cable_id)||(a!=null&&a.cable_id?`#${a.cable_id}`:"-"),d=X(a==null?void 0:a.point_id)||(a!=null&&a.point_id?`#${a.point_id}`:"-");m.bindPopup(at([`PUTUS: ${String((a==null?void 0:a.status)||"OPEN").toUpperCase()}`,`Kabel: ${k}`,`Titik: ${d}`,a!=null&&a.severity?`Severity: ${a.severity}`:null].filter(Boolean))),m.addTo(ve)}))}function U(){if(!(!re||!window.L)){if(re.clearLayers(),ee.value&&f.value.latitude!==null&&f.value.longitude!==null){const a=Number(f.value.latitude),e=Number(f.value.longitude);Number.isFinite(a)&&Number.isFinite(e)&&window.L.circleMarker([a,e],{radius:7,color:"#0ea5e9",weight:2,fillColor:"#38bdf8",fillOpacity:.85}).addTo(re)}if(ae.value&&x.value.latitude!==null&&x.value.longitude!==null){const a=Number(x.value.latitude),e=Number(x.value.longitude);Number.isFinite(a)&&Number.isFinite(e)&&window.L.circleMarker([a,e],{radius:8,color:"#f97316",weight:2,fillColor:"#fb923c",fillOpacity:.85}).addTo(re)}if(Q.value&&Array.isArray(g.value.path)&&g.value.path.length>0){const a=g.value.path.map(e=>[Number(e==null?void 0:e.lat),Number(e==null?void 0:e.lng)]).filter(e=>Number.isFinite(e[0])&&Number.isFinite(e[1]));a.forEach(e=>{window.L.circleMarker(e,{radius:4,color:"#1d4ed8",weight:2,fillColor:"#60a5fa",fillOpacity:.95}).addTo(re)}),a.length>=2&&window.L.polyline(a,{color:"#1d4ed8",weight:4,opacity:.9,dashArray:"6, 8"}).addTo(re)}}}function It(){if(!L||pt)return;const a=[];try{ue&&Le.value&&ue.eachLayer(e=>{e.getBounds&&a.push(e.getBounds())})}catch{}try{pe&&Se.value&&pe.eachLayer(e=>{e.getLatLng&&a.push(window.L.latLngBounds([e.getLatLng(),e.getLatLng()]))})}catch{}try{ve&&Ee.value&&ve.eachLayer(e=>{e.getLatLng&&a.push(window.L.latLngBounds([e.getLatLng(),e.getLatLng()]))})}catch{}if(a.length!==0)try{let e=null;a.forEach(i=>{e?e.extend(i):e=i}),e&&e.isValid&&e.isValid()&&(L.fitBounds(e.pad(.2)),pt=!0)}catch{}}function Mt(a){const e=String(a||"OPEN").toUpperCase();return e==="IN_PROGRESS"?"IN PROGRESS":e}function yt(a){if(!a)return"";const e=new Date(a);if(!Number.isFinite(e.getTime()))return"";const i=r=>String(r).padStart(2,"0");return`${e.getFullYear()}-${i(e.getMonth()+1)}-${i(e.getDate())}T${i(e.getHours())}:${i(e.getMinutes())}`}function ce(a,e,i=17){!L||!Number.isFinite(a)||!Number.isFinite(e)||L.setView([a,e],i,{animate:!0})}const Q=b(!1),Re=b("create"),Ke=b(!1),R=b({}),g=b({id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],notes:""});function xt(){g.value={id:null,name:"",code:"",cable_type:"",core_count:"",map_color:"#2563eb",from_point_id:"",to_point_id:"",path:[],notes:""},R.value={}}function At(){K.value&&(xt(),Re.value="create",Q.value=!0,S.value=null,U())}function Bt(a){if(!H.value)return;xt(),Re.value="edit",g.value={id:a.id,name:a.name||"",code:a.code||"",cable_type:a.cable_type||"",core_count:a.core_count??"",map_color:a.map_color||"#2563eb",from_point_id:a.from_point_id??"",to_point_id:a.to_point_id??"",path:Array.isArray(a.path)?a.path.slice():[],notes:a.notes||""},Q.value=!0,S.value=null,U();const e=(g.value.path||[])[0];e&&Number.isFinite(Number(e.lat))&&Number.isFinite(Number(e.lng))&&ce(Number(e.lat),Number(e.lng),16)}async function Gt(){var u,m,k;Ke.value=!0,R.value={};const a={name:g.value.name,code:g.value.code||null,cable_type:g.value.cable_type||null,core_count:g.value.core_count!==""?Number(g.value.core_count):null,map_color:g.value.map_color||null,from_point_id:g.value.from_point_id!==""?Number(g.value.from_point_id):null,to_point_id:g.value.to_point_id!==""?Number(g.value.to_point_id):null,path:Array.isArray(g.value.path)&&g.value.path.length>=2?g.value.path:null,notes:g.value.notes||null},e=Re.value==="edit"&&g.value.id,i=e?`/api/v1/fiber/cables/${g.value.id}`:"/api/v1/fiber/cables",r=e?"PUT":"POST";try{const d=await B(i,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((u=d.data)!=null&&u.errors)?(R.value=d.data.errors,new Error(((m=d.data)==null?void 0:m.message)||"Validasi gagal.")):new Error(((k=d.data)==null?void 0:k.message)||`Gagal menyimpan kabel (HTTP ${d.status}).`);Q.value=!1,G(),await M(),v&&v.success("Kabel tersimpan.")}catch(d){console.error("Fiber: saveCable failed",d),v&&v.error((d==null?void 0:d.message)||"Gagal menyimpan kabel.")}finally{Ke.value=!1}}async function jt(a){var i;if(!(!z.value||!confirm(`Hapus kabel "${(a==null?void 0:a.name)||""}"?`)))try{const r=await B(`/api/v1/fiber/cables/${a.id}`,{method:"DELETE"});if(!r.ok)throw new Error(((i=r.data)==null?void 0:i.message)||`Gagal hapus kabel (HTTP ${r.status}).`);v&&v.success("Kabel dihapus."),Number(J.value)===Number(a.id)&&(J.value=null),await M()}catch(r){console.error("Fiber: deleteCable failed",r),v&&v.error((r==null?void 0:r.message)||"Gagal hapus kabel.")}}function Dt(){Q.value&&(S.value="drawCable",U(),v&&v.info("Mode gambar jalur aktif: klik peta untuk menambah titik."))}function kt(){const a=Array.isArray(g.value.path)?g.value.path:[];a.length!==0&&(a.pop(),g.value.path=a,U())}function mt(){g.value.path=[],U()}const ee=b(!1),He=b("create"),ze=b(!1),te=b({}),f=b({id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""});function ft(){f.value={id:null,name:"",point_type:"",latitude:null,longitude:null,address:"",notes:""},te.value={}}function Rt(){K.value&&(ft(),He.value="create",ee.value=!0,S.value=null,U())}function Kt(a){if(!H.value)return;ft(),He.value="edit",f.value={id:a.id,name:a.name||"",point_type:a.point_type||"",latitude:a.latitude??null,longitude:a.longitude??null,address:a.address||"",notes:a.notes||""},ee.value=!0,S.value=null,U();const e=Number(f.value.latitude),i=Number(f.value.longitude);Number.isFinite(e)&&Number.isFinite(i)&&ce(e,i,17)}function Ht(){ee.value&&(S.value="pickPoint",U(),v&&v.info("Klik peta untuk memilih lokasi titik."))}async function zt(){var u,m,k;ze.value=!0,te.value={};const a={name:f.value.name,point_type:f.value.point_type||null,latitude:f.value.latitude,longitude:f.value.longitude,address:f.value.address||null,notes:f.value.notes||null},e=He.value==="edit"&&f.value.id,i=e?`/api/v1/fiber/points/${f.value.id}`:"/api/v1/fiber/points",r=e?"PUT":"POST";try{const d=await B(i,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((u=d.data)!=null&&u.errors)?(te.value=d.data.errors,new Error(((m=d.data)==null?void 0:m.message)||"Validasi gagal.")):new Error(((k=d.data)==null?void 0:k.message)||`Gagal menyimpan titik (HTTP ${d.status}).`);ee.value=!1,G(),await M(),v&&v.success("Titik tersimpan.")}catch(d){console.error("Fiber: savePoint failed",d),v&&v.error((d==null?void 0:d.message)||"Gagal menyimpan titik.")}finally{ze.value=!1}}async function Jt(a){var i;if(!(!z.value||!confirm(`Hapus titik "${(a==null?void 0:a.name)||""}"?`)))try{const r=await B(`/api/v1/fiber/points/${a.id}`,{method:"DELETE"});if(!r.ok)throw new Error(((i=r.data)==null?void 0:i.message)||`Gagal hapus titik (HTTP ${r.status}).`);v&&v.success("Titik dihapus."),Number(I.value)===Number(a.id)&&(I.value=null),await M()}catch(r){console.error("Fiber: deletePoint failed",r),v&&v.error((r==null?void 0:r.message)||"Gagal hapus titik.")}}const ae=b(!1),Je=b("create"),Ze=b(!1),be=b({}),x=b({id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""});function _t(){x.value={id:null,cable_id:"",point_id:"",status:"OPEN",severity:"",reported_at:"",fixed_at:"",latitude:null,longitude:null,description:""},be.value={}}function Zt(){K.value&&(_t(),Je.value="create",ae.value=!0,S.value=null,U())}function Xt(a){if(!H.value)return;_t(),Je.value="edit",x.value={id:a.id,cable_id:a.cable_id??"",point_id:a.point_id??"",status:(a.status||"OPEN").toString().toUpperCase(),severity:a.severity||"",reported_at:yt(a.reported_at),fixed_at:yt(a.fixed_at),latitude:a.latitude??null,longitude:a.longitude??null,description:a.description||""},ae.value=!0,S.value=null,U();const e=Number(x.value.latitude),i=Number(x.value.longitude);Number.isFinite(e)&&Number.isFinite(i)&&ce(e,i,17)}function Wt(){ae.value&&(S.value="pickBreak",U(),v&&v.info("Klik peta untuk memilih lokasi putus."))}async function Yt(){var u,m,k;Ze.value=!0,be.value={};const a={cable_id:x.value.cable_id!==""?Number(x.value.cable_id):null,point_id:x.value.point_id!==""?Number(x.value.point_id):null,status:(x.value.status||"OPEN").toString().toUpperCase(),severity:x.value.severity||null,reported_at:x.value.reported_at||null,fixed_at:x.value.fixed_at||null,latitude:x.value.latitude,longitude:x.value.longitude,description:x.value.description||null},e=Je.value==="edit"&&x.value.id,i=e?`/api/v1/fiber/breaks/${x.value.id}`:"/api/v1/fiber/breaks",r=e?"PUT":"POST";try{const d=await B(i,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((u=d.data)!=null&&u.errors)?(be.value=d.data.errors,new Error(((m=d.data)==null?void 0:m.message)||"Validasi gagal.")):new Error(((k=d.data)==null?void 0:k.message)||`Gagal menyimpan data putus (HTTP ${d.status}).`);ae.value=!1,G(),await M(),v&&v.success("Data putus tersimpan.")}catch(d){console.error("Fiber: saveBreak failed",d),v&&v.error((d==null?void 0:d.message)||"Gagal menyimpan data putus.")}finally{Ze.value=!1}}async function qt(a){var i;if(!(!z.value||!confirm("Hapus data putus ini?")))try{const r=await B(`/api/v1/fiber/breaks/${a.id}`,{method:"DELETE"});if(!r.ok)throw new Error(((i=r.data)==null?void 0:i.message)||`Gagal hapus data putus (HTTP ${r.status}).`);v&&v.success("Data putus dihapus."),Number(Z.value)===Number(a.id)&&(Z.value=null),await M()}catch(r){console.error("Fiber: deleteBreak failed",r),v&&v.error((r==null?void 0:r.message)||"Gagal hapus data putus.")}}const ge=b(!1),Xe=b("create"),We=b(!1),ye=b({}),w=b({id:null,point_id:"",port_type:"OLT_PON",port_label:"",cable_id:"",core_no:"",notes:""});function wt(){w.value={id:null,point_id:"",port_type:"OLT_PON",port_label:"",cable_id:"",core_no:"",notes:""},ye.value={}}function Qt(){K.value&&(wt(),I.value&&(w.value.point_id=String(I.value)),Xe.value="create",ge.value=!0)}function ea(a){H.value&&(wt(),Xe.value="edit",w.value={id:a.id,point_id:a.point_id??"",port_type:a.port_type||"OLT_PON",port_label:a.port_label||"",cable_id:a.cable_id??"",core_no:a.core_no??"",notes:a.notes||""},ge.value=!0)}async function ta(){var u,m,k;We.value=!0,ye.value={};const a={point_id:w.value.point_id!==""?Number(w.value.point_id):null,port_type:(w.value.port_type||"OLT_PON").toString().toUpperCase(),port_label:w.value.port_label||"",cable_id:w.value.cable_id!==""?Number(w.value.cable_id):null,core_no:w.value.core_no!==""?Number(w.value.core_no):null,notes:w.value.notes||null},e=Xe.value==="edit"&&w.value.id,i=e?`/api/v1/fiber/ports/${w.value.id}`:"/api/v1/fiber/ports",r=e?"PUT":"POST";try{const d=await B(i,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!d.ok)throw d.status===422&&((u=d.data)!=null&&u.errors)?(ye.value=d.data.errors,new Error(((m=d.data)==null?void 0:m.message)||"Validasi gagal.")):new Error(((k=d.data)==null?void 0:k.message)||`Gagal menyimpan port (HTTP ${d.status}).`);ge.value=!1,await M(),v&&v.success("Port tersimpan.")}catch(d){console.error("Fiber: savePort failed",d),v&&v.error((d==null?void 0:d.message)||"Gagal menyimpan port.")}finally{We.value=!1}}async function aa(a){var i;if(!(!z.value||!confirm(`Hapus port "${(a==null?void 0:a.port_label)||""}"?`)))try{const r=await B(`/api/v1/fiber/ports/${a.id}`,{method:"DELETE"});if(!r.ok)throw new Error(((i=r.data)==null?void 0:i.message)||`Gagal hapus port (HTTP ${r.status}).`);v&&v.success("Port dihapus."),await M()}catch(r){console.error("Fiber: deletePort failed",r),v&&v.error((r==null?void 0:r.message)||"Gagal hapus port.")}}const de=b(!1),Ye=b("create"),qe=b(!1),le=b({}),$e=b(8),c=b({id:null,point_id:"",link_type:"SPLICE",from_cable_id:"",from_core_no:"",to_cable_id:"",to_core_no:"",split_group:"",outputs:[],loss_db:"",notes:""}),ht=oe(()=>{const a=Array.isArray(je.value)?je.value:[],e=[],i={};return a.forEach(r=>{const u=((r==null?void 0:r.link_type)||"").toString().toUpperCase(),m=((r==null?void 0:r.split_group)||"").toString();if(u==="SPLIT"&&m){const k=`${Number(r.point_id)||0}|${m}`;i[k]||(i[k]={kind:"SPLIT_GROUP",id:r.id,point_id:r.point_id,link_type:"SPLIT",split_group:m,from_cable_id:r.from_cable_id,from_core_no:r.from_core_no,loss_db:r.loss_db??null,notes:r.notes||"",outputs:[],link_ids:[]}),i[k].outputs.push({to_cable_id:r.to_cable_id,to_core_no:r.to_core_no}),i[k].link_ids.push(r.id);return}e.push({kind:"LINK",...r||{}})}),Object.values(i).forEach(r=>{r.outputs=(r.outputs||[]).filter(u=>(u==null?void 0:u.to_cable_id)&&(u==null?void 0:u.to_core_no)),e.push(r)}),e.sort((r,u)=>{const m=Number((r==null?void 0:r.point_id)||0),k=Number((u==null?void 0:u.point_id)||0);if(m!==k)return m-k;const d=((r==null?void 0:r.link_type)||"").toString(),C=((u==null?void 0:u.link_type)||"").toString();return d.localeCompare(C)}),e});function Ct(){c.value={id:null,point_id:"",link_type:"SPLICE",from_cable_id:"",from_core_no:"",to_cable_id:"",to_core_no:"",split_group:"",outputs:[],loss_db:"",notes:""},le.value={},$e.value=8}function la(a){const e=Math.max(1,Math.min(64,Number(a)||1));c.value.outputs=Array.from({length:e}).map(()=>({to_cable_id:"",to_core_no:""}))}function sa(){const a=Array.isArray(c.value.outputs)?c.value.outputs:[];a.push({to_cable_id:"",to_core_no:""}),c.value.outputs=a}function oa(a){const e=Array.isArray(c.value.outputs)?c.value.outputs:[];a<0||a>=e.length||(e.splice(a,1),c.value.outputs=e)}function ra(){K.value&&(Ct(),I.value&&(c.value.point_id=String(I.value)),Ye.value="create",de.value=!0)}function na(a){if(H.value){if(Ct(),Ye.value="edit",(a==null?void 0:a.kind)==="SPLIT_GROUP"){c.value={id:a.id,point_id:a.point_id??"",link_type:"SPLIT",from_cable_id:a.from_cable_id??"",from_core_no:a.from_core_no??"",to_cable_id:"",to_core_no:"",split_group:a.split_group||"",outputs:(a.outputs||[]).map(e=>({to_cable_id:e.to_cable_id??"",to_core_no:e.to_core_no??""})),loss_db:a.loss_db??"",notes:a.notes||""},$e.value=(c.value.outputs||[]).length||8,de.value=!0;return}c.value={id:a.id,point_id:a.point_id??"",link_type:(a.link_type||"SPLICE").toString().toUpperCase(),from_cable_id:a.from_cable_id??"",from_core_no:a.from_core_no??"",to_cable_id:a.to_cable_id??"",to_core_no:a.to_core_no??"",split_group:a.split_group||"",outputs:[],loss_db:a.loss_db??"",notes:a.notes||""},de.value=!0}}async function ia(){var m,k,d;qe.value=!0,le.value={};const a=(c.value.link_type||"SPLICE").toString().toUpperCase(),e={point_id:c.value.point_id!==""?Number(c.value.point_id):null,link_type:a,from_cable_id:c.value.from_cable_id!==""?Number(c.value.from_cable_id):null,from_core_no:c.value.from_core_no!==""?Number(c.value.from_core_no):null,split_group:c.value.split_group||null,loss_db:c.value.loss_db!==""?Number(c.value.loss_db):null,notes:c.value.notes||null};if(a==="SPLIT"){const C=Array.isArray(c.value.outputs)?c.value.outputs:[];e.outputs=C.map(V=>({to_cable_id:V.to_cable_id!==""?Number(V.to_cable_id):null,to_core_no:V.to_core_no!==""?Number(V.to_core_no):null})).filter(V=>V.to_cable_id&&V.to_core_no)}else e.to_cable_id=c.value.to_cable_id!==""?Number(c.value.to_cable_id):null,e.to_core_no=c.value.to_core_no!==""?Number(c.value.to_core_no):null;const i=Ye.value==="edit"&&c.value.id,r=i?`/api/v1/fiber/links/${c.value.id}`:"/api/v1/fiber/links",u=i?"PUT":"POST";try{const C=await B(r,{method:u,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!C.ok)throw C.status===422&&((m=C.data)!=null&&m.errors)?(le.value=C.data.errors,new Error(((k=C.data)==null?void 0:k.message)||"Validasi gagal.")):new Error(((d=C.data)==null?void 0:d.message)||`Gagal menyimpan sambungan (HTTP ${C.status}).`);de.value=!1,await M(),v&&v.success("Sambungan tersimpan.")}catch(C){console.error("Fiber: saveLink failed",C),v&&v.error((C==null?void 0:C.message)||"Gagal menyimpan sambungan.")}finally{qe.value=!1}}async function da(a){var r;if(!z.value)return;const e=(a==null?void 0:a.kind)==="SPLIT_GROUP"?`splitter "${(a==null?void 0:a.split_group)||""}"`:"sambungan ini";if(confirm(`Hapus ${e}?`))try{const u=await B(`/api/v1/fiber/links/${a.id}`,{method:"DELETE"});if(!u.ok)throw new Error(((r=u.data)==null?void 0:r.message)||`Gagal hapus sambungan (HTTP ${u.status}).`);v&&v.success("Sambungan dihapus."),await M()}catch(u){console.error("Fiber: deleteLink failed",u),v&&v.error((u==null?void 0:u.message)||"Gagal hapus sambungan.")}}const Ue=b(""),he=b(!1),Ce=b(""),xe=b(null),ua=oe(()=>(Pe.value||[]).filter(a=>((a==null?void 0:a.port_type)||"").toString().toUpperCase()==="OLT_PON"));function pa(){q.value=null,Ce.value="",xe.value=null,De.value=[],Oe()}async function va(){var a,e,i,r,u,m;if(Ue.value){he.value=!0,Ce.value="",q.value=null,xe.value=null,De.value=[];try{const k=await B(`/api/v1/fiber/trace/${Number(Ue.value)}?stop_at_odp_out=1`);if(!k.ok)throw new Error(((a=k.data)==null?void 0:a.message)||`Gagal trace (HTTP ${k.status}).`);q.value=((e=k.data)==null?void 0:e.data)||null,De.value=((r=(i=k.data)==null?void 0:i.data)==null?void 0:r.used_cable_ids)||[],Oe();const d=((m=(u=k.data)==null?void 0:u.data)==null?void 0:m.endpoints)||[];d.length>0&&(xe.value=d[0]),v&&v.success("Trace selesai.")}catch(k){console.error("Fiber: runTrace failed",k),Ce.value=(k==null?void 0:k.message)||"Gagal trace.",v&&v.error(Ce.value)}finally{he.value=!1}}}return Lt([Le,Se,Ee],()=>{gt()}),Lt(ne,()=>{try{localStorage.setItem("fiber_map_style",ne.value)}catch{}vt()}),ba(()=>{try{const e=localStorage.getItem("fiber_map_style");e&&tt[e]&&(ne.value=e)}catch{}(window.L?Promise.resolve():new Promise((e,i)=>{const r=document.createElement("link");r.rel="stylesheet",r.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(r);const u=document.createElement("script");u.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",u.onload=()=>e(),u.onerror=()=>i(new Error("Failed to load Leaflet")),document.head.appendChild(u)})).then(()=>{ga(()=>{Ut(),M()})}).catch(e=>{console.error("Fiber: Leaflet load failed",e),Te.value="Gagal memuat Leaflet. Cek koneksi internet."})}),ya(()=>{Vt()}),(a,e)=>(o(),s(N,null,[St(xa(ka),{title:"Kabel FO"}),St(_a,null,{default:ma(()=>{var i,r,u,m,k,d,C,V,se,ke,O,F,Qe,Tt,Nt;return[t("div",wa,[t("div",ha,[e[74]||(e[74]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Manajemen Kabel FO"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Pemetaan jalur kabel, titik sambungan, dan data putus.")],-1)),t("div",Ca,[t("div",Ta,[t("span",Na,n(fe.value.cables),1),e[70]||(e[70]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"kabel",-1))]),t("div",Pa,[t("span",La,n(fe.value.points),1),e[71]||(e[71]=t("span",{class:"text-gray-500 dark:text-gray-400 ml-1"},"titik",-1))]),t("div",Sa,[t("span",Ea,n(fe.value.breaks_open),1),e[72]||(e[72]=t("span",{class:"text-red-600/70 dark:text-red-300/70 ml-1"},"putus aktif",-1))]),t("div",Oa,[y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>ne.value=l),class:"input !py-2 !text-xs"},[...e[73]||(e[73]=[t("option",{value:"voyager"},"Voyager",-1),t("option",{value:"light"},"Light",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[$,ne.value]]),t("button",{onClick:M,class:"btn btn-secondary !py-2 !text-xs",disabled:me.value},"Refresh",8,$a)])])]),rt.warning?(o(),s("div",Ua,n(rt.warning),1)):p("",!0),dt.value?(o(),s("div",Fa,[t("div",Ia,[t("div",Ma,[t("label",Aa,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=l=>Le.value=l)},null,512),[[ot,Le.value]]),e[76]||(e[76]=h(" Kabel ",-1))]),t("label",Ba,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=l=>Se.value=l)},null,512),[[ot,Se.value]]),e[77]||(e[77]=h(" Titik ",-1))]),t("label",Ga,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>Ee.value=l)},null,512),[[ot,Ee.value]]),e[78]||(e[78]=h(" Putus ",-1))]),t("div",ja,[y(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>ne.value=l),class:"input !py-2 !text-xs"},[...e[79]||(e[79]=[t("option",{value:"voyager"},"Voyager",-1),t("option",{value:"light"},"Light",-1),t("option",{value:"satellite"},"Satelit",-1)])],512),[[$,ne.value]]),t("button",{onClick:M,class:"btn btn-secondary !py-2 !text-xs",disabled:me.value},"Refresh",8,Da)])]),t("div",Ra,[t("div",{ref_key:"mapContainer",ref:et,class:"w-full h-[420px] lg:h-[calc(100vh-13rem)] bg-slate-100 dark:bg-slate-900"},null,512),S.value?(o(),s("div",Ka,[t("div",Ha,[e[80]||(e[80]=h(" Mode peta aktif: ",-1)),t("span",za,n(S.value==="drawCable"?"gambar kabel":S.value==="pickPoint"?"pilih titik":"pilih putus"),1)]),e[81]||(e[81]=t("div",{class:"text-gray-600 dark:text-gray-300 mt-1"},"Klik peta untuk input. Tekan tombol untuk berhenti.",-1)),t("div",Ja,[t("button",{class:"btn btn-secondary !py-1 !text-xs",onClick:G},"Selesai"),S.value==="drawCable"?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !text-xs",onClick:kt},"Undo")):p("",!0),S.value==="drawCable"?(o(),s("button",{key:1,class:"btn btn-secondary !py-1 !text-xs",onClick:mt},"Clear")):p("",!0)])])):p("",!0)])]),t("div",Za,[t("div",Xa,[t("button",{onClick:e[5]||(e[5]=l=>P.value="cables"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="cables"?"text-blue-700 dark:text-blue-300 bg-blue-50/60 dark:bg-blue-900/10":"text-gray-600 dark:text-gray-300"])}," Kabel ("+n(j.value.length)+") ",3),t("button",{onClick:e[6]||(e[6]=l=>P.value="points"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="points"?"text-teal-700 dark:text-teal-300 bg-teal-50/60 dark:bg-teal-900/10":"text-gray-600 dark:text-gray-300"])}," Titik ("+n(D.value.length)+") ",3),t("button",{onClick:e[7]||(e[7]=l=>P.value="ports"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="ports"?"text-indigo-700 dark:text-indigo-300 bg-indigo-50/60 dark:bg-indigo-900/10":"text-gray-600 dark:text-gray-300"])}," Port ("+n(Pe.value.length)+") ",3),t("button",{onClick:e[8]||(e[8]=l=>P.value="links"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="links"?"text-amber-700 dark:text-amber-300 bg-amber-50/60 dark:bg-amber-900/10":"text-gray-600 dark:text-gray-300"])}," Sambungan ("+n(je.value.length)+") ",3),t("button",{onClick:e[9]||(e[9]=l=>P.value="trace"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="trace"?"text-slate-700 dark:text-slate-200 bg-slate-50/60 dark:bg-slate-700/30":"text-gray-600 dark:text-gray-300"])}," Trace ",2),t("button",{onClick:e[10]||(e[10]=l=>P.value="breaks"),class:W(["px-3 py-3 text-xs font-semibold whitespace-nowrap",P.value==="breaks"?"text-red-700 dark:text-red-300 bg-red-50/60 dark:bg-red-900/10":"text-gray-600 dark:text-gray-300"])}," Putus ("+n(Ne.value.length)+") ",3)]),t("div",Wa,[me.value?(o(),s("div",Ya,"Memuat...")):Te.value?(o(),s("div",qa,n(Te.value),1)):P.value==="cables"?(o(),s("div",Qa,[t("div",el,[e[82]||(e[82]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Daftar Kabel",-1)),K.value?(o(),s("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:At},"Tambah")):p("",!0)]),j.value.length===0?(o(),s("div",tl,"Belum ada data kabel.")):(o(),s("div",al,[(o(!0),s(N,null,E(j.value,l=>(o(),s("div",{key:l.id,class:W(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-blue-200 dark:hover:border-blue-900/40 cursor-pointer",Number(J.value)===Number(l.id)?"bg-blue-50/60 dark:bg-blue-900/10":"bg-white dark:bg-dark-800"]),onClick:T=>{J.value=l.id,I.value=null,Z.value=null,Oe()}},[t("div",sl,[t("div",null,[t("div",ol,n(l.name),1),t("div",rl,[l.cable_type?(o(),s("span",nl,n(l.cable_type),1)):p("",!0),l.core_count?(o(),s("span",il,"• "+n(l.core_count)+" core",1)):p("",!0)]),l.from_point_id||l.to_point_id?(o(),s("div",dl,[t("div",null,[e[83]||(e[83]=h("Dari: ",-1)),t("span",ul,n(X(l.from_point_id)||"-"),1)]),t("div",null,[e[84]||(e[84]=h("Ke: ",-1)),t("span",pl,n(X(l.to_point_id)||"-"),1)])])):p("",!0)]),t("div",vl,[H.value?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:Y(T=>Bt(l),["stop"])},"Edit",8,cl)):p("",!0),z.value?(o(),s("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:Y(T=>jt(l),["stop"])},"Hapus",8,bl)):p("",!0)])])],10,ll))),128))]))])):P.value==="points"?(o(),s("div",gl,[t("div",yl,[e[85]||(e[85]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Titik Sambungan",-1)),K.value?(o(),s("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Rt},"Tambah")):p("",!0)]),D.value.length===0?(o(),s("div",xl,"Belum ada data titik.")):(o(),s("div",kl,[(o(!0),s(N,null,E(D.value,l=>(o(),s("div",{key:l.id,class:W(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-teal-200 dark:hover:border-teal-900/40 cursor-pointer",Number(I.value)===Number(l.id)?"bg-teal-50/60 dark:bg-teal-900/10":"bg-white dark:bg-dark-800"]),onClick:T=>{I.value=l.id,J.value=null,Z.value=null,lt(),ce(Number(l.latitude),Number(l.longitude),17)}},[t("div",fl,[t("div",null,[t("div",_l,n(l.name),1),t("div",wl,[l.point_type?(o(),s("span",hl,n(l.point_type),1)):p("",!0),l.latitude&&l.longitude?(o(),s("span",Cl,"• "+n(l.latitude)+", "+n(l.longitude),1)):p("",!0)])]),t("div",Tl,[H.value?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:Y(T=>Kt(l),["stop"])},"Edit",8,Nl)):p("",!0),z.value?(o(),s("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:Y(T=>Jt(l),["stop"])},"Hapus",8,Pl)):p("",!0)])])],10,ml))),128))]))])):P.value==="ports"?(o(),s("div",Ll,[t("div",Sl,[e[86]||(e[86]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Port (OLT/ODP)",-1)),K.value?(o(),s("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Qt},"Tambah")):p("",!0)]),Pe.value.length===0?(o(),s("div",El,"Belum ada data port.")):(o(),s("div",Ol,[(o(!0),s(N,null,E(Pe.value,l=>(o(),s("div",{key:l.id,class:"p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-indigo-200 dark:hover:border-indigo-900/40 bg-white dark:bg-dark-800"},[t("div",$l,[t("div",null,[t("div",Ul,n(String(l.port_type||"").toUpperCase()),1),t("div",Vl,n(l.port_label||"#"+l.id),1),t("div",Fl,[t("div",null,[e[87]||(e[87]=h(" Titik: ",-1)),t("span",Il,n(X(l.point_id)||"#"+l.point_id),1)]),l.cable_id&&l.core_no?(o(),s("div",Ml,[e[88]||(e[88]=h(" Kabel: ",-1)),t("span",Al,n(ie(l.cable_id)||"Kabel #"+l.cable_id),1),t("span",Bl,"â€¢ core "+n(l.core_no),1)])):p("",!0)])]),t("div",Gl,[H.value?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:Y(T=>ea(l),["stop"])},"Edit",8,jl)):p("",!0),z.value?(o(),s("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:Y(T=>aa(l),["stop"])},"Hapus",8,Dl)):p("",!0)])])]))),128))]))])):P.value==="links"?(o(),s("div",Rl,[t("div",Kl,[e[89]||(e[89]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Sambungan (Splice/Split)",-1)),K.value?(o(),s("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:ra},"Tambah")):p("",!0)]),ht.value.length===0?(o(),s("div",Hl,"Belum ada data sambungan.")):(o(),s("div",zl,[(o(!0),s(N,null,E(ht.value,l=>(o(),s("div",{key:l.kind==="SPLIT_GROUP"?"g:"+l.split_group+":"+l.point_id:"l:"+l.id,class:"p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-amber-200 dark:hover:border-amber-900/40 bg-white dark:bg-dark-800"},[t("div",Jl,[t("div",Zl,[t("div",Xl,[h(n(l.kind==="SPLIT_GROUP"?"SPLIT":String(l.link_type||"").toUpperCase())+" ",1),l.kind==="SPLIT_GROUP"?(o(),s("span",Wl,"â€¢ "+n((l.outputs||[]).length)+" output",1)):p("",!0)]),t("div",Yl,[e[90]||(e[90]=h(" Titik: ",-1)),t("span",ql,n(X(l.point_id)||"#"+l.point_id),1)]),t("div",Ql,[h(n(ie(l.from_cable_id)||"Kabel #"+l.from_cable_id)+" â€¢ core "+n(l.from_core_no)+" ",1),e[91]||(e[91]=t("span",{class:"mx-1 text-gray-400"},"â†’",-1)),l.kind==="SPLIT_GROUP"?(o(),s("span",es,"splitter")):(o(),s(N,{key:1},[h(n(ie(l.to_cable_id)||"Kabel #"+l.to_cable_id)+" â€¢ core "+n(l.to_core_no),1)],64))]),l.kind==="SPLIT_GROUP"&&(l.outputs||[]).length?(o(),s("div",ts,[h(" Output: "+n((l.outputs||[]).slice(0,4).map(T=>`${ie(T.to_cable_id)||"#"+T.to_cable_id}:${T.to_core_no}`).join(", ")),1),(l.outputs||[]).length>4?(o(),s("span",as,", ...")):p("",!0)])):p("",!0),l.loss_db!==null&&l.loss_db!==void 0&&l.loss_db!==""?(o(),s("div",ls,[e[92]||(e[92]=h(" Loss: ",-1)),t("span",ss,n(l.loss_db)+" dB",1)])):p("",!0)]),t("div",os,[H.value?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:Y(T=>na(l),["stop"])},"Edit",8,rs)):p("",!0),z.value?(o(),s("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:Y(T=>da(l),["stop"])},"Hapus",8,ns)):p("",!0)])])]))),128))]))])):P.value==="trace"?(o(),s("div",is,[t("div",ds,[e[93]||(e[93]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Tracing End-to-End",-1)),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:pa,disabled:he.value},"Clear",8,us)]),t("div",ps,[t("div",null,[e[95]||(e[95]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Start Port (OLT_PON)",-1)),y(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>Ue.value=l),class:"input w-full"},[e[94]||(e[94]=t("option",{value:""},"(pilih port)",-1)),(o(!0),s(N,null,E(ua.value,l=>(o(),s("option",{key:l.id,value:l.id},n(X(l.point_id)||"#"+l.point_id)+" â€¢ "+n(l.port_label)+" â€¢ "+n(ie(l.cable_id)||"Kabel #"+l.cable_id)+":"+n(l.core_no),9,vs))),128))],512),[[$,Ue.value]])]),t("div",cs,[t("button",{class:"btn btn-primary !py-2 !text-xs",onClick:va,disabled:he.value||!Ue.value},n(he.value?"Tracing...":"Trace"),9,bs),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:M,disabled:me.value||he.value},"Refresh Data",8,gs)]),Ce.value?(o(),s("div",ys,n(Ce.value),1)):p("",!0)]),q.value?(o(),s("div",xs,[t("div",ks,[e[96]||(e[96]=h(" Endpoint: ",-1)),t("span",ms,n((q.value.endpoints||[]).length),1),e[97]||(e[97]=t("span",{class:"mx-2"},"â€¢",-1)),e[98]||(e[98]=h(" Visited: ",-1)),t("span",fs,n(q.value.visited_nodes||0),1),q.value.truncated?(o(),s("span",_s,"(truncated)")):p("",!0)]),(q.value.endpoints||[]).length===0?(o(),s("div",ws,[...e[99]||(e[99]=[h(" Tidak ada endpoint ",-1),t("span",{class:"font-mono"},"ODP_OUT",-1),h(" terjangkau dari port ini. ",-1)])])):(o(),s("div",hs,[(o(!0),s(N,null,E(q.value.endpoints||[],(l,T)=>{var A,Ve,Fe,Ie,Me,Ae,Be,Pt;return o(),s("div",{key:((A=l.port)==null?void 0:A.id)||T,class:W(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-slate-200 dark:hover:border-slate-700 cursor-pointer",xe.value===l?"bg-slate-50/60 dark:bg-slate-700/30":"bg-white dark:bg-dark-800"]),onClick:Lr=>xe.value=l},[t("div",Ts,n(((Ve=l.point)==null?void 0:Ve.name)||X((Fe=l.port)==null?void 0:Fe.point_id)||"-"),1),t("div",Ns,[e[100]||(e[100]=h(" Port: ",-1)),t("span",Ps,n(((Ie=l.port)==null?void 0:Ie.port_label)||"#"+((Me=l.port)==null?void 0:Me.id)),1),e[101]||(e[101]=t("span",{class:"mx-2"},"â€¢",-1)),h(" "+n(ie((Ae=l.port)==null?void 0:Ae.cable_id)||"Kabel #"+((Be=l.port)==null?void 0:Be.cable_id))+":"+n((Pt=l.port)==null?void 0:Pt.core_no),1)])],10,Cs)}),128))])),(i=xe.value)!=null&&i.path?(o(),s("div",Ls,[e[103]||(e[103]=t("div",{class:"text-xs font-semibold text-gray-900 dark:text-white"},"Path (ringkas)",-1)),t("div",Ss,[(o(!0),s(N,null,E(xe.value.path,(l,T)=>{var A,Ve,Fe,Ie,Me,Ae,Be;return o(),s("div",{key:T,class:"text-xs"},[t("div",Es,[h(n(T===0?"START":((A=l.edge)==null?void 0:A.type)==="CABLE"?"KABEL":"LINK "+(((Ve=l.edge)==null?void 0:Ve.link_type)||""))+" ",1),e[102]||(e[102]=t("span",{class:"mx-1 text-gray-400"},"â€¢",-1)),h(" "+n(((Fe=l.point)==null?void 0:Fe.name)||"Titik #"+((Ie=l.node)==null?void 0:Ie.point_id)),1)]),t("div",Os,n(((Me=l.cable)==null?void 0:Me.name)||"Kabel #"+((Ae=l.node)==null?void 0:Ae.cable_id))+" â€¢ core "+n((Be=l.node)==null?void 0:Be.core_no),1)])}),128))])])):p("",!0)])):p("",!0)])):(o(),s("div",$s,[t("div",Us,[e[104]||(e[104]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Data Putus",-1)),K.value?(o(),s("button",{key:0,class:"btn btn-primary !py-2 !text-xs",onClick:Zt},"Tambah")):p("",!0)]),Ne.value.length===0?(o(),s("div",Vs,"Belum ada data putus.")):(o(),s("div",Fs,[(o(!0),s(N,null,E(Ne.value,l=>(o(),s("div",{key:l.id,class:W(["p-3 rounded-xl border border-gray-100 dark:border-dark-700 hover:border-red-200 dark:hover:border-red-900/40 cursor-pointer",Number(Z.value)===Number(l.id)?"bg-red-50/60 dark:bg-red-900/10":"bg-white dark:bg-dark-800"]),onClick:T=>{Z.value=l.id,J.value=null,I.value=null,st(),ce(Number(l.latitude),Number(l.longitude),17)}},[t("div",Ms,[t("div",null,[t("div",As,n(Mt(l.status)),1),t("div",Bs,n(ie(l.cable_id)||(l.cable_id?"Kabel #"+l.cable_id:"Tanpa kabel")),1),t("div",Gs,[t("span",null,"Titik: "+n(X(l.point_id)||"-"),1),l.severity?(o(),s("span",js,"• "+n(l.severity),1)):p("",!0)]),l.description?(o(),s("div",Ds,n(l.description),1)):p("",!0)]),t("div",Rs,[H.value?(o(),s("button",{key:0,class:"btn btn-secondary !py-1 !px-2 !text-xs",onClick:Y(T=>Xt(l),["stop"])},"Edit",8,Ks)):p("",!0),z.value?(o(),s("button",{key:1,class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:Y(T=>qt(l),["stop"])},"Hapus",8,Hs)):p("",!0)])])],10,Is))),128))]))]))])])])):(o(),s("div",Va,[...e[75]||(e[75]=[t("div",{class:"text-gray-900 dark:text-white font-semibold"},"Tidak punya akses",-1),t("div",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},[h(" Butuh permission "),t("code",{class:"px-1 py-0.5 bg-gray-100 dark:bg-dark-700 rounded"},"view fiber"),h(". ")],-1)])]))]),Q.value?(o(),s("div",zs,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[12]||(e[12]=l=>{Q.value=!1,G()})}),t("div",Js,[t("div",Zs,[t("div",Xs,n(Re.value==="edit"?"Edit Kabel":"Tambah Kabel"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[13]||(e[13]=l=>{Q.value=!1,G()})},"Tutup")]),t("div",Ws,[t("div",Ys,[t("div",null,[e[105]||(e[105]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),y(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>g.value.name=l),class:"input w-full",placeholder:"Feeder ODC-POP A"},null,512),[[_,g.value.name]]),R.value.name?(o(),s("div",qs,n((r=R.value.name)==null?void 0:r[0]),1)):p("",!0)]),t("div",null,[e[106]||(e[106]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kode (opsional)",-1)),y(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>g.value.code=l),class:"input w-full",placeholder:"FO-001"},null,512),[[_,g.value.code]]),R.value.code?(o(),s("div",Qs,n((u=R.value.code)==null?void 0:u[0]),1)):p("",!0)]),t("div",null,[e[107]||(e[107]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),y(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>g.value.cable_type=l),class:"input w-full",placeholder:"FEEDER / DISTRIBUTION / DROP"},null,512),[[_,g.value.cable_type]]),R.value.cable_type?(o(),s("div",eo,n((m=R.value.cable_type)==null?void 0:m[0]),1)):p("",!0)]),t("div",null,[e[108]||(e[108]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Core",-1)),y(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>g.value.core_count=l),type:"number",min:"1",class:"input w-full",placeholder:"12"},null,512),[[_,g.value.core_count]]),R.value.core_count?(o(),s("div",to,n((k=R.value.core_count)==null?void 0:k[0]),1)):p("",!0)]),t("div",null,[e[110]||(e[110]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dari Titik",-1)),y(t("select",{"onUpdate:modelValue":e[18]||(e[18]=l=>g.value.from_point_id=l),class:"input w-full"},[e[109]||(e[109]=t("option",{value:""},"(kosong)",-1)),(o(!0),s(N,null,E(D.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,ao))),128))],512),[[$,g.value.from_point_id]])]),t("div",null,[e[112]||(e[112]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Ke Titik",-1)),y(t("select",{"onUpdate:modelValue":e[19]||(e[19]=l=>g.value.to_point_id=l),class:"input w-full"},[e[111]||(e[111]=t("option",{value:""},"(kosong)",-1)),(o(!0),s(N,null,E(D.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,lo))),128))],512),[[$,g.value.to_point_id]])]),t("div",so,[e[113]||(e[113]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Warna Jalur",-1)),t("div",oo,[y(t("input",{"onUpdate:modelValue":e[20]||(e[20]=l=>g.value.map_color=l),type:"color",class:"h-10 w-14 rounded border border-gray-200 dark:border-dark-700 bg-transparent"},null,512),[[_,g.value.map_color]]),y(t("input",{"onUpdate:modelValue":e[21]||(e[21]=l=>g.value.map_color=l),class:"input flex-1",placeholder:"#2563eb"},null,512),[[_,g.value.map_color]])])]),t("div",ro,[e[114]||(e[114]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),y(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=l=>g.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"Keterangan kabel..."},null,512),[[_,g.value.notes]])])]),t("div",no,[t("div",io,[t("div",null,[e[115]||(e[115]=t("div",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Jalur di Peta",-1)),t("div",uo,"Titik: "+n(Array.isArray(g.value.path)?g.value.path.length:0),1)]),t("div",{class:"flex flex-wrap items-center gap-2"},[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Dt},"Gambar"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:kt},"Undo"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:mt},"Clear")])])])]),t("div",po,[t("button",{class:"btn btn-secondary",onClick:e[23]||(e[23]=l=>{Q.value=!1,G()})},"Batal"),t("button",{class:"btn btn-primary",disabled:Ke.value,onClick:Gt},n(Ke.value?"Menyimpan...":"Simpan"),9,vo)])])])):p("",!0),ee.value?(o(),s("div",co,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[24]||(e[24]=l=>{ee.value=!1,G()})}),t("div",bo,[t("div",go,[t("div",yo,n(He.value==="edit"?"Edit Titik":"Tambah Titik"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[25]||(e[25]=l=>{ee.value=!1,G()})},"Tutup")]),t("div",xo,[t("div",null,[e[116]||(e[116]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Nama",-1)),y(t("input",{"onUpdate:modelValue":e[26]||(e[26]=l=>f.value.name=l),class:"input w-full",placeholder:"ODP-01 / Joint A"},null,512),[[_,f.value.name]]),te.value.name?(o(),s("div",ko,n((d=te.value.name)==null?void 0:d[0]),1)):p("",!0)]),t("div",null,[e[117]||(e[117]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),y(t("input",{"onUpdate:modelValue":e[27]||(e[27]=l=>f.value.point_type=l),class:"input w-full",placeholder:"ODP / ODC / JOINT / HANDHOLE"},null,512),[[_,f.value.point_type]])]),t("div",mo,[t("div",null,[e[118]||(e[118]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),y(t("input",{"onUpdate:modelValue":e[28]||(e[28]=l=>f.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[_,f.value.latitude]]),te.value.latitude?(o(),s("div",fo,n((C=te.value.latitude)==null?void 0:C[0]),1)):p("",!0)]),t("div",null,[e[119]||(e[119]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),y(t("input",{"onUpdate:modelValue":e[29]||(e[29]=l=>f.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[_,f.value.longitude]]),te.value.longitude?(o(),s("div",_o,n((V=te.value.longitude)==null?void 0:V[0]),1)):p("",!0)])]),t("div",wo,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Ht},"Pilih dari peta"),f.value.latitude&&f.value.longitude?(o(),s("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[30]||(e[30]=l=>ce(Number(f.value.latitude),Number(f.value.longitude),18))},"Zoom")):p("",!0)]),t("div",null,[e[120]||(e[120]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Alamat",-1)),y(t("input",{"onUpdate:modelValue":e[31]||(e[31]=l=>f.value.address=l),class:"input w-full",placeholder:"(opsional)"},null,512),[[_,f.value.address]])]),t("div",null,[e[121]||(e[121]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),y(t("textarea",{"onUpdate:modelValue":e[32]||(e[32]=l=>f.value.notes=l),class:"input w-full min-h-[80px]",placeholder:"(opsional)"},null,512),[[_,f.value.notes]])])]),t("div",ho,[t("button",{class:"btn btn-secondary",onClick:e[33]||(e[33]=l=>{ee.value=!1,G()})},"Batal"),t("button",{class:"btn btn-primary",disabled:ze.value,onClick:zt},n(ze.value?"Menyimpan...":"Simpan"),9,Co)])])])):p("",!0),ae.value?(o(),s("div",To,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[34]||(e[34]=l=>{ae.value=!1,G()})}),t("div",No,[t("div",Po,[t("div",Lo,n(Je.value==="edit"?"Edit Data Putus":"Tambah Data Putus"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[35]||(e[35]=l=>{ae.value=!1,G()})},"Tutup")]),t("div",So,[t("div",null,[e[123]||(e[123]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kabel",-1)),y(t("select",{"onUpdate:modelValue":e[36]||(e[36]=l=>x.value.cable_id=l),class:"input w-full"},[e[122]||(e[122]=t("option",{value:""},"(kosong)",-1)),(o(!0),s(N,null,E(j.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,Eo))),128))],512),[[$,x.value.cable_id]])]),t("div",null,[e[125]||(e[125]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik (opsional)",-1)),y(t("select",{"onUpdate:modelValue":e[37]||(e[37]=l=>x.value.point_id=l),class:"input w-full"},[e[124]||(e[124]=t("option",{value:""},"(kosong)",-1)),(o(!0),s(N,null,E(D.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,Oo))),128))],512),[[$,x.value.point_id]])]),t("div",$o,[t("div",null,[e[127]||(e[127]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Status",-1)),y(t("select",{"onUpdate:modelValue":e[38]||(e[38]=l=>x.value.status=l),class:"input w-full"},[...e[126]||(e[126]=[t("option",{value:"OPEN"},"OPEN",-1),t("option",{value:"IN_PROGRESS"},"IN_PROGRESS",-1),t("option",{value:"FIXED"},"FIXED",-1),t("option",{value:"CANCELLED"},"CANCELLED",-1)])],512),[[$,x.value.status]])]),t("div",null,[e[129]||(e[129]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Severity",-1)),y(t("select",{"onUpdate:modelValue":e[39]||(e[39]=l=>x.value.severity=l),class:"input w-full"},[...e[128]||(e[128]=[t("option",{value:""},"(kosong)",-1),t("option",{value:"MINOR"},"MINOR",-1),t("option",{value:"MAJOR"},"MAJOR",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)])],512),[[$,x.value.severity]])])]),t("div",Uo,[t("div",null,[e[130]||(e[130]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Dilaporkan",-1)),y(t("input",{"onUpdate:modelValue":e[40]||(e[40]=l=>x.value.reported_at=l),type:"datetime-local",class:"input w-full"},null,512),[[_,x.value.reported_at]])]),t("div",null,[e[131]||(e[131]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Fixed At",-1)),y(t("input",{"onUpdate:modelValue":e[41]||(e[41]=l=>x.value.fixed_at=l),type:"datetime-local",class:"input w-full",disabled:String(x.value.status).toUpperCase()!=="FIXED"},null,8,Vo),[[_,x.value.fixed_at]])])]),t("div",Fo,[t("div",null,[e[132]||(e[132]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Latitude",-1)),y(t("input",{"onUpdate:modelValue":e[42]||(e[42]=l=>x.value.latitude=l),class:"input w-full",placeholder:"-6.2"},null,512),[[_,x.value.latitude]]),be.value.latitude?(o(),s("div",Io,n((se=be.value.latitude)==null?void 0:se[0]),1)):p("",!0)]),t("div",null,[e[133]||(e[133]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Longitude",-1)),y(t("input",{"onUpdate:modelValue":e[43]||(e[43]=l=>x.value.longitude=l),class:"input w-full",placeholder:"106.8"},null,512),[[_,x.value.longitude]]),be.value.longitude?(o(),s("div",Mo,n((ke=be.value.longitude)==null?void 0:ke[0]),1)):p("",!0)])]),t("div",Ao,[t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:Wt},"Pilih dari peta"),x.value.latitude&&x.value.longitude?(o(),s("button",{key:0,class:"btn btn-secondary !py-2 !text-xs",onClick:e[44]||(e[44]=l=>ce(Number(x.value.latitude),Number(x.value.longitude),18))},"Zoom")):p("",!0)]),t("div",null,[e[134]||(e[134]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),y(t("textarea",{"onUpdate:modelValue":e[45]||(e[45]=l=>x.value.description=l),class:"input w-full min-h-[90px]",placeholder:"Keterangan kejadian putus..."},null,512),[[_,x.value.description]])])]),t("div",Bo,[t("button",{class:"btn btn-secondary",onClick:e[46]||(e[46]=l=>{ae.value=!1,G()})},"Batal"),t("button",{class:"btn btn-primary",disabled:Ze.value,onClick:Yt},n(Ze.value?"Menyimpan...":"Simpan"),9,Go)])])])):p("",!0),ge.value?(o(),s("div",jo,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[47]||(e[47]=l=>ge.value=!1)}),t("div",Do,[t("div",Ro,[t("div",Ko,n(Xe.value==="edit"?"Edit Port":"Tambah Port"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[48]||(e[48]=l=>ge.value=!1)},"Tutup")]),t("div",Ho,[t("div",null,[e[136]||(e[136]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik",-1)),y(t("select",{"onUpdate:modelValue":e[49]||(e[49]=l=>w.value.point_id=l),class:"input w-full"},[e[135]||(e[135]=t("option",{value:""},"(pilih titik)",-1)),(o(!0),s(N,null,E(D.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,zo))),128))],512),[[$,w.value.point_id]]),ye.value.point_id?(o(),s("div",Jo,n((O=ye.value.point_id)==null?void 0:O[0]),1)):p("",!0)]),t("div",Zo,[t("div",null,[e[138]||(e[138]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),y(t("select",{"onUpdate:modelValue":e[50]||(e[50]=l=>w.value.port_type=l),class:"input w-full"},[...e[137]||(e[137]=[t("option",{value:"OLT_PON"},"OLT_PON",-1),t("option",{value:"ODP_OUT"},"ODP_OUT",-1)])],512),[[$,w.value.port_type]])]),t("div",null,[e[139]||(e[139]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Label",-1)),y(t("input",{"onUpdate:modelValue":e[51]||(e[51]=l=>w.value.port_label=l),class:"input w-full",placeholder:"PON 1/1/1 / OUT 1"},null,512),[[_,w.value.port_label]]),ye.value.port_label?(o(),s("div",Xo,n((F=ye.value.port_label)==null?void 0:F[0]),1)):p("",!0)])]),t("div",Wo,[t("div",null,[e[141]||(e[141]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Kabel",-1)),y(t("select",{"onUpdate:modelValue":e[52]||(e[52]=l=>w.value.cable_id=l),class:"input w-full"},[e[140]||(e[140]=t("option",{value:""},"(pilih kabel)",-1)),(o(!0),s(N,null,E(j.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,Yo))),128))],512),[[$,w.value.cable_id]])]),t("div",null,[e[142]||(e[142]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Core",-1)),y(t("input",{"onUpdate:modelValue":e[53]||(e[53]=l=>w.value.core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[_,w.value.core_no]])])]),t("div",null,[e[143]||(e[143]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),y(t("textarea",{"onUpdate:modelValue":e[54]||(e[54]=l=>w.value.notes=l),class:"input w-full min-h-[90px]",placeholder:"(opsional)"},null,512),[[_,w.value.notes]])])]),t("div",qo,[t("button",{class:"btn btn-secondary",onClick:e[55]||(e[55]=l=>ge.value=!1)},"Batal"),t("button",{class:"btn btn-primary",disabled:We.value,onClick:ta},n(We.value?"Menyimpan...":"Simpan"),9,Qo)])])])):p("",!0),de.value?(o(),s("div",er,[t("div",{class:"absolute inset-0 bg-black/40",onClick:e[56]||(e[56]=l=>de.value=!1)}),t("div",tr,[t("div",ar,[t("div",lr,n(Ye.value==="edit"?"Edit Sambungan":"Tambah Sambungan"),1),t("button",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white",onClick:e[57]||(e[57]=l=>de.value=!1)},"Tutup")]),t("div",sr,[t("div",null,[e[145]||(e[145]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Titik",-1)),y(t("select",{"onUpdate:modelValue":e[58]||(e[58]=l=>c.value.point_id=l),class:"input w-full"},[e[144]||(e[144]=t("option",{value:""},"(pilih titik)",-1)),(o(!0),s(N,null,E(D.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,or))),128))],512),[[$,c.value.point_id]]),le.value.point_id?(o(),s("div",rr,n((Qe=le.value.point_id)==null?void 0:Qe[0]),1)):p("",!0)]),t("div",nr,[t("div",null,[e[147]||(e[147]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Tipe",-1)),y(t("select",{"onUpdate:modelValue":e[59]||(e[59]=l=>c.value.link_type=l),class:"input w-full"},[...e[146]||(e[146]=[t("option",{value:"SPLICE"},"SPLICE",-1),t("option",{value:"PATCH"},"PATCH",-1),t("option",{value:"SPLIT"},"SPLIT",-1)])],512),[[$,c.value.link_type]])]),t("div",null,[e[148]||(e[148]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Loss (dB)",-1)),y(t("input",{"onUpdate:modelValue":e[60]||(e[60]=l=>c.value.loss_db=l),class:"input w-full",placeholder:"0.20"},null,512),[[_,c.value.loss_db]])])]),t("div",ir,[t("div",null,[e[150]||(e[150]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"From Cable",-1)),y(t("select",{"onUpdate:modelValue":e[61]||(e[61]=l=>c.value.from_cable_id=l),class:"input w-full"},[e[149]||(e[149]=t("option",{value:""},"(pilih kabel)",-1)),(o(!0),s(N,null,E(j.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,dr))),128))],512),[[$,c.value.from_cable_id]]),le.value.from_cable_id?(o(),s("div",ur,n((Tt=le.value.from_cable_id)==null?void 0:Tt[0]),1)):p("",!0)]),t("div",null,[e[151]||(e[151]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"From Core",-1)),y(t("input",{"onUpdate:modelValue":e[62]||(e[62]=l=>c.value.from_core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[_,c.value.from_core_no]]),le.value.from_core_no?(o(),s("div",pr,n((Nt=le.value.from_core_no)==null?void 0:Nt[0]),1)):p("",!0)])]),String(c.value.link_type).toUpperCase()!=="SPLIT"?(o(),s("div",vr,[t("div",null,[e[153]||(e[153]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"To Cable",-1)),y(t("select",{"onUpdate:modelValue":e[63]||(e[63]=l=>c.value.to_cable_id=l),class:"input w-full"},[e[152]||(e[152]=t("option",{value:""},"(pilih kabel)",-1)),(o(!0),s(N,null,E(j.value,l=>(o(),s("option",{key:l.id,value:l.id},n(l.name),9,cr))),128))],512),[[$,c.value.to_cable_id]])]),t("div",null,[e[154]||(e[154]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"To Core",-1)),y(t("input",{"onUpdate:modelValue":e[64]||(e[64]=l=>c.value.to_core_no=l),type:"number",min:"1",class:"input w-full",placeholder:"1"},null,512),[[_,c.value.to_core_no]])])])):(o(),s("div",br,[t("div",gr,[t("div",null,[e[155]||(e[155]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Splitter Group (opsional)",-1)),y(t("input",{"onUpdate:modelValue":e[65]||(e[65]=l=>c.value.split_group=l),class:"input w-full",placeholder:"ODP-01 1:8"},null,512),[[_,c.value.split_group]])]),t("div",null,[e[156]||(e[156]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Jumlah Output",-1)),t("div",yr,[y(t("input",{"onUpdate:modelValue":e[66]||(e[66]=l=>$e.value=l),type:"number",min:"1",max:"64",class:"input w-full"},null,512),[[_,$e.value]]),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:e[67]||(e[67]=l=>la($e.value))},"Buat"),t("button",{class:"btn btn-secondary !py-2 !text-xs",onClick:sa},"Tambah")])])]),(c.value.outputs||[]).length===0?(o(),s("div",xr,[...e[157]||(e[157]=[h(" Output masih kosong. Klik ",-1),t("span",{class:"font-semibold"},"Buat",-1),h(" untuk generate baris output. ",-1)])])):(o(),s("div",kr,[(o(!0),s(N,null,E(c.value.outputs,(l,T)=>(o(),s("div",{key:T,class:"grid grid-cols-12 gap-2 items-center"},[t("div",mr,[y(t("select",{"onUpdate:modelValue":A=>l.to_cable_id=A,class:"input w-full"},[e[158]||(e[158]=t("option",{value:""},"(kabel output)",-1)),(o(!0),s(N,null,E(j.value,A=>(o(),s("option",{key:A.id,value:A.id},n(A.name),9,_r))),128))],8,fr),[[$,l.to_cable_id]])]),t("div",wr,[y(t("input",{"onUpdate:modelValue":A=>l.to_core_no=A,type:"number",min:"1",class:"input w-full",placeholder:"core"},null,8,hr),[[_,l.to_core_no]])]),t("div",Cr,[t("button",{class:"btn btn-danger !py-1 !px-2 !text-xs",onClick:A=>oa(T)},"Hapus",8,Tr)])]))),128))]))])),t("div",null,[e[159]||(e[159]=t("label",{class:"text-xs text-gray-600 dark:text-gray-300"},"Catatan",-1)),y(t("textarea",{"onUpdate:modelValue":e[68]||(e[68]=l=>c.value.notes=l),class:"input w-full min-h-[90px]",placeholder:"(opsional)"},null,512),[[_,c.value.notes]])])]),t("div",Nr,[t("button",{class:"btn btn-secondary",onClick:e[69]||(e[69]=l=>de.value=!1)},"Batal"),t("button",{class:"btn btn-primary",disabled:qe.value,onClick:ia},n(qe.value?"Menyimpan...":"Simpan"),9,Pr)])])])):p("",!0)]}),_:1})],64))}};export{Or as default};
