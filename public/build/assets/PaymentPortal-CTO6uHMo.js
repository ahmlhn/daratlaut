import{o as z,c as l,a as L,u as T,h as V,b as t,t as a,n as g,d as j,e as u,F as M,s as E,K as h,A as k,r as c,y as w,j as n}from"./app-hPBQb67R.js";const R={class:"min-h-screen bg-gray-100 py-8 px-4"},q={class:"max-w-lg mx-auto"},F={class:"text-center mb-8"},$={class:"text-gray-600 mt-2"},H={key:0,class:"card p-8 text-center"},Q={key:1,class:"card p-6 bg-red-50 border border-red-200"},G={class:"text-red-600 text-center"},O={class:"font-medium"},J={key:2,class:"space-y-6"},K={class:"card p-6"},U={class:"space-y-2"},W={class:"flex justify-between"},X={class:"font-medium"},Y={class:"flex justify-between"},Z={class:"font-medium"},tt={class:"flex justify-between"},et={class:"font-medium text-right max-w-[200px]"},st={class:"card p-6"},at={class:"space-y-2"},ot={class:"flex justify-between"},lt={class:"font-medium"},nt={class:"flex justify-between"},rt={class:"font-medium"},it={class:"flex justify-between"},dt={key:0,class:"text-xs ml-1"},ut={class:"flex justify-between"},ct={class:"card p-6"},mt={class:"space-y-3"},vt={class:"font-medium"},pt={key:0,class:"text-sm text-gray-500"},xt={class:"font-medium"},yt={class:"mt-4 pt-4 border-t-2 border-gray-200"},gt={class:"flex justify-between items-center"},bt={class:"text-2xl font-bold text-primary-600"},ft={key:0,class:"flex justify-between mt-2 text-sm"},_t={class:"text-green-600"},ht={key:1,class:"flex justify-between mt-2 font-medium"},kt={class:"text-red-600"},wt={key:0,class:"space-y-3"},Ct={class:"card p-6"},Dt={class:"grid grid-cols-2 gap-3"},It=["disabled"],jt={key:0,class:"flex items-center justify-center"},Mt={key:1},St={key:1,class:"card p-6 bg-green-50 border border-green-200"},At={key:2,class:"card p-6 bg-gray-50 border border-gray-200"},Pt={class:"mt-8 text-center text-sm text-gray-500"},Bt={class:"mt-1"},Nt={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},zt={class:"bg-white rounded-2xl max-w-sm w-full p-6"},Lt={class:"bg-white p-4 rounded-lg border"},Tt=["src"],Vt={class:"text-center mt-4 text-2xl font-bold text-primary-600"},Et={class:"text-center text-sm text-gray-500 mt-2"},qt={__name:"PaymentPortal",props:{invoiceId:String,token:String},setup(S){const b=S,f=c(!0),_=c(null),s=c(null),m=c("all"),x=c(!1),v=c(null),C=c("ISP Billing"),D=w(()=>{var o;return(o=s.value)!=null&&o.due_date?new Date(s.value.due_date)<new Date:!1}),y=w(()=>s.value?s.value.total-(s.value.paid_amount||0):0),A=w(()=>{var e;const o={DRAFT:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm",SENT:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm",PAID:"px-2 py-1 bg-green-100 text-green-700 rounded text-sm",PARTIAL:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-sm",OVERDUE:"px-2 py-1 bg-red-100 text-red-700 rounded text-sm",CANCELLED:"px-2 py-1 bg-gray-100 text-gray-500 rounded text-sm"};return o[(e=s.value)==null?void 0:e.status]||o.DRAFT}),d=o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o||0),P=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),B=async()=>{var o;try{f.value=!0;const e=await k.get(`/api/v1/invoices/${b.invoiceId}`);s.value=((o=e.data)==null?void 0:o.data)||null}catch{_.value="Invoice tidak ditemukan atau sudah tidak berlaku"}finally{f.value=!1}},N=async()=>{var o,e,p;try{if(x.value=!0,m.value==="qris"){const r=await k.post(`/api/v1/invoices/${b.invoiceId}/qris`);v.value=r.data||null}else{const r=await k.post(`/api/v1/invoices/${b.invoiceId}/pay`);(o=r.data)!=null&&o.redirect_url&&(window.location.href=r.data.redirect_url)}}catch(r){alert(((p=(e=r.response)==null?void 0:e.data)==null?void 0:p.message)||"Gagal memproses pembayaran")}finally{x.value=!1}};return z(()=>{B()}),(o,e)=>{var p,r,I;return n(),l(M,null,[L(T(V),{title:"Portal Pembayaran"}),t("div",R,[t("div",q,[t("div",F,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold text-gray-800"},"Portal Pembayaran",-1)),t("p",$,a(C.value),1)]),f.value?(n(),l("div",H,[...e[4]||(e[4]=[t("div",{class:"animate-spin w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full mx-auto"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Memuat data invoice...",-1)])])):_.value?(n(),l("div",Q,[t("div",G,[e[5]||(e[5]=t("svg",{class:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("p",O,a(_.value),1)])])):s.value?(n(),l("div",J,[t("div",K,[e[9]||(e[9]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Informasi Pelanggan",-1)),t("dl",U,[t("div",W,[e[6]||(e[6]=t("dt",{class:"text-gray-600"},"Nama",-1)),t("dd",X,a((p=s.value.customer)==null?void 0:p.name),1)]),t("div",Y,[e[7]||(e[7]=t("dt",{class:"text-gray-600"},"ID Pelanggan",-1)),t("dd",Z,a((r=s.value.customer)==null?void 0:r.customer_id),1)]),t("div",tt,[e[8]||(e[8]=t("dt",{class:"text-gray-600"},"Alamat",-1)),t("dd",et,a((I=s.value.customer)==null?void 0:I.address),1)])])]),t("div",st,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Detail Invoice",-1)),t("dl",at,[t("div",ot,[e[10]||(e[10]=t("dt",{class:"text-gray-600"},"No. Invoice",-1)),t("dd",lt,a(s.value.invoice_number),1)]),t("div",nt,[e[11]||(e[11]=t("dt",{class:"text-gray-600"},"Periode",-1)),t("dd",rt,a(s.value.period),1)]),t("div",it,[e[12]||(e[12]=t("dt",{class:"text-gray-600"},"Jatuh Tempo",-1)),t("dd",{class:g(["font-medium",D.value?"text-red-600":""])},[j(a(P(s.value.due_date))+" ",1),D.value?(n(),l("span",dt,"(Lewat)")):u("",!0)],2)]),t("div",ut,[e[13]||(e[13]=t("dt",{class:"text-gray-600"},"Status",-1)),t("dd",null,[t("span",{class:g(A.value)},a(s.value.status),3)])])])]),t("div",ct,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Rincian Tagihan",-1)),t("div",mt,[(n(!0),l(M,null,E(s.value.items,i=>(n(),l("div",{key:i.id,class:"flex justify-between py-2 border-b border-gray-100 last:border-0"},[t("div",null,[t("p",vt,a(i.description),1),i.qty>1?(n(),l("p",pt,a(i.qty)+" x "+a(d(i.price)),1)):u("",!0)]),t("p",xt,a(d(i.subtotal)),1)]))),128))]),t("div",yt,[t("div",gt,[e[15]||(e[15]=t("span",{class:"text-lg font-bold text-gray-800"},"Total",-1)),t("span",bt,a(d(s.value.total)),1)]),s.value.paid_amount>0?(n(),l("div",ft,[e[16]||(e[16]=t("span",{class:"text-gray-600"},"Sudah Dibayar",-1)),t("span",_t,"- "+a(d(s.value.paid_amount)),1)])):u("",!0),y.value>0&&s.value.paid_amount>0?(n(),l("div",ht,[e[17]||(e[17]=t("span",{class:"text-gray-800"},"Sisa Tagihan",-1)),t("span",kt,a(d(y.value)),1)])):u("",!0)])]),s.value.status!=="PAID"&&s.value.status!=="CANCELLED"?(n(),l("div",wt,[t("div",Ct,[e[21]||(e[21]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Metode Pembayaran",-1)),t("div",Dt,[t("button",{onClick:e[0]||(e[0]=i=>m.value="all"),class:g(["p-4 border-2 rounded-lg transition-all",m.value==="all"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"])},[...e[19]||(e[19]=[h('<div class="text-center"><svg class="w-8 h-8 mx-auto mb-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg><p class="font-medium text-sm">Semua Metode</p><p class="text-xs text-gray-500">VA, CC, GoPay, dll</p></div>',1)])],2),t("button",{onClick:e[1]||(e[1]=i=>m.value="qris"),class:g(["p-4 border-2 rounded-lg transition-all",m.value==="qris"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"])},[...e[20]||(e[20]=[h('<div class="text-center"><svg class="w-8 h-8 mx-auto mb-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path></svg><p class="font-medium text-sm">QRIS</p><p class="text-xs text-gray-500">Scan &amp; Bayar</p></div>',1)])],2)])]),t("button",{onClick:N,disabled:x.value,class:"btn btn-primary w-full py-4 text-lg font-semibold"},[x.value?(n(),l("span",jt,[...e[22]||(e[22]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),j(" Memproses... ",-1)])])):(n(),l("span",Mt," Bayar Sekarang - "+a(d(y.value)),1))],8,It)])):s.value.status==="PAID"?(n(),l("div",St,[...e[23]||(e[23]=[h('<div class="text-center text-green-600"><svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-xl font-bold">Invoice Sudah Lunas</p><p class="mt-2">Terima kasih atas pembayaran Anda</p></div>',1)])])):s.value.status==="CANCELLED"?(n(),l("div",At,[...e[24]||(e[24]=[t("div",{class:"text-center text-gray-600"},[t("svg",{class:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("p",{class:"text-xl font-bold"},"Invoice Dibatalkan")],-1)])])):u("",!0)])):u("",!0),t("div",Pt,[e[25]||(e[25]=t("p",null,"Butuh bantuan? Hubungi kami di WhatsApp",-1)),t("p",Bt,"Powered by "+a(C.value),1)])]),v.value?(n(),l("div",Nt,[t("div",zt,[e[26]||(e[26]=t("h3",{class:"text-lg font-bold text-center mb-4"},"Scan QRIS untuk Bayar",-1)),t("div",Lt,[t("img",{src:v.value.qr_url,alt:"QRIS",class:"w-full"},null,8,Tt)]),t("p",Vt,a(d(y.value)),1),t("p",Et,"Berlaku hingga "+a(v.value.expiry),1),t("button",{onClick:e[2]||(e[2]=i=>v.value=null),class:"btn btn-secondary w-full mt-4"},"Tutup")])])):u("",!0)])],64)}}};export{qt as default};
