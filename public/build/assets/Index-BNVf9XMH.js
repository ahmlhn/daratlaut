import{o as W,c as r,a as B,u as Y,h as G,m as Q,b as e,d as X,t as l,n as p,f as u,q as Z,v as h,j as i,F as w,s as C,x as T,e as j,w as ee,i as F,r as c}from"./app-D84xlh30.js";import{_ as te}from"./AdminLayout-C8iern4a.js";const se={class:"space-y-6"},ae={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4"},le={class:"card p-4 text-center"},oe={class:"text-2xl font-bold text-gray-900"},ne={class:"text-2xl font-bold text-green-600"},re={class:"text-2xl font-bold text-red-600"},ie={class:"text-2xl font-bold text-blue-600"},de={class:"text-2xl font-bold text-green-600"},ue={class:"text-2xl font-bold text-purple-600"},ve={class:"text-2xl font-bold text-yellow-600"},pe={class:"text-2xl font-bold text-red-600"},xe={class:"card p-4"},ge={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ce=["value"],me=["value"],ye={class:"card overflow-hidden"},be={class:"overflow-x-auto"},fe={class:"min-w-full divide-y divide-gray-200"},ke={class:"bg-white dark:bg-dark-900 divide-y divide-gray-200 dark:divide-white/10"},_e={key:0},we={key:1},he={class:"px-4 py-3"},Ce={class:"text-sm font-medium text-gray-900 dark:text-white"},$e={key:0,class:"text-xs text-gray-400 dark:text-gray-500"},Se={class:"px-4 py-3"},Ee={class:"text-sm text-gray-900 dark:text-white"},Te={class:"text-sm text-gray-500 dark:text-gray-400"},je={class:"px-4 py-3"},Ae={class:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},Pe={class:"px-4 py-3"},Ve=["onClick"],Ne={class:"px-4 py-3"},Ue={class:"px-4 py-3 text-right text-sm space-x-2"},Oe=["onClick"],Me=["onClick"],Be={key:0,class:"bg-gray-50 dark:bg-dark-900 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-white/10"},Fe={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"flex gap-2"},Le=["disabled"],Ie={class:"px-3 py-1 text-sm"},Ke=["disabled"],Re={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},De={class:"flex items-center justify-center min-h-screen pt-4 px-4"},ze={class:"relative bg-white dark:bg-dark-900 rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto"},He={class:"sticky top-0 bg-white dark:bg-dark-900 px-6 py-4 border-b border-gray-200 dark:border-white/10 flex justify-between items-center"},Je={class:"text-lg font-medium text-gray-900 dark:text-white"},We={class:"grid grid-cols-2 gap-4"},Ye={class:"grid grid-cols-2 gap-4"},Ge=["value"],Qe=["value"],Xe={class:"grid grid-cols-2 gap-4"},Ze={class:"flex items-center gap-2 cursor-pointer"},et={class:"flex items-center gap-2 cursor-pointer"},tt={class:"flex justify-end gap-3 pt-4 border-t"},st={type:"submit",class:"btn btn-primary"},k="/api/v1",nt={__name:"Index",setup(at){const $=c([]),v=c({current_page:1,last_page:1,total:0}),x=c({total:0,active:0,inactive:0,by_role:{}}),A=c([]),P=c(!1),m=c(!1),_=c(!1),n=c(null),a=c({q:"",role:"",is_active:"",page:1}),V=[{value:"",label:"Semua Role"},{value:"teknisi",label:"Teknisi"},{value:"sales",label:"Sales"},{value:"admin",label:"Admin"},{value:"cs",label:"CS"},{value:"keuangan",label:"Keuangan"},{value:"owner",label:"Owner"}],q=[{value:"",label:"Semua Status"},{value:"1",label:"Aktif"},{value:"0",label:"Non-Aktif"}],L={teknisi:"bg-blue-100 text-blue-800",sales:"bg-green-100 text-green-800",admin:"bg-purple-100 text-purple-800",cs:"bg-yellow-100 text-yellow-800",keuangan:"bg-indigo-100 text-indigo-800",owner:"bg-red-100 text-red-800"};async function y(){P.value=!0;try{const o=new URLSearchParams;Object.entries(a.value).forEach(([b,f])=>{f!==""&&o.append(b,f)});const g=await(await fetch(`${k}/team?${o.toString()}`)).json();$.value=g.data||[],v.value=g.meta||{current_page:1,last_page:1,total:0}}catch(o){console.error("Error loading team:",o)}finally{P.value=!1}}async function S(){try{const o=await fetch(`${k}/team/stats`);x.value=await o.json()}catch(o){console.error("Error loading stats:",o)}}async function I(){try{const t=await(await fetch(`${k}/pops/dropdown`)).json();A.value=t.data||[]}catch(o){console.error("Error loading pops:",o)}}function d(){a.value.page=1,y()}function K(){a.value={q:"",role:"",is_active:"",page:1},y()}function N(o){a.value.page=o,y()}function R(){_.value=!1,n.value={name:"",phone:"",email:"",role:"teknisi",pop_id:null,is_active:!0,can_login:!1,notes:""},m.value=!0}function D(o){_.value=!0,n.value={...o},m.value=!0}async function z(){try{const o=_.value?`${k}/team/${n.value.id}`:`${k}/team`,t=_.value?"PUT":"POST",g={...n.value,tenant_id:1},b=await fetch(o,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(b.ok)m.value=!1,y(),S();else{const f=await b.json();alert(f.message||"Error saving team member")}}catch(o){console.error("Error saving team member:",o),alert("Error saving team member")}}async function H(o){if(confirm(`Hapus anggota tim ${o.name}?`))try{const t=await fetch(`${k}/team/${o.id}?tenant_id=1`,{method:"DELETE"});if(t.ok)y(),S();else{const g=await t.json();alert(g.message||"Error deleting team member")}}catch(t){console.error("Error deleting team member:",t)}}async function J(o){try{(await fetch(`${k}/team/${o.id}/toggle-status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenant_id:1})})).ok&&(y(),S())}catch(t){console.error("Error toggling status:",t)}}return W(()=>{y(),S(),I()}),(o,t)=>(i(),r(w,null,[B(Y(G),{title:"Team"}),B(te,null,{default:Q(()=>{var g,b,f,U,O;return[e("div",se,[e("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},[t[24]||(t[24]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Tim"),e("p",{class:"text-gray-500 text-sm"},"Kelola anggota tim teknisi, sales, dan admin")],-1)),e("button",{onClick:R,class:"btn btn-primary"},[...t[23]||(t[23]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),X(" Tambah Anggota ",-1)])])]),e("div",ae,[e("div",le,[e("div",oe,l(x.value.total),1),t[25]||(t[25]=e("div",{class:"text-sm text-gray-500"},"Total",-1))]),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-green-500",a.value.is_active==="1"?"ring-2 ring-green-500":""]),onClick:t[0]||(t[0]=s=>{a.value.is_active=a.value.is_active==="1"?"":"1",d()})},[e("div",ne,l(x.value.active),1),t[26]||(t[26]=e("div",{class:"text-sm text-gray-500"},"Aktif",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-red-500",a.value.is_active==="0"?"ring-2 ring-red-500":""]),onClick:t[1]||(t[1]=s=>{a.value.is_active=a.value.is_active==="0"?"":"0",d()})},[e("div",re,l(x.value.inactive),1),t[27]||(t[27]=e("div",{class:"text-sm text-gray-500"},"Non-Aktif",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-blue-500",a.value.role==="teknisi"?"ring-2 ring-blue-500":""]),onClick:t[2]||(t[2]=s=>{a.value.role=a.value.role==="teknisi"?"":"teknisi",d()})},[e("div",ie,l(((g=x.value.by_role)==null?void 0:g.teknisi)||0),1),t[28]||(t[28]=e("div",{class:"text-sm text-gray-500"},"Teknisi",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-green-500",a.value.role==="sales"?"ring-2 ring-green-500":""]),onClick:t[3]||(t[3]=s=>{a.value.role=a.value.role==="sales"?"":"sales",d()})},[e("div",de,l(((b=x.value.by_role)==null?void 0:b.sales)||0),1),t[29]||(t[29]=e("div",{class:"text-sm text-gray-500"},"Sales",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-purple-500",a.value.role==="admin"?"ring-2 ring-purple-500":""]),onClick:t[4]||(t[4]=s=>{a.value.role=a.value.role==="admin"?"":"admin",d()})},[e("div",ue,l(((f=x.value.by_role)==null?void 0:f.admin)||0),1),t[30]||(t[30]=e("div",{class:"text-sm text-gray-500"},"Admin",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-yellow-500",a.value.role==="cs"?"ring-2 ring-yellow-500":""]),onClick:t[5]||(t[5]=s=>{a.value.role=a.value.role==="cs"?"":"cs",d()})},[e("div",ve,l(((U=x.value.by_role)==null?void 0:U.cs)||0),1),t[31]||(t[31]=e("div",{class:"text-sm text-gray-500"},"CS",-1))],2),e("div",{class:p(["card p-4 text-center cursor-pointer hover:ring-2 hover:ring-red-500",a.value.role==="owner"?"ring-2 ring-red-500":""]),onClick:t[6]||(t[6]=s=>{a.value.role=a.value.role==="owner"?"":"owner",d()})},[e("div",pe,l(((O=x.value.by_role)==null?void 0:O.owner)||0),1),t[32]||(t[32]=e("div",{class:"text-sm text-gray-500"},"Owner",-1))],2)]),e("div",xe,[e("div",ge,[u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.q=s),onKeyup:Z(d,["enter"]),type:"text",placeholder:"Cari nama, telepon, email...",class:"input w-full"},null,544),[[h,a.value.q]]),u(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.role=s),onChange:d,class:"input"},[(i(),r(w,null,C(V,s=>e("option",{key:s.value,value:s.value},l(s.label),9,ce)),64))],544),[[T,a.value.role]]),u(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.is_active=s),onChange:d,class:"input"},[(i(),r(w,null,C(q,s=>e("option",{key:s.value,value:s.value},l(s.label),9,me)),64))],544),[[T,a.value.is_active]]),e("div",{class:"flex gap-2"},[e("button",{onClick:d,class:"btn btn-primary flex-1"},"Filter"),e("button",{onClick:K,class:"btn btn-secondary"},"Reset")])])]),e("div",ye,[e("div",be,[e("table",fe,[t[35]||(t[35]=e("thead",{class:"bg-gray-50 dark:bg-dark-800"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nama"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Kontak"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Role"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"POP"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Login"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi")])],-1)),e("tbody",ke,[P.value?(i(),r("tr",_e,[...t[33]||(t[33]=[e("td",{colspan:"7",class:"px-4 py-8 text-center text-gray-500"},"Loading...",-1)])])):$.value.length===0?(i(),r("tr",we,[...t[34]||(t[34]=[e("td",{colspan:"7",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data",-1)])])):j("",!0),(i(!0),r(w,null,C($.value,s=>{var M;return i(),r("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-dark-800"},[e("td",he,[e("div",Ce,l(s.name),1),s.notes?(i(),r("div",$e,l(s.notes),1)):j("",!0)]),e("td",Se,[e("div",Ee,l(s.phone||"-"),1),e("div",Te,l(s.email||""),1)]),e("td",je,[e("span",{class:p([L[s.role],"px-2 py-1 text-xs rounded-full font-medium capitalize"])},l(s.role),3)]),e("td",Ae,l(((M=A.value.find(E=>E.id===s.pop_id))==null?void 0:M.name)||"-"),1),e("td",Pe,[e("button",{onClick:E=>J(s),class:p([s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 text-xs rounded-full font-medium"])},l(s.is_active?"Aktif":"Non-Aktif"),11,Ve)]),e("td",Ne,[e("span",{class:p([s.can_login?"text-green-600":"text-gray-400","text-sm"])},l(s.can_login?"✓ Ya":"✗ Tidak"),3)]),e("td",Ue,[e("button",{onClick:E=>D(s),class:"text-primary-600 hover:text-primary-900"},"Edit",8,Oe),e("button",{onClick:E=>H(s),class:"text-red-600 hover:text-red-900"},"Hapus",8,Me)])])}),128))])])]),v.value.last_page>1?(i(),r("div",Be,[e("div",Fe," Menampilkan "+l($.value.length)+" dari "+l(v.value.total)+" data ",1),e("div",qe,[e("button",{onClick:t[10]||(t[10]=s=>N(v.value.current_page-1)),disabled:v.value.current_page<=1,class:"btn btn-secondary text-sm"},"Prev",8,Le),e("span",Ie,l(v.value.current_page)+" / "+l(v.value.last_page),1),e("button",{onClick:t[11]||(t[11]=s=>N(v.value.current_page+1)),disabled:v.value.current_page>=v.value.last_page,class:"btn btn-secondary text-sm"},"Next",8,Ke)])])):j("",!0)])]),m.value?(i(),r("div",Re,[e("div",De,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[12]||(t[12]=s=>m.value=!1)}),e("div",ze,[e("div",He,[e("h3",Je,l(_.value?"Edit Anggota Tim":"Tambah Anggota Tim"),1),e("button",{onClick:t[13]||(t[13]=s=>m.value=!1),class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...t[36]||(t[36]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:ee(z,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nama *",-1)),u(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>n.value.name=s),type:"text",required:"",class:"input w-full"},null,512),[[h,n.value.name]])]),e("div",We,[e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"No. WhatsApp",-1)),u(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>n.value.phone=s),type:"text",class:"input w-full",placeholder:"62812xxxxxxxx"},null,512),[[h,n.value.phone]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Email",-1)),u(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>n.value.email=s),type:"email",class:"input w-full"},null,512),[[h,n.value.email]])])]),e("div",Ye,[e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Role *",-1)),u(e("select",{"onUpdate:modelValue":t[17]||(t[17]=s=>n.value.role=s),required:"",class:"input w-full"},[(i(!0),r(w,null,C(V.slice(1),s=>(i(),r("option",{key:s.value,value:s.value},l(s.label),9,Ge))),128))],512),[[T,n.value.role]])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"POP",-1)),u(e("select",{"onUpdate:modelValue":t[18]||(t[18]=s=>n.value.pop_id=s),class:"input w-full"},[t[41]||(t[41]=e("option",{value:null},"Semua POP",-1)),(i(!0),r(w,null,C(A.value,s=>(i(),r("option",{key:s.id,value:s.id},l(s.name),9,Qe))),128))],512),[[T,n.value.pop_id]])])]),e("div",Xe,[e("label",Ze,[u(e("input",{"onUpdate:modelValue":t[19]||(t[19]=s=>n.value.is_active=s),type:"checkbox",class:"rounded text-primary-600"},null,512),[[F,n.value.is_active]]),t[43]||(t[43]=e("span",{class:"text-sm text-gray-700"},"Aktif",-1))]),e("label",et,[u(e("input",{"onUpdate:modelValue":t[20]||(t[20]=s=>n.value.can_login=s),type:"checkbox",class:"rounded text-primary-600"},null,512),[[F,n.value.can_login]]),t[44]||(t[44]=e("span",{class:"text-sm text-gray-700"},"Bisa Login",-1))])]),e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Catatan",-1)),u(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=s=>n.value.notes=s),rows:"2",class:"input w-full"},null,512),[[h,n.value.notes]])]),e("div",tt,[e("button",{type:"button",onClick:t[22]||(t[22]=s=>m.value=!1),class:"btn btn-secondary"},"Batal"),e("button",st,l(_.value?"Simpan Perubahan":"Tambah"),1)])],32)])])])):j("",!0)]}),_:1})],64))}};export{nt as default};
